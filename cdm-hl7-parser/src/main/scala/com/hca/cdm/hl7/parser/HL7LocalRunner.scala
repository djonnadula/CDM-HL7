package com.hca.cdm.hl7.parser

import com.hca.cdm.Models.MSGMeta
import com.hca.cdm._
import com.hca.cdm.hl7.model._
import com.hca.cdm.hl7.audit.AuditConstants._
import com.hca.cdm.hl7.audit._
import com.hca.cdm.hl7.constants.HL7Constants._
import com.hca.cdm.hl7.constants.HL7Types.{withName => hl7}
import com.hca.cdm.log.Logg
import org.apache.log4j.PropertyConfigurator._

import scala.util.{Failure, Success, Try}
import com.hca.cdm.mq.publisher.{MQAcker => TLMAcknowledger}
/**
  * Created by Devaraj Jonnadula on 8/24/2016.
  */
object HL7LocalRunner extends App with Logg {

  configure(currThread.getContextClassLoader.getResource("local-log4j.properties"))
  reload(null,Some(currThread.getContextClassLoader.getResourceAsStream("Hl7LocalConfig.properties")))
  /* private val messageTypesR = lookUpProp("hl7.messages.type") split COMMA
   private val hl7MsgMetaR = messageTypesR.map(mtyp => mtyp -> getReceiverMeta(hl7(mtyp), lookUpProp(s"$mtyp.wsmq.source"), lookUpProp(s"$mtyp.kafka"))).toMap
   private val hl7QueueMappingR = hl7MsgMetaR.flatMap(x => x._2.wsmq.map(que => que -> x._1))
   private val hl7KafkaOutR = hl7MsgMetaR.map(x => x._1 -> x._2.kafka)
   private val hl7QueuesR = hl7MsgMetaR.flatMap(_._2.wsmq).toSet
   private val tlmAuditorR = hl7QueueMappingR.map (x =>  x._2 -> (tlmAckMsg(x._1, applicationSending, WSMQ, HDFS)(_: MSGMeta)))*/

  /* private val messageTypesR = lookUpProp("hl7.messages.type") split COMMA
   private val hl7MsgMetaR = messageTypesR.map(mtyp => mtyp -> getReceiverMeta(hl7(mtyp), lookUpProp(s"$mtyp.wsmq.source"), lookUpProp(s"$mtyp.kafka"))).toMap
   private val hl7QueueMappingR = hl7MsgMetaR.map(x => x._2.wsmq -> x._1)
   private val hl7KafkaOutR = hl7MsgMetaR.map(x => x._1 -> x._2.kafka)
   private val hl7QueuesR = hl7MsgMetaR.map(_._2.wsmq).toSet
   private val tlmAuditorR = hl7MsgMetaR map (x => x._2.wsmq -> (tlmAckMsg(x._1, applicationSending, WSMQ, HDFS)(_: MSGMeta)))*/
  val msgType = hl7("ORU")
  // hl7(args(0))
  private val msgs =
    "MSH|^~\\&|PTH|COCCF|||201709211329||ORU^R01|MT_COCCF_ORU_CFLABRES.1.72605|P|2.4|||||\nPID|1||F000810933^^^^MR~644-27-8990^^^^SS~Z601567^^^^PI||SHARMA^MONA^^^^^L||19751114|F||AI|9318 WINDSWEPT GROVE DR^^HOUSTON^TX^77083^^^^HARR||713-291-4922^PRN~281-564-1226^ORN|N/A^WPN||M|HND|F00032398868\nPV1|1|O|F.DSU^^|EL|||TERJA^Terry^Jamie^Elizabeth^^^MD|TERJA^Terry^Jamie^Elizabeth^^^MD|TERJA^Terry^Jamie^Elizabeth^^^MD|||||||||SDC||OTHE||||||||||||||||HOM|||COCCF||DEP|||201709190929|201709190929|||||||NODOC^No^Doc^^^^^^^^^^XX\nOBR|||17:CF:SW006024|BREAXN^BREAST,EXCISION OF LESION/MASS^L||201709191415|201709211146|||||||201709191415||TERJA^Terry^Jamie^Elizabeth^^^MD^^MEDITECH|||04355638||||||SOUT\nOBX|1|TX|||--------------------------------------------------------------------------------------------||||||F\nOBX|2|TX|||RUN DATE: 09/21/17                      Woman's - Laboratory                       PAGE 1   ||||||F\nOBX|3|TX|||RUN TIME: 1329                            Specimen Inquiry                    ||||||F\nOBX|4|TX|||RUN USER: INTERFACE                                                           ||||||F\nOBX|5|TX|||--------------------------------------------------------------------------------------------||||||F\nOBX|6|TX|||PATIENT: SHARMA,MONA                   ACCT #: F00032398868 LOC:  F.DSU      U #: F000810933||||||F\nOBX|7|TX|||                                       AGE/SX: 41/F         ROOM:            REG: 09/19/17||||||F\nOBX|8|TX|||REG DR:  Terry,Jamie Elizabeth         DOB:    11/14/75     BED:             DIS:         ||||||F\nOBX|9|TX|||                                       STATUS: DEP SDC      TLOC:           ||||||F\nOBX|10|TX|||--------------------------------------------------------------------------------------------||||||F\nOBX|11|TX||| ||||||F\nOBX|12|TX|||SPEC #: 17:CF:SW006024     RECD: 09/19/17-1415     STATUS:  SOUT           REQ #: 04355638||||||F\nOBX|13|TX|||                           COLL: 09/19/17-         SUBM DR: Terry,Jamie Elizabeth  MD     ||||||F\nOBX|14|TX||| ||||||F\nOBX|15|TX|||ENTERED:  09/19/17-1415    SP TYPE: BREAST,EXC     OTHR DR:                               ||||||F\nOBX|16|TX|||ORDERED:  LEVEL VI SURGIC                                                                   ||||||F\nOBX|17|TX||| ||||||F\nOBX|18|TX|||CODES: T04000 - BREAST, NOS||||||F\nOBX|19|TX||| ||||||F\nOBX|20|TX|||PROCEDURES: LEVEL VI SURGIC (Incomplete)||||||F\nOBX|21|TX||| ||||||F\nOBX|22|TX|||TISSUES:  ||||||F\nOBX|23|TX|||         BREAST, NOS - RIGHT BREAST LUMPECTOMY||||||F\nOBX|24|TX||| ||||||F\nOBX|25|TX|||        CLINICAL HISTORY||||||F\nOBX|26|TX||| ||||||F\nOBX|27|TX|||   41 year old, right benign neoplasm  (wpd)||||||F\nOBX|28|TX||| ||||||F\nOBX|29|TX|||        FINAL DIAGNOSIS||||||F\nOBX|30|TX||| ||||||F\nOBX|31|TX|||   Breast, right, lumpectomy:||||||F\nOBX|32|TX|||             - fibroadenoma with coarse calcifications||||||F\nOBX|33|TX|||             - focal mild duct ectasia||||||F\nOBX|34|TX|||             - apocrine metaplasia||||||F\nOBX|35|TX|||    ||||||F\nOBX|36|TX|||   Tissue code 1||||||F\nOBX|37|TX|||   CPT code(s):  88307||||||F\nOBX|38|TX|||   cds/kr 9/21/17 @ 1135||||||F\nOBX|39|TX||| ||||||F\nOBX|40|TX|||       GROSS DESCRIPTION||||||F\nOBX|41|TX||| ||||||F\nOBX|42|TX|||   The specimen is received in a formalin-filled container, labeled with the patient's||||||F\nOBX|43|TX|||   name and designated \"\"right lumpectomy, long stitch - lateral, short stitch -||||||F\nOBX|44|TX|||   superior, double stitch - deep\"\".  The specimen consists of a well-circumscribed||||||F\nOBX|45|TX|||   nodular tissue measuring 3.5 cm from superior to inferior, 2.9 cm from medial to||||||F\nOBX|46|TX|||   lateral and 2.5 cm from anterior to posterior.||||||F\nOBX|47|TX|||    ||||||F\nOBX|48|TX|||   Ink code:  Anterior - blue, posterior - black, medial - red and lateral - green.||||||F\nOBX|49|TX|||    ||||||F\nOBX|50|TX|||   It is sectioned and submitted from superior to inferior in A - K.  hz/wpd 09/19/17 @||||||F\nOBX|51|TX|||   1645||||||F\nOBX|52|TX||| ||||||F\nOBX|53|TX|||    MICROSCOPIC DESCRIPTION||||||F\nOBX|54|TX||| ||||||F\nOBX|55|TX|||   Sections show a fibroadenoma with coarse calcifications.  A compressed rim of benign||||||F\nOBX|56|TX|||   breast parenchyma is adjacent to the fibroadenoma and shows features of mild duct||||||F\nOBX|57|TX|||   ectasia and apocrine metaplasia.  There is no evidence of atypia or malignancy.  ||||||F\nOBX|58|TX|||   cds/kr 9/21/17 @ 1134||||||F\nOBX|59|TX||| ||||||F\nOBX|60|TX|||                               ** CONTINUED ON NEXT PAGE **||||||F\nOBX|61|TX||| ||||||F\nOBX|62|TX|||--------------------------------------------------------------------------------------------||||||F\nOBX|63|TX|||RUN DATE: 09/21/17                      Woman's - Laboratory                       PAGE 2   ||||||F\nOBX|64|TX|||RUN TIME: 1329                            Specimen Inquiry                    ||||||F\nOBX|65|TX|||RUN USER: INTERFACE                                                           ||||||F\nOBX|66|TX|||--------------------------------------------------------------------------------------------||||||F\nOBX|67|TX|||SPEC #: 17:CF:SW006024    PATIENT: SHARMA,MONA                    #F00032398868  (Continued)||||||F\nOBX|68|TX|||--------------------------------------------------------------------------------------------||||||F\nOBX|69|TX||| ||||||F\nOBX|70|TX|||--------------------------------------------------------------------------------------------||||||F\nOBX|71|TX||| ||||||F\nOBX|72|TX|||Signed ________________________________         Sauls,Clifford Dan 09/21/17 1146  ||||||F\nOBX|73|TX||| ||||||F\nOBX|74|TX|||--------------------------------------------------------------------------------------------||||||F\nOBX|75|TX||| ||||||F\nOBX|76|TX||| ||||||F\nOBX|77|TX||| ||||||F\nOBX|78|TX||| ||||||F\nOBX|79|TX||| ||||||F\nOBX|80|TX||| ||||||F\nOBX|81|TX||| ||||||F\nOBX|82|TX||| ||||||F\nOBX|83|TX||| ||||||F\nOBX|84|TX||| ||||||F\nOBX|85|TX||| ||||||F\nOBX|86|TX||| ||||||F\nOBX|87|TX||| ||||||F\nOBX|88|TX||| ||||||F\nOBX|89|TX||| ||||||F\nOBX|90|TX||| ||||||F\nOBX|91|TX||| ||||||F\nOBX|92|TX||| ||||||F\nOBX|93|TX||| ||||||F\nOBX|94|TX||| ||||||F\nOBX|95|TX||| ||||||F\nOBX|96|TX||| ||||||F\nOBX|97|TX||| ||||||F\nOBX|98|TX||| ||||||F\nOBX|99|TX||| ||||||F\nOBX|100|TX||| ||||||F\nOBX|101|TX||| ||||||F\nOBX|102|TX||| ||||||F\nOBX|103|TX||| ||||||F\nOBX|104|TX||| ||||||F\nOBX|105|TX||| ||||||F\nOBX|106|TX||| ||||||F\nOBX|107|TX||| ||||||F\nOBX|108|TX||| ||||||F\nOBX|109|TX||| ||||||F\nOBX|110|TX||| ||||||F\nOBX|111|TX||| ||||||F\nOBX|112|TX||| ||||||F\nOBX|113|TX||| ||||||F\nOBX|114|TX||| ||||||F\nOBX|115|TX||| ||||||F\nOBX|116|TX||| ||||||F\nOBX|117|TX||| ||||||F\nOBX|118|TX||| ||||||F\nOBX|119|TX||| ||||||F\nOBX|120|TX||| ||||||F\nOBX|121|TX|||                                   ** END OF REPORT **||||||F\nOBX|122|TX||| ||||||F\n"
  //"MSH|^~\\&||COCCM|||201709210757||MDM^T02|MT_COCCM_MDM_CMDPTO.1.5090957|P|2.1|||||\nPID|1||Z00525822|I239141|SMITH^JENNIFER^MICHELLE|SHARI|19871202|F|SMITH^JENNIFER^M^^^^M|W|11506 E 14TH ST^BLDG 9 APT R^INDEPENDENCE^MO^64052|JAC|816-406-6278|SAP||S|BAP|Z72612731567|487-98-9799\nPV1|1|I|Z.3N^Z.308^A|EM|||WEGNA^Wegner^Nathan^T^^^MD^^^^^^XX|WEGNA^Wegner^Nathan^T^^^MD^^^^^^XX|WEGNA^Wegner^Nathan^T^^^MD^^^^^^XX~CASLI1^Castro^Lisa^M^^^MD^^^^^^XX~COWTR^Cowles^Tracy^A^^^MD^^^^^^XX~WIEJI^Wiese^Jill^E NNP^^^^^^^^^XX|OBPP||||PR|||WEGNA^Wegner^Nathan^T^^^MD^^^^^^XX|IN||09|||||||||||||||||||COCCM||ADM|||201709112107||||||||WIEJI^Wiese^Jill^E NNP^^^^^^^^^XX\nTXA||PATH^SURGICAL PATHOLOGY REPORT|201709210757|201709210756||201709191041|201709210756||LAWLA^Lawson^Larry^D^^^MD||TRANS^COPATH^CERNER|Z.PATH20170921-0001^M17-41317_5854033 CoPathPlus|||Z.PATH|PATH|Signed|||||LAWLA^Lawson^Larry^D^^^MD^^^^^^^^201709210756\nOBX|1|TX||H|                      Centerpoint Medical Center\nOBX|2|TX||H|                        19600 E. 39th Street\nOBX|3|TX||H|                       Independence, MO 64057\nOBX|4|TX||H|                        phone: (816) 698-7000\nOBX|5|TX||H|                         fax: (816) 698-8141\nOBX|6|TX||H| \nOBX|7|TX||H|PATIENT NAME:     SMITH,JENNIFER MICHELLE           LOCATION: Z.3N      \nOBX|8|TX||H|MEDICAL RECORD#:  Z00525822                         ACCOUNT#: Z72612731567\nOBX|9|TX||H|DATE OF BIRTH:    12/02/87                          ROOM/BED: Z.308-A           \nOBX|10|TX||H|DATE OF ADMIT:    09/11/17                     REPORT STATUS: Signed   \nOBX|11|TX||H| \nOBX|12|TX||H|ATTEND PHYSICIAN:       Wegner,Nathan T  MD           \nOBX|13|TX||H|PRIMARY CARE PHYSICIAN: Wegner,Nathan T  MD           \nOBX|14|TX||H|REFERRING PHYISICIAN:   Wegner,Nathan T  MD           \nOBX|15|TX||H| \nOBX|16|TX||H|                       SURGICAL PATHOLOGY REPORT     \nOBX|17|TX||X| \nOBX|18|TX||X| \nOBX|19|TX|||**Final Report **\nOBX|20|TX||| \nOBX|21|TX||| \nOBX|22|TX||| \nOBX|23|TX|||SPECIMEN DETAILS:\nOBX|24|TX|||Collected:  9/18/2017 18:10\nOBX|25|TX|||Received:  9/19/2017 10:36\nOBX|26|TX|||Reported:  9/21/2017 07:56\nOBX|27|TX|||Accession #:  M17-41317  \nOBX|28|TX||| \nOBX|29|TX||| \nOBX|30|TX||| \nOBX|31|TX|||FINAL DIAGNOSIS:\nOBX|32|TX|||Single preterm twin placenta (642 grams):\nOBX|33|TX|||- Fetal membranes (A and B):  \nOBX|34|TX|||          - Unremarkable chorioamnion without significant\nOBX|35|TX|||histologic abnormality.\nOBX|36|TX|||- Maternal cotyledons (A and B):\nOBX|37|TX|||          - Unremarkable third trimester chorionic villi\nOBX|38|TX|||without significant histologic abnormality.\nOBX|39|TX|||- Umbilical cord A:\nOBX|40|TX|||          - Unremarkable 3-vessel umbilical cord without\nOBX|41|TX|||significant histologic abnormality.\nOBX|42|TX|||- Umbilical cord B:\nOBX|43|TX|||          - Unremarkable 3-vessel umbilical cord without\nOBX|44|TX|||significant histologic abnormality.\nOBX|45|TX||| \nOBX|46|TX|||(LDL:sem; 09/20/2017)  \nOBX|47|TX||| \nOBX|48|TX||| \nOBX|49|TX|||COMMENT:\nOBX|50|TX|||The separating membranes appear to be dichorionic and\nOBX|51|TX|||diamniotic in nature.  These findings can be seen in both\nOBX|52|TX|||monozygotic and dizygotic twins.\nOBX|53|TX|||(LDL:sem; 09/20/2017) \nOBX|54|TX||| \nOBX|55|TX|||ELECTRONICALLY SIGNED BY:   Larry D. Lawson, MD\nOBX|56|TX|||DATE/TIME:   9/21/2017 07:56\nOBX|57|TX||T| \nOBX|58|TX||T|PATIENT NAME: SMITH,JENNIFER MICHELLE          ACCOUNT # Z72612731567\nOBX|59|TX||X| \nOBX|60|TX||X| \nOBX|61|TX||X| \nOBX|62|TX||| \nOBX|63|TX|||PHYSICIAN(S):\nOBX|64|TX|||Dr. Nathan Wegner\nOBX|65|TX||| \nOBX|66|TX|||Specimen(s) Received:\nOBX|67|TX|||A.Twin placenta\nOBX|68|TX||| \nOBX|69|TX||| \nOBX|70|TX|||GROSS DESCRIPTION:\nOBX|71|TX|||The specimen is received in formalin, labeled \"\"Smith,\nOBX|72|TX|||Jennifer, placenta A/placenta B\"\" and consists of a single\nOBX|73|TX|||disc twin placenta.  There are dividing membranes identified\nOBX|74|TX|||which show at least 3 grossly identifiable layers.  The\nOBX|75|TX|||requisitions state \"\"baby B's cord is clamped.  The placenta\nOBX|76|TX|||weighs 642 g (after removal of umbilical cord and\nOBX|77|TX|||membranes).  The specimen measures (upon reconstruction)\nOBX|78|TX|||27.0 x 17.0 x 4.2 cm.  There is a tear of the disc which\nOBX|79|TX|||begins at one margin and extends for a linear length of 8\nOBX|80|TX|||cm.  The tear is present through twin B's chamber.  The tear\nOBX|81|TX|||is most likely caused by mechanical manipulation.  Twin A's\nOBX|82|TX|||cord is eccentrically inserted, 6 cm from edge, and measures\nOBX|83|TX|||42 cm length with diameter ranging from 1.5 cm to 2.5 cm. \nOBX|84|TX|||The cord shows decreased twisting, increased Wharton's\nOBX|85|TX|||jelly, and sectioning reveals 3 blood vessels.  Twin B's\nOBX|86|TX|||umbilical cord shows a near marginal insertion, 1 cm from\nOBX|87|TX|||edge to with cord measuring 26.0 cm in length with an\nOBX|88|TX|||average diameter 1.2 cm.  The cord shows decreased with an\nOBX|89|TX|||sectioning reveals 3 blood vessels.  Also within the\nOBX|90|TX|||container is a separate segment of cord measuring 22 cm in\nOBX|91|TX|||length by 1.2 cm in diameter and also exhibiting 3 blood\nOBX|92|TX|||vessels.  The membranes of disc are thickened, tan, gray,\nOBX|93|TX|||slightly edematous, and insert marginally.  The maternal\nOBX|94|TX|||surface shows intact and complete cotyledons.  Sectioning\nOBX|95|TX|||reveals soft red maroon cut surface.  No masses or lesions\nOBX|96|TX|||are identified.  The specimen resembles a dichorionic\nOBX|97|TX|||diamniotic twin placenta.  Representative sections are\nOBX|98|TX|||submitted A1-A8.\nOBX|99|TX||| \nOBX|100|TX|||A1 umbilical cord and membrane roll twin A\nOBX|101|TX|||A2 umbilical cord and periphery twin A\nOBX|102|TX|||A3 fetal and maternal surface twin A\nOBX|103|TX|||A4 umbilical cord and membrane roll twin B\nOBX|104|TX|||A5 umbilical cord and periphery twin B\nOBX|105|TX|||A6 fetal and maternal twin B\nOBX|106|TX|||A7 dividing membrane roll and cross-section of efforts\nOBX|107|TX|||segment of cord within container (JEB; 9/19/2017)\nOBX|108|TX||| \nOBX|109|TX|||CLINICAL HISTORY:\nOBX|110|TX|||Gestational Age: 34\nOBX|111|TX|||Birth Weight: A) 1960  B) 1380\nOBX|112|TX|||APGAR Score: 1 min A) 8  B) 8     5min A) 9  B) 9\nOBX|113|TX|||Maternal OB History; Baby B's cord is clamped  EDC NG \nOBX|114|TX|||Gravida: 3  Para: 1\nOBX|115|TX||| \nOBX|116|TX||T| \nOBX|117|TX||T|PATIENT NAME: SMITH,JENNIFER MICHELLE          ACCOUNT # Z72612731567\nOBX|118|TX||X| \nOBX|119|TX||X| \nOBX|120|TX||X| \nOBX|121|TX||| \nOBX|122|TX||| \nOBX|123|TX|||INITIAL CPT CODE(S):\nOBX|124|TX|||A; 88307(2)\nOBX|125|TX|||Professional services performed under supervision of LabCorp\nOBX|126|TX|||Medical Director at 19600 E 39th St., Independence, MO\nOBX|127|TX|||64057. Technical services performed under supervision of\nOBX|128|TX|||LabCorp Medical Director at 7301 College Blvd, #110,\nOBX|129|TX|||Overland Park, KS 66210.\nOBX|130|TX||| \nOBX|131|TX||| \nOBX|132|TX|||    \nOBX|133|TX|||LabCorp  7301 College Blvd, Suite 110 - Overland Park, KS\nOBX|134|TX|||66210 - PHONE:  913-338-4070\nOBX|135|TX||| \nOBX|136|TX|||* * *  END OF REPORT  * * *\nOBX|137|TX||X| \nOBX|138|TX||X| \nOBX|139|TX||X| \nOBX|140|TX||X| \nOBX|141|TX||X| \nOBX|142|TX||X| \nOBX|143|TX||X|Electronically Signed by Larry D Lawson, MD on 09/21/17 at 0757\nOBX|144|TX||X| \nOBX|145|TX||X| \nOBX|146|TX||X| \nOBX|147|TX||X| \nOBX|148|TX||X| \nOBX|149|TX||X| \nOBX|150|TX||X| \nOBX|151|TX||X| \nOBX|152|TX||X| \nOBX|153|TX||X| \nOBX|154|TX||X| \nOBX|155|TX||X| \nOBX|156|TX||X| \nOBX|157|TX||X| \nOBX|158|TX||X| \nOBX|159|TX||X| \nOBX|160|TX||X| \nOBX|161|TX||X| \nOBX|162|TX||X| \nOBX|163|TX||X| \nOBX|164|TX||X| \nOBX|165|TX||X| \nOBX|166|TX||X| \nOBX|167|TX||X| \nOBX|168|TX||X| \nOBX|169|TX||X| \nOBX|170|TX||X| \nOBX|171|TX||X| \nOBX|172|TX||X| \nOBX|173|TX||X| \nOBX|174|TX||X| \nOBX|175|TX||T| \nOBX|176|TX||T|PATIENT NAME: SMITH,JENNIFER MICHELLE          ACCOUNT # Z72612731567\n"
  //"MSH|^~\\&|13^1.2.840.114350.1.13.340.2.7.2.695071^ISO|MSLP|||20170921102013|LABBACKGROUND|ORU^R01|EPIC_MSLP_ORU_7F454_4F7CA5_0_FC23|P|2.1||Epic_Mountain_PRD|||USA||||PHLabReport-Ack^^2.16.840.1.114222.4.10.3^ISO\nSFT|Epic Systems Corporation^L^^^^ANSI&1.2.840&ISO^XX^^^1.2.840.114350|Epic 2015 |Bridges|8.2.2.0||20161103111226\nPID|1||1000655396^^^EPIC&1.2.840.114350.1.13.340.2.7.5.698084.0&ISO^MRN||Hartline^Sharon^Kay||19620512|F||W|11012 S LONGDALE CIR^^SANDY^UT^84092^USA^P^^SALT LAKE||(801)597-5718^P^H^^^801^5975718~^NET^Internet^hlinejssc@msn.com|(801)265-4307^P^W^^^801^2654307||||30636592||||Not Hispanic||||||||N|||20130913194517|1^1.2.840.114350.1.13.340.2.7.2.696570^ISO\nNK1|1|HARTLINE^JOHN^^|01|11012 S LONGDALE CIR^^SANDY^UT^84092^USA^^^SALT LAKE|(801)597-3932^^H^^^801^5973932\nNK1|2|||575 W MURRAY BLVD^^MURRAY^UT^84123^USA|||||||||3M - MURRAY\nPV1|1|S|MSLPOR^LP.OR^NONE^MSLP^^^^^^^|L|||NDB0632^MEADOWS^JAMES^^^^^^THREEFOUR^^^^THREEFOUR~MEAJA1^MEADOWS^JAMES^^^^^^PROVID^^^^PROVID|NDB0632^MEADOWS^JAMES^^^^^^THREEFOUR^^^^THREEFOUR~MEAJA1^MEADOWS^JAMES^^^^^^PROVID^^^^PROVID||SURG|||||||NDB0632^MEADOWS^JAMES^^^^^^THREEFOUR^^^^THREEFOUR~MEAJA1^MEADOWS^JAMES^^^^^^PROVID^^^^PROVID||30636592|||||||||||||||||HOME OR SELF||||||||20170920115100|20170920162000\nORC|RE|66512143^EPIC^1.2.840.114350.1.13.340.2.7.2.798268^ISO|LP17-00818^Beaker^1.2.840.114350.1.13.340.2.7.3.798268.320^ISO|LP17-00818^Beaker^1.2.840.114350.1.13.340.2.7.3.798268.320^ISO||||||||MEAJA1^MEADOWS^JAMES^^^^^^PROVID&PROVID&ISO^^^^PROVID~NDB0632^MEADOWS^JAMES^^^^^^THREEFOUR^^^^THREEFOUR||(801)571-9433^^^^^801^5719433|||||||MTN UTAH^D^^^^MOUNTAIN PRD&1.2.840.114350.1.13.340.2.7.2.696570&ISO^XX^^^100|||9844 SOUTH 1300 EAST  STE 100^ALTAVIEW SPORTS MEDICINE^SANDY^UT^84094^USA^C^^SALT LAKE\nOBR|1|66512143^EPIC^1.2.840.114350.1.13.340.2.7.2.798268^ISO|LP17-00818^Beaker^1.2.840.114350.1.13.340.2.7.3.798268.320^ISO|LAB1126^TISSUE EXAM^EPICPROC|||20170920141700||||Unit Collect||Pre-op diagnosis: LEFT TIBIA 2cm SUBCUTANEOUS MASS, RIGHT 3RD TOE DORSAL MUCOUS CYST (R22.42, M67.471)|||MEAJA1^MEADOWS^JAMES^^^^^^PROVID&PROVID&ISO^^^^PROVID~NDB0632^MEADOWS^JAMES^^^^^^THREEFOUR^^^^THREEFOUR|(801)571-9433^^^^^801^5719433|||||20170921102000||Path|F|||NDB0632^MEADOWS^JAMES^^||||&Elizabeth J Jensen&MD&&\nTQ1|1||||||20170920142945||R\nOBX|1|ST|2002971^LAB AP FINAL DIAGNOSIS (RICH)^EPICCOMP||LEFT TIBIA MASS, EXCISION: LIPOMA.||||||F|||20170920141700|||||20170921102010||||ST MARKS LABORATORY^D^^^^^^^^STMH|1200 E 3900 S^^SALT LAKE CITY^UT^84124^USA^B^^SALT LAKE\nOBX|2|ST|2002971^LAB AP FINAL DIAGNOSIS (RICH)^EPICCOMP||Electronically signed by Elizabeth J Jensen, MD on 9/21/2017 at 1020||||||F|||20170920141700|||||20170921102010||||ST MARKS LABORATORY^D^^^^^^^^STMH|1200 E 3900 S^^SALT LAKE CITY^UT^84124^USA^B^^SALT LAKE\nOBX|3|ST|2002978^LAB AP MICROSCOPIC DESCRIPTION (RICH)^EPICCOMP||Sections show lobulated, mature adipose tissue with fibrous connective ||||||F|||20170920141700|||||20170921102010||||ST MARKS LABORATORY^D^^^^^^^^STMH|1200 E 3900 S^^SALT LAKE CITY^UT^84124^USA^B^^SALT LAKE\nOBX|4|ST|2002978^LAB AP MICROSCOPIC DESCRIPTION (RICH)^EPICCOMP||tissue lining, consistent with lipoma.  No areas of increased cellularity ||||||F|||20170920141700|||||20170921102010||||ST MARKS LABORATORY^D^^^^^^^^STMH|1200 E 3900 S^^SALT LAKE CITY^UT^84124^USA^B^^SALT LAKE\nOBX|5|ST|2002978^LAB AP MICROSCOPIC DESCRIPTION (RICH)^EPICCOMP||or cytologic atypia are appreciated.||||||F|||20170920141700|||||20170921102010||||ST MARKS LABORATORY^D^^^^^^^^STMH|1200 E 3900 S^^SALT LAKE CITY^UT^84124^USA^B^^SALT LAKE\nOBX|6|ST|2002976^LAB AP GROSS DESCRIPTION (RICH)^EPICCOMP||Received in formalin, labeled \"\"Sharon Kay Hartline, left tibia mass,\"\" are ||||||F|||20170920141700|||||20170921102010||||ST MARKS LABORATORY^D^^^^^^^^STMH|1200 E 3900 S^^SALT LAKE CITY^UT^84124^USA^B^^SALT LAKE\nOBX|7|ST|2002976^LAB AP GROSS DESCRIPTION (RICH)^EPICCOMP||2 lobulated fragments of adipose tissue, measuring 0.8 and 2.0 cm in ||||||F|||20170920141700|||||20170921102010||||ST MARKS LABORATORY^D^^^^^^^^STMH|1200 E 3900 S^^SALT LAKE CITY^UT^84124^USA^B^^SALT LAKE\nOBX|8|ST|2002976^LAB AP GROSS DESCRIPTION (RICH)^EPICCOMP||greatest dimension.  The margins are inked blue.  Sectioning reveals ||||||F|||20170920141700|||||20170921102010||||ST MARKS LABORATORY^D^^^^^^^^STMH|1200 E 3900 S^^SALT LAKE CITY^UT^84124^USA^B^^SALT LAKE\nOBX|9|ST|2002976^LAB AP GROSS DESCRIPTION (RICH)^EPICCOMP||yellow and glistening surfaces without areas of necrosis or hemorrhage.  ||||||F|||20170920141700|||||20170921102010||||ST MARKS LABORATORY^D^^^^^^^^STMH|1200 E 3900 S^^SALT LAKE CITY^UT^84124^USA^B^^SALT LAKE\nOBX|10|ST|2002976^LAB AP GROSS DESCRIPTION (RICH)^EPICCOMP||The specimen is submitted entirely in cassette A1.  JM/msn||||||F|||20170920141700|||||20170921102010||||ST MARKS LABORATORY^D^^^^^^^^STMH|1200 E 3900 S^^SALT LAKE CITY^UT^84124^USA^B^^SALT LAKE\nOBX|11|ST|2003022^LAB AP CASE REPORT(RICH)^EPICCOMP||Surgical Pathology Report                         Case: LP17-00818                                ||||||F|||20170920141700|||||20170921102010||||ST MARKS LABORATORY^D^^^^^^^^STMH|1200 E 3900 S^^SALT LAKE CITY^UT^84124^USA^B^^SALT LAKE\nOBX|12|ST|2003022^LAB AP CASE REPORT(RICH)^EPICCOMP||Authorizing Provider:  James Meadows, MD          Collected:           09/20/2017 1417            ||||||F|||20170920141700|||||20170921102010||||ST MARKS LABORATORY^D^^^^^^^^STMH|1200 E 3900 S^^SALT LAKE CITY^UT^84124^USA^B^^SALT LAKE\nOBX|13|ST|2003022^LAB AP CASE REPORT(RICH)^EPICCOMP||Ordering Location:     Lone Peak Operating Room   Received:            09/20/2017 1443            ||||||F|||20170920141700|||||20170921102010||||ST MARKS LABORATORY^D^^^^^^^^STMH|1200 E 3900 S^^SALT LAKE CITY^UT^84124^USA^B^^SALT LAKE\nOBX|14|ST|2003022^LAB AP CASE REPORT(RICH)^EPICCOMP||Pathologist:           Elizabeth J Jensen, MD                                                     ||||||F|||20170920141700|||||20170921102010||||ST MARKS LABORATORY^D^^^^^^^^STMH|1200 E 3900 S^^SALT LAKE CITY^UT^84124^USA^B^^SALT LAKE\nOBX|15|ST|2003022^LAB AP CASE REPORT(RICH)^EPICCOMP||Specimen:    Leg, Left, Left Tibia Mass                                                           ||||||F|||20170920141700|||||20170921102010||||ST MARKS LABORATORY^D^^^^^^^^STMH|1200 E 3900 S^^SALT LAKE CITY^UT^84124^USA^B^^SALT LAKE\nSPM|1|^LP17-00818&Beaker&1.2.840.114350.1.13.340.2.7.3.798268.320&ISO||Tissue^Tissue^^^^^^||||LL^Leg, Left^^^^^^^|||||||||20170920141700|20170920161901\n"
  //"MSH|^~\\&||COCMEN|||201709101140||MDM^T02|MT_COCMEN_MDM_MENDPTO.1.2367444|P|2.1|||||\nPID|1||X00599472|I29465|WILLARD^ALICE^MARY|PATRICIA|19561010|F|WOODWARD^ALICE^M^^^^M~WILLARD^ALICE^^^^^A|W|117 W RUBY AVE^^INDEPENDENCE^MO^64050|JAC|816-716-4508|816-523-0100||M|RLD.RLD|X72308371817|492-66-1427\nPV1|1|O|X.SURG|EL|||MCCLO^McCroskey^Lon^C^^^MD^^^^^^XX|MCCLO^McCroskey^Lon^C^^^MD^^^^^^XX|ALCTH^Alcox^Thomas^J^^^MD^^^^^^XX|||||PR||||SDC||08||||||||||||||||HOM|||COCMEN||DEP|||201709051242|201709051242|||||||MCCLO^McCroskey^Lon^C^^^MD^^^^^^XX\nTXA||PATH^SURGICAL PATHOLOGY REPORT|201709101140|201709101139||201709061053|201709101139||RARJA^Rarick^Jason^M^^^MD||TRANS^COPATH^CERNER|X.PATH20170910-0001^M17-39186_5816159 CoPathPlus|||X.PATH|PATH|Signed|||||RARJA^Rarick^Jason^M^^^MD^^^^^^^^201709101139\nOBX|1|TX||H|                             Menorah Medical Center\nOBX|2|TX||H|                             5721 West 119th Street\nOBX|3|TX||H|                          Overland Park, Kansas  66209\nOBX|4|TX||H|                              Phone: 913-498-6000\nOBX|5|TX||H| \nOBX|6|TX||H|PATIENT NAME:     WILLARD,ALICE MARY                LOCATION: X.SURG    \nOBX|7|TX||H|MEDICAL RECORD#:  X00599472                         ACCOUNT#: X72308371817\nOBX|8|TX||H|DATE OF BIRTH:    10/10/56                          ROOM/BED:                   \nOBX|9|TX||H|DATE OF ADMIT:                                 REPORT STATUS: Signed   \nOBX|10|TX||H| \nOBX|11|TX||H|ATTEND PHYSICIAN:       McCroskey,Lon C  MD           \nOBX|12|TX||H|PRIMARY CARE PHYSICIAN: Alcox,Thomas J  MD            \nOBX|13|TX||H|REFERRING PHYISICIAN:   McCroskey,Lon C  MD           \nOBX|14|TX||H| \nOBX|15|TX||H|                            SURGICAL PATHOLOGY REPORT     \nOBX|16|TX||X| \nOBX|17|TX||X| \nOBX|18|TX|||**Final Report **\nOBX|19|TX||| \nOBX|20|TX||| \nOBX|21|TX||| \nOBX|22|TX|||SPECIMEN DETAILS:\nOBX|23|TX|||Collected:  9/5/2017 00:00\nOBX|24|TX|||Received:  9/6/2017 10:52\nOBX|25|TX|||Reported:  9/10/2017 11:39\nOBX|26|TX|||Accession #:  M17-39186  \nOBX|27|TX||| \nOBX|28|TX||| \nOBX|29|TX||| \nOBX|30|TX|||FINAL DIAGNOSIS:\nOBX|31|TX|||Left breast, segmental resection:  \nOBX|32|TX|||     - Breast tissue with biopsy site changes present.\nOBX|33|TX|||     - Skin with scare formation.\nOBX|34|TX|||     - No evidence of residual invasive or in-situ\nOBX|35|TX|||carcinoma. \nOBX|36|TX||| \nOBX|37|TX|||ELECTRONICALLY SIGNED BY:   Jason M. Rarick, MD  Cell:\nOBX|38|TX|||440-396-5690\nOBX|39|TX|||DATE/TIME:   9/10/2017 11:39\nOBX|40|TX||| \nOBX|41|TX|||PHYSICIAN(S):\nOBX|42|TX|||Dr. Lon McCroskey\nOBX|43|TX||| \nOBX|44|TX|||Specimen(s) Received:\nOBX|45|TX|||A.Left breast segmental resection\nOBX|46|TX||| \nOBX|47|TX||| \nOBX|48|TX|||GROSS DESCRIPTION:\nOBX|49|TX|||The specimen is received fresh, labeled \"\"Alice Willard, left\nOBX|50|TX|||breast segmental resection\"\" is a suture oriented breast\nOBX|51|TX|||resection specimen measuring 4.4 x 3.2 x 1.2 cm.  The\nOBX|52|TX|||superior aspect is surfaced by tan-gray, wrinkled skin. \nOBX|53|TX|||This strip of skin measures 4.8 x 0.4 cm.  A linear,\nOBX|54|TX|||well-healed scar is noted measuring 3.5 cm.  The specimen is\nOBX|55|TX|||marked with multiple sutures.  A short suture is present\nOBX|56|TX|||near the skin designating the new superficial margin and a\nOBX|57|TX||T| \nOBX|58|TX||T|PATIENT NAME: WILLARD,ALICE MARY               ACCOUNT # X72308371817\nOBX|59|TX||X| \nOBX|60|TX||X| \nOBX|61|TX||X| \nOBX|62|TX|||long suture is noted along one edge designating the lateral\nOBX|63|TX|||margin.  Prior to sectioning the superior aspect is inked\nOBX|64|TX|||blue, the deep surface is inked green and the inferior\nOBX|65|TX|||aspect is inked black.  The specimen has been previously\nOBX|66|TX|||opened along the superior aspect.  This opening exposes the\nOBX|67|TX|||underlying parenchyma.  The specimen is sectioned from\nOBX|68|TX|||medial to lateral.  The cut surface is 80% tan-yellow\nOBX|69|TX|||lobulated adipose tissue and 20% gray-white fibrous breast\nOBX|70|TX|||parenchyma.  Focal cystic areas are noted within the\nOBX|71|TX|||parenchyma measuring up to 0.2 cm.  No additional\nOBX|72|TX|||abnormalities are noted.  The specimen is serially sectioned\nOBX|73|TX|||and entirely submitted from the medial to lateral aspects in\nOBX|74|TX|||cassettes A1-A10.\nOBX|75|TX|||(JWP; 9/6/2017)\nOBX|76|TX||| \nOBX|77|TX|||CLINICAL HISTORY:\nOBX|78|TX|||Carcinoma left breast with recent lumpectomy and close\nOBX|79|TX|||margins\nOBX|80|TX||| \nOBX|81|TX||| \nOBX|82|TX||| \nOBX|83|TX|||INITIAL CPT CODE(S):\nOBX|84|TX|||A; 88307\nOBX|85|TX|||Professional services performed under supervision of LabCorp\nOBX|86|TX|||Medical Director at 5721 W. 119th Street, Overland Park, KS\nOBX|87|TX|||66209. Technical services performed under supervision of\nOBX|88|TX|||LabCorp Medical Director at 7301 College Blvd, #110,\nOBX|89|TX|||Overland Park, KS 66210.\nOBX|90|TX||| \nOBX|91|TX||| \nOBX|92|TX|||    \nOBX|93|TX|||LabCorp  7301 College Blvd, Suite 110 - Overland Park, KS\nOBX|94|TX|||66210 - PHONE:  913-338-4070\nOBX|95|TX||| \nOBX|96|TX|||* * *  END OF REPORT  * * *\nOBX|97|TX||X| \nOBX|98|TX||X| \nOBX|99|TX||X| \nOBX|100|TX||X| \nOBX|101|TX||X| \nOBX|102|TX||X| \nOBX|103|TX||X|Electronically Signed by Jason M Rarick, MD on 09/10/17 at 1140\nOBX|104|TX||X| \nOBX|105|TX||X| \nOBX|106|TX||X| \nOBX|107|TX||X| \nOBX|108|TX||X| \nOBX|109|TX||X| \nOBX|110|TX||X| \nOBX|111|TX||X| \nOBX|112|TX||X| \nOBX|113|TX||X| \nOBX|114|TX||X| \nOBX|115|TX||X| \nOBX|116|TX||T| \nOBX|117|TX||T|PATIENT NAME: WILLARD,ALICE MARY               ACCOUNT # X72308371817\n"
  // "MSH|^~\\&||COCCM|||201709100149||ORU^R01|MT_COCCM_ORU_CMGTPACS.1.1354097|P|2.1\nPID|1||Z00773963|M82426|MULLINS^ANDREA^ELIZABETH^^^||19760817|F||||||||||Z72612724740|488-96-1240\nPV1|1|E|Z.ER^^||||LOHBR^Lohnes^Brian^J^^^DO^^^^^^^^^727-437-3551|.SELF^REFERRED^SELF^^^^|.NOPCP^Physician^No^Primary or Family^^^||||||||^^^^^^|ER|||||||||||||||||||||COCCM||REG|||||||||||.SELF^REFERRED^SELF^^^^\nORC|RE||||S|N|||||||COCCM^CMC\nOBR|1|801142603&N&N| - ABD   PELVIS W/O CONT|ABPEL^ - ABD   PELVIS W/O CONT^CT|S|201709092245|201709100138|201709100138||||||||LOHBR|727-437-3551|LOHBR~STOME1|||||||F||||||^flank pain radiates into abdomen|JOHNA1&Johnson&Nathan&S&&&MD^^201709100147||||201709092245\nZUR|1|Z00773963\nZUR|2|801142603\nZUR|3|rhmcmkws01dc.hca.corpad.net\nZUR|4|COCCM\nOBX|1|TX|801142603^ - ABD   PELVIS W/O CONT^ABPEL|1| ~  CENTERPOINT MEDICAL CENTER        Name: MULLINS,ANDREA ELIZABETH      ~  19600 E. 39th St.                 Phys: Lohnes,Brian J  DO            ~  Independence, MO  64057           DOB: 08/17/1976   Age: 41       Sex: F~                                    Acct: Z72612724740  Loc: Z.ER      ~  PHONE #: 816-698-7130             Exam Date: 09/09/2017 Status: REG ER  ~    FAX #: 816-698-7131             Radiology No:           ~                                Unit No: Z00773963     ~ ~ ~ ~  EXAMS:                             REASON FOR EXAM:            CPT CODES:  ~801142603 ABD   PELVIS W/O CONT    flank pain radiates into a  74176  ~ ~          ~     INDICATION: flank pain radiates into abdomen  ~        ~     COMPARISON: None.  ~        ~     TECHNIQUE:   ~        ~     Axial CT images were obtained through the abdomen and pelvis without  ~     intravenous contrast.    ~     Limited assessment of solid organ structures and vasculature secondary  ~     to lack of intravenous contrast.  ~        ~     One or more of the following individualized dose reduction techniques  ~     were utilized for this examination:  1. Automated exposure control;   ~     2. Adjustment of the mA and/or kV according to patient size;  3. Use  ~     of iterative reconstruction technique.  ~        ~     FINDINGS:  ~        ~     Chest Base: Partially imaged without gross abnormality.  ~     Vessels: No abdominal aortic aneurysm.  ~     Liver/Biliary: Region of low attenuation within the liver anteriorly  ~     measuring approximately 2 cm. Could be from causes such as a cystic  ~     lesion.  ~     Pancreas: No peripancreatic edema.  ~     Spleen: Suspected subcentimeter low-attenuation lesion, too small to  ~     characterize.  ~     Kidneys/Adrenal: There is a possible 1 mm calcification at the left  ~     ureterovesicular junction. There are couple of nonobstructive right  ~     renal stones measuring up to 2 mm. No hydronephrosis.  ~     Bladder: No definite adjacent inflammation.  ~     GI: No free air.  No bowel dilation to suggest obstruction.  ~     Fullness of left adnexa.  ~     There is some apparent fatty atrophy of right rectus musculature.  ~     Small fat-containing umbilical hernia. Degenerative changes spine.  ~        ~        ~       IMPRESSION:  ~          ~        Nonobstructive right renal stones as well as a possible 1 mm  ~       calcification at the expected location of the left ureterovesicular  ~       junction. This is very small and may be artifactual in nature but a  ~       tiny ureter stone is possible. No associated hydronephrosis.  ~          ~       No evidence of bowel obstruction.  ~            ~ ~PAGE  1                       Signed Report                    (CONTINUED)~ ~ ~  CENTERPOINT MEDICAL CENTER        Name: MULLINS,ANDREA ELIZABETH      ~  19600 E. 39th St.                 Phys: Lohnes,Brian J  DO            ~  Independence, MO  64057           DOB: 08/17/1976   Age: 41       Sex: F~                                    Acct: Z72612724740  Loc: Z.ER      ~  PHONE #: 816-698-7130             Exam Date: 09/09/2017 Status: REG ER  ~    FAX #: 816-698-7131             Radiology No:           ~                                Unit No: Z00773963     ~ ~ ~ ~  EXAMS:                             REASON FOR EXAM:            CPT CODES:  ~801142603 ABD   PELVIS W/O CONT    flank pain radiates into a  74176  ~   <Continued>~ ~         Fullness of left adnexa. Could be secondary to a left ovarian lesion  ~       or prominence of the left ovary. If further clarification is desired  ~       ultrasound could better evaluate.  ~          ~       At the T10 vertebral body there is lytic lesion with reinforce  ~       trabeculation replacing the majority of the vertebral body. The most  ~       common cause would be vertebral body hemangioma but other causes are  ~       not entirely excluded on this exam. If more complete evaluation is  ~       desired MRI could better evaluate. There is also some mild loss of  ~       height of this vertebral body.  ~            ~ ~     ~          ** Electronically Signed by M.D. NATHAN JOHNSON **  ~          **             on 09/10/2017 at 0147            **  ~                    Reported and signed by: NATHAN JOHNSON, M.D.    ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~CC: Brian J Lohnes DO                                                 ~                                                                      ~Dictated Date/Time: 09/10/2017 (0138)~Technologist: JTB                                                    ~Transcribed Date/Time: 09/10/2017 (0138)~Transcriptionist: RADPS                              ~Electronic Signature Date/Time: 09/10/2017 (0147)~Orig Print D/T: S: 09/10/2017 (0149)                        ~                                     BATCH NO: N/A       ~ ~PAGE  2                       Signed Report                               \n"
  // "MSH|^~\\&|MT_FRNK|FRNK|DBM||20151211111300-0600||ADT^A01|MT_FRNK_ADT_1113861.|D|2.5||KYB|||\nEVN|A01|201512111112|||QBE8554^Hammock^Brittany|201512111111\nPID|1||K000002378^^^^MR^FRNK~206-11-2015^^^^SS^FRNK~A00002349^^^^HUB^FRNK|A0-B20151103134433868^^^^URN^FRNK|Osborn^Harry^^^^^L~Osborn^Harold^^^^^M|Osborn,Emily|19411029|M||W|234 MARVEL^^FRANKLIN^TN^37064^^P^^TN187||(615)555-6309|(502)695-0070||S|NON|FR0000121392|\nNK1|1|OSBORN^NORMAN|PA^Parent|234 MARVEL^^FRANKLIN^TN^37064^^^^TN187|(615)555-6309||NOK\nNK1|2|OSBORN^HARRY|PA^Parent|234 MARVEL^^FRANKLIN^TN^37064^^^^TN187|(615)555-6309||NOT\nNK1|3|AMERWIRE||616 INDUSTRIAL PARK^^FRANKFORT^KY^40601||(502)695-0070|EMP||||||AMERICAN WIRE COMPANY FRANKFT|||||||||||||||||||||F\nPV1|1|I|FR.TR^FR.TR4^A|EL|||DR.ATND01^Attending01^Provider^^^^^^^^^^XX|DR.OTH01^Other01^Provider^^^^^^^^^^XX||GP||||CR|||DR.ADM01^Admitting01^Provider^^^^^^^^^^XX|IN||05|||||||||||||||||||FRNK||ADM|||201512111111||||||||DR.FAM01^Family01^Provider^^^^^^^^^^XX\nPV2||P^Private Room|LACERATION OF RIGHT HAND|||||||1|1||||||||||||||EL|||||||||||N||||||71^Full Care in Unit\nROL|1|AD|AT|DR.ATND01^Attending01^Provider^^^^^^^^^^XX\nROL|2|AD|RP|DR.OTH01^Other01^Provider^^^^^^^^^^XX\nROL|3|AD|AD|DR.ADM01^Admitting01^Provider^^^^^^^^^^XX\nROL|4|AD|FHCP|DR.FAM01^Family01^Provider^^^^^^^^^^XX\nROL|5|AD|PP|DR.PCP01^PrimaryCare01^Provider^^^^^^^^^^XX\nROL|6|AD|CP|DR.CONS01^Consulting01^Provider\nOBX|1|TX|1PAO0F010A^Deposit Req?^ADM||N||||||F\nOBX|2|TX|1PAO0F011A^Est Amt Due^ADM||||||||F\nOBX|3|TX|1PAO0F012A^Amt Rec^ADM||||||||F\nOBX|4|TX|1PAO0F014A^Collected by^ADM||||||||F\nOBX|5|TX|1PAO0F016A^Pt Advised of Financial Responsibility   Resources, Refer to^ADM||||||||F\nOBX|6|TX|1PAO0F017A^Discharge Financial Status^ADM||||||||F\nOBX|7|TX|1PAO0F031A^Amt Req^ADM||||||||F\nOBX|8|TX|1PAO0F330A^Electronic Patient Statements^ADM||N||||||F\nOBX|9|TX|1PAO0F331A^Use Guarantor Cell Phone for Text/SMS Messaging^ADM||N||||||F\nOBX|10|CE|1PAO0G010A^Patient Confidential Address/Phone or Guar Temp Address?^ADM||T^Guarantor Temp Address||||||F\nOBX|11|TX|1PAO0G011A^Address^ADM||1 Guarantor Address||||||F\nOBX|12|TX|1PAO0G012A^Address^ADM||||||||F\nOBX|13|TX|1PAO0G013A^City^ADM||Nashville||||||F\nOBX|14|TX|1PAO0G014A^State^ADM||TN||||||F\nOBX|15|TX|1PAO0G015A^Zip^ADM||37203||||||F\nOBX|16|TX|1PAO0G016A^County^ADM||TN037||||||F\nOBX|17|TX|1PAO0G017A^Country^ADM||US||||||F\nOBX|18|TX|1PAO0G018A^Phone^ADM||615-555-6311||||||F\nOBX|19|TX|1PAO0G019A^Temporary Address Until:^ADM||20151211||||||F\nOBX|20|TX|1PAO0G020A^Comment^ADM||||||||F\nOBX|21|TX|1PAO0G021A^Preferred Language^ADM||ENG||||||F\nOBX|22|TX|1PAO0G022A^Country^ADM||US||||||F\nOBX|23|TX|1PAO0G050A^Does Guarantor Have Additional Employment?^ADM||Y||||||F\nOBX|24|TX|1PAO0G051A^Name:^ADM||BLUEGRCA||||||F\nOBX|25|TX|1PAO0G052A^Address^ADM||214 E COURT ST||||||F\nOBX|26|TX|1PAO0G053A^Address^ADM||||||||F\nOBX|27|TX|1PAO0G054A^City^ADM||LAWRENCEBURG||||||F\nOBX|28|TX|1PAO0G055A^State^ADM||KY||||||F\nOBX|29|TX|1PAO0G056A^Zip^ADM||40342||||||F\nOBX|30|TX|1PAO0G057A^Work Phone^ADM||(502)839-7102||||||F\nOBX|31|TX|1PAO0G058A^Guar Occup^ADM||TECh||||||F\nOBX|32|TX|1PAO0G059A^Emp Status^ADM||F||||||F\nOBX|33|TX|1PAO0G060A^Description^ADM||BLUEGRASS COMMUNITY ACTI||||||F\nOBX|34|TX|1PAO0O010A^Do You Wish to Identify Another Guarantor?^ADM||N||||||F\nOBX|35|TX|1PAO0O011A^Name:^ADM||||||||F\nOBX|36|TX|1PAO0O012A^Birthdate^ADM||||||||F\nOBX|37|TX|1PAO0O013A^Sex^ADM||||||||F\nOBX|38|TX|1PAO0O014A^Social Security #^ADM||||||||F\nOBX|39|TX|1PAO0O015A^Relationship to Patient^ADM||||||||F\nOBX|40|TX|1PAO0O016A^Address^ADM||||||||F\nOBX|41|TX|1PAO0O017A^Address^ADM||||||||F\nOBX|42|TX|1PAO0O018A^City^ADM||||||||F\nOBX|43|TX|1PAO0O019A^State^ADM||||||||F\nOBX|44|TX|1PAO0O020A^Zip^ADM||||||||F\nOBX|45|TX|1PAO0O021A^County^ADM||||||||F\nOBX|46|TX|1PAO0O022A^Country^ADM||||||||F\nOBX|47|TX|1PAO0O023A^Home Phone^ADM||||||||F\nOBX|48|TX|1PAO0O025A^Name:^ADM||||||||F\nOBX|49|TX|1PAO0O026A^Address^ADM||||||||F\nOBX|50|TX|1PAO0O027A^Address^ADM||||||||F\nOBX|51|TX|1PAO0O028A^City^ADM||||||||F\nOBX|52|TX|1PAO0O029A^State^ADM||||||||F\nOBX|53|TX|1PAO0O030A^Zip^ADM||||||||F\nOBX|54|TX|1PAO0O031A^Work Phone^ADM||||||||F\nOBX|55|TX|1PAO0O032A^Other Guarantor Occupation^ADM||||||||F\nOBX|56|TX|1PAO0O033A^Emp Status^ADM||||||||F\nOBX|57|TX|1PAO0O034A^Description^ADM||||||||F\nOBX|58|TX|1PAO0P010A^Does the Patient Have Temporary Address?^ADM||Y||||||F\nOBX|59|TX|1PAO0P011A^Address^ADM||1 Temporary Address||||||F\nOBX|60|TX|1PAO0P012A^Address^ADM||||||||F\nOBX|61|TX|1PAO0P013A^City^ADM||City||||||F\nOBX|62|TX|1PAO0P014A^State^ADM||TN||||||F\nOBX|63|TX|1PAO0P015A^Zip^ADM||37203||||||F\nOBX|64|TX|1PAO0P016A^Home PH^ADM||615-555-6309||||||F\nOBX|65|TX|1PAO0P017A^County^ADM||TN037||||||F\nOBX|66|TX|1PAO0P018A^Country^ADM||US||||||F\nOBX|67|TX|1PAO0P019A^Temporary Address Until?^ADM||20151211||||||F\nOBX|68|TX|1PAO0P020A^Comment^ADM||||||||F\nOBX|69|TX|1PAO0P050A^Does Patient Have Additional Employment?^ADM||Y||||||F\nOBX|70|TX|1PAO0P051A^Name:^ADM||ARTS||||||F\nOBX|71|TX|1PAO0P052A^Address^ADM||411 HOLMES STREET||||||F\nOBX|72|TX|1PAO0P053A^Address^ADM||||||||F\nOBX|73|TX|1PAO0P054A^City^ADM||FRANKFORT||||||F\nOBX|74|TX|1PAO0P055A^State^ADM||KY||||||F\nOBX|75|TX|1PAO0P056A^Zip^ADM||40601||||||F\nOBX|76|TX|1PAO0P057A^Work Phone^ADM||(502)223-5754||||||F\nOBX|77|TX|1PAO0P058A^Occupation^ADM||Tech||||||F\nOBX|78|TX|1PAO0P059A^Emp Status^ADM||F||||||F\nOBX|79|TX|1PAO0P060A^Preferred Language^ADM||ENG||||||F\nOBX|80|TX|1PAO0P061A^Country^ADM||US||||||F\nOBX|81|TX|1PAO0P062A^Description^ADM||ARTS ELECTRIC INC FRANKF||||||F\nOBX|82|CE|1REG0M229A^Ethnicity^ADM||NOTHISPLAT^Not Hispanic or Latino||||||F\nOBX|83|TX|1REG0M230A^Additional Race^ADM||W||||||F\nOBX|84|TX|1REG0R020A^Do You Have an Advance Directive?^ADM||Y||||||F\nOBX|85|TX|1REG0R021A^If No, do You Want Information?^ADM||||||||F\nOBX|86|TX|1REG0R022A^If Yes, Have You Provided the Hospital with a Current Copy?^ADM||N||||||F\nOBX|87|TX|1REG0R023A^Do You Have a Durable Power of Attorney for Health Care?^ADM||N||||||F\nOBX|88|TX|1REG0R024A^If No, do You Want Information?^ADM||N||||||F\nOBX|89|TX|1REG0R025A^If Yes, Have You Provided the Hospital with a Current Copy?^ADM||||||||F\nOBX|90|TX|1REG0R027A^Are you currently participating in a research study^ADM||N||||||F\nOBX|91|CE|1REG0R048A^have Ebola^ADM||NO^No||||||F\nOBX|92|TX|E13010001A^Preferred name^ADM||Harry||||||F\nOBX|93|TX|E13010038A^Immediate religious, spiritual, or cultural considerations^ADM||NONE||||||F\nOBX|94|TX|N42010134A^Patient reports prior history of TB or positive TB skin test^ADM||N||||||F\nOBX|95|TX|N42010136A^Patient reports close contact with a person who has TB^ADM||N||||||F\nOBX|96|TX|N42010138A^Close contact with any person having flu-like illness^ADM||N||||||F\nOBX|97|TX|N42010140A^TB Point of entry screen^ADM||NEGATIVE||||||F\nOBX|98|TX|N42010142A^Contagious respiratory infection point of entry screen^ADM||NEGATIVE||||||F\nOBX|99|TX|N42010146A^Fever greater than 37.8 C (100.4 F)^ADM||N||||||F\nOBX|100|TX|N42010147A^Cough (not related to allergy or COPD)^ADM||N||||||F\nOBX|101|TX|N42010170A^Sore throat^ADM||N||||||F\nOBX|102|TX|N42010171A^Night sweats^ADM||N||||||F\nOBX|103|TX|N42010172A^Unexplained weight loss^ADM||N||||||F\nOBX|104|TX|N42010173A^Fatigue (Tiredness)^ADM||N||||||F\nOBX|105|TX|N42010174A^Body aches^ADM||N||||||F\nOBX|106|TX|N42010175A^Rash^ADM||N||||||F\nOBX|107|TX|N42010176A^Nasal congestion (not related to allergies/sinus infection)^ADM||N||||||F\nOBX|108|TX|N42010179A^Travel outside of the US in the past 3 weeks^ADM||N||||||F\nOBX|109|TX|N4201A0100^Is patient present^ADM||Y||||||F\nOBX|110|TX|N4201A0118^Able to perform TB/respiratory point of entry screen^ADM||Y||||||F\nOBX|111|TX|N4201A0120^Reason unable to perform screen^ADM||||||||F\nOBX|112|CE|N4201A0141B^Resided in or traveled to a W African Country^ADM||NO^None||||||F\nOBX|113|CE|N4201A0143A^Had contact with anyone who has been to a W African Country^ADM||NO^No||||||F\nOBX|114|TX|N4201A0148A^Fever greater than 37.8 C (100.4 F)^ADM||N||||||F\nAL1|1|DA|F006002380^naproxen^^naproxen^^allergy.id|MO|Rash-Hives|20151110\nAL1|2|DA|F006002502^honey^^honey^^allergy.id|MI|Swelling|20151110\nAL1|3|DA|F006006698^bee venom (honey bee)^^bee venom (honey bee)^^allergy.id|SV|Anaphylaxis|20151110\nAL1|4||grass|MI|Cough|20151110\nDG1|1||S61.411A^LACERATION WITHOUT FOREIGN BODY OF RIGHT HAND, INIT ENCNTR^I10|||Other\nDRG|33\nGT1|1||OSBORN^HARRY||234 MARVEL^^FRANKLIN^TN^37064|(615)555-6309^^^emailline@test.com|||||SA|206-11-2015||||AMERWIRE|616 INDUSTRIAL PARK^^FRANKFORT^KY^40601|(502)695-0070||F\nIN1|1|AFLAC||AMERICAN FAMILY LIFE AFLAC|1932 WYNTON RD^^COLUMBUS^GA^31999||(800)992-3522|A123456789|BLUEGRASS COMMUNITY ACTION||AMERWIRE|20151211|20161212|123456789||SELCHOW^NEW|FR|19411211|234 MARVEL^^FRANKLIN^TN^37064^^P||||||||||20151211|QBE8554||||||18798709||||||F^Full Time|F|^^FRANKFORT|VERIFIED\nIN2|1|098-78-7890|||||||||||||||||||||||||||||||Y|||||||||AI|D||||||||||||||||||||(615)555-6309\nIN3|1|123456789||||20151211|||20151211|20161215\nUB2|1||71||||11^20151211\nACC|201512111057|11^Onset of Symptoms or Illness"
  //"MSH|^~\\&|IMG_RESULT|MSLP||IMG_RESULT|20170630110925|EDIRADIN|ORU^R01|EPIC_MSLP_ORU_3669490|P|2.1||Epic_Mountain_PRD|||||||\nPID|1|W173439^^SLCURN^SLCURN|1000661485^EPIC^MRN|D000010054^MCC^MCC~W000266661^SMHP^SnMHP|MCKENNEY-DAVIES^SUSANNA^CLARA||19670522|F|BLUMER^SUSANNA^C~MCKENNEYDAVIES^SUSANNA^CLARA^~MCKENNEY DAVIES^SUSANNA^|W|366 N 1200 EPLEASANT GROVE^UT^84062^USA^P^UTAH|UTAH|(801)859-4955^P^H|(801)268-7119^P^W||M||100331415|074-62-9371|||||||||||\nPD1|||LONE PEAK HOSPITAL^10002001|BENRI^BENNETT^RICHARD^W^^^PROVID^^PROVID~MAQ9147^BENNETT^RICHARD^W^^^THREEFOUR^^^THREEFOUR||||||||||||\nPV1||O|MSLPRD^^MSLP^^^^^||||BENRI^BENNETT^RICHARD^W^^^PROVID^^PROVID~MAQ9147^BENNETT^RICHARD^W^^^THREEFOUR^^THREEFOUR|BENRI^BENNETT^RICHARD^W^^^PROVID^^PROVID~MAQ9147^BENNETT^RICHARD^W^^^THREEFOUR^^^THREEFOUR|||||||||||30227288|||||||||||||||||||||||||20170630104430|||||||V\nORC|RE|796251^EPC|MSLP849741^EPC||Final||^^20170630110055^20170630110115^R||20170630110925|EDIRADIN^INTERFACE^RAD^RESULTS IN||BENRI^BENNETT^RICHARD^W^^^^PROVID^^PROVID~MAQ9147^BENNETT^RICHARD^W^^^THREEFOUR^^THREEFOUR|10002001006^10002001^^^^UT LP XR|(801)572-0311|||||||||||||||I\nOBR|1|796251^EPC|MSLP849741^EPC|IMG115^XR HIP 2-3V LEFT^RAD^XR HIP 2+ VW|R|20170630104431|||||Ancillary Pe|||||BENRI^BENNETT^RICHARD^W^^^PROVID^^PROVID~MAQ9147^BENNETT^RICHARD^W^^^THREEFOUR^^THREEFOUR|(801)572-0311|||||20170630110800||RG|Final||^20170630110055^20170630110115^R||||^Annual Physical exam|PANCO^PANUSHKA^COLE^J^^^PROVID^^PROVID~MMI9374^PANUSHKA^COLE^J^^^THREEFOUR^^THREEFOUR||BBI7712^JONES^CHELSEA||20170630104500||||||||IMG115^XR HIP 2-3V LEFT^RADXR HIP 2+ VW|LT(used to identify procedures performed on the left side of\nOBX|1|ST|&GDT|1|||||||Final||||9|BBI7712^JONES^CHELSEA^^||\nOBX|2|ST|&GDT|1|XR HIP 2-3V LEFT||||||Final||||9|BBI7712^JONES^CHELSEA^^||\nOBX|3|ST|&GDT|1|||||||Final||||9|BBI7712^JONES^CHELSEA^^||\nOBX|4|ST|&GDT|1|HISTORY: 50 years old Female with history of left hip pain||||||Final||||9|BBI7712^JONES^CHELSEA^^||\nOBX|5|ST|&GDT|1|||||||Final||||9|BBI7712^JONES^CHELSEA^^||\nOBX|6|ST|&GDT|1|COMPARISON: 10/15/2008||||||Final||||9|BBI7712^JONES^CHELSEA^^||\nOBX|7|ST|&GDT|1|||||||Final||||9|BBI7712^JONES^CHELSEA^^||\nOBX|8|ST|&GDT|1|FINDINGS: ||||||Final||||9|BBI7712^JONES^CHELSEA^^||\nOBX|9|ST|&GDT|1|||||||Final||||9|BBI7712^JONES^CHELSEA^^||\nOBX|10|ST|&GDT|1|AP pelvis with abducted view of the left hip. Joints appear symmetric. Bony pelvis appears normal. There is no fracture dislocation. The articulating surfaces are smooth and normal contour.||||||Final||||9|BBI7712^JONES^CHELSEA^^||\nOBX|11|ST|&GDT|1|||||||Final||||9|BBI7712^JONES^CHELSEA^^||\nOBX|12|ST|&IMP|2|||||||Final||||9|BBI7712^JONES^CHELSEA^^||\nOBX|13|ST|&IMP|2|IMPRESSION:||||||Final||||9|BBI7712^JONES^CHELSEA^^||\nOBX|14|ST|&IMP|2|||||||Final||||9|BBI7712^JONES^CHELSEA^^||\nOBX|15|ST|&IMP|2|||||||Final||||9|BBI7712^JONES^CHELSEA^^||\nOBX|16|ST|&IMP|2|Normal appearance the pelvis and left hip. No fracture dislocation.||||||Final||||9|BBI7712^JONES^CHELSEA^^||\nOBX|17|ST|&IMP|2|||||||Final||||9|BBI7712^JONES^CHELSEA^^||\nOBX|18|ST|&IMP|2|** Electronically Signed by Cole Panushka, MD on 6/30/2017 11:08 AM **||||||Final||||9|BBI7712^JONES^CHELSEA^^||\nOBX|19|ST|&GDT|2|||||||Final||||9|BBI7712^JONES^CHELSEA^^||\nOBX|20|ST|&GDT|2|Electronically Signed By Cole J Panushka, MD on 6/30/2017 11:08||||||Final||||9|BBI7712^JONES^CHELSEA^^||\nOBX|21|ST|&GDT|2|||||||Final||||9|BBI7712^JONES^CHELSEA^^||\nOBX|22|ST|&TCM|3|Px in left hip; trauma injury few years ago; kni injury since then; px comes and goes for last few years||||||Final||||9|BBI7712^JONES^CHELSEA^^||\nZDS|1.2.840.114350.2.340.2.798268.2.796251.1^EPIC^APPLICATION^DICOM"
  //"MSH|^~\\&|COCNW|COCNW|OV|OV|201706092307||RAS^O17|IP_COCNW_RAS_PHAWF.170609.2875|P|2.5||CAC^01554||\nPID|1||AF00769225^^^COCWF^MRN|AF713617|ELHAGE^KATIA||19540601|F||||||||||AF1002484898\nPV1|1|I|AF.5W^AF.502^1^COCWF|EM|||SHARAM^Shaarawy^Rami|||||||||||IN|||||||||||||||||||||||ADM\nORC|RE|14494418|08438036||AC||^ASDIR^As Directed||201706092306|||SHARAM|||201706091855\nRXA|1|1|201706092306||POT20/100^POTASSIUM CHLORIDE 20 MEQ/100 ML STER H20 PREMIX BAG^L^00338070548A^POTASSIUM CHLORIDE 20MEQ^NDC|1|MLS|100^1|026348|AFNURIXA|||||||||Y^Y|CP|D|||||IV\nRXR|IV^INTRAVEN.|VAD\nNTE|1|CO|Difference between amount dispensed\nNTE|2|CO|and amount administered was discarded.\nZSC|1|POT20/100^0338070548^POTASSIUM CHLORIDE 20 MEQ/100 ML STER H20 PREMIX BAG^POTASSIUM CHLORIDE 20MEQ^POTASSIUM CHLORIDE\n"
  // "MSH|^~\\&||COCMO|||201706112324||ADT^A02|MT_COCMO_ADT_MOGTADM.1.15851416|P|2.1\nEVN|A02|201706112324|||GNUR.ACM3^MAGALLANEZ^ADELL^^^^\nPID|1||G000326406|G227729|WILSON^TERRY^LYNN^^^|MARIAM|19560509|F|^^^^^|W|3315 INDIAN HORSE CT^^NORTH LAS VEGAS^NV^89032^USA^^^CLARK||(702)767-8574|(702)365-7111|ENG|M|OTH|G00016436394|561-98-5748\nPV1|1|I|G.2SE^G.2019^A|EM||G.ERH^G.ED10^A|QUIDU^Quiroz^Dulce^^^^DO|.SELF^REFERRED^SELF^^^^|.NO PCP^PHYSICIAN^NO^PRIMARY OR FAMILY^^^|MED||||PR|FR|N|QUIDU^Quiroz^Dulce^^^^DO|IN||08|||||||||||||||||||COCMO|GENERALIZED WEAKNESS, HYPERGLYCEMIA, UTI|ADM|||201706112203\nAL1|1|DA|F001000815^No Known Drug Intolerances^^^allergy.id|U|NKDA|20130423\nAL1|2|DA|No Known Contrast Allergies|U||20061211\nAL1|3|DA|No Known Drug Allergies|U||20061211\nAL1|4|DA|No Known Food Allergies|U||20061211\nAL1|5|DA|No Known Other Allergies|U||20061211\nACC|20170611^|11\nDG1|1|I10|R53.1|WEAKNESS||A||||||||||||N\nGT1|1||WILSON^TERRY^LYNN^^^||3315 INDIAN HORSE CT^^NORTH LAS VEGAS^NV^89032^USA^^^CLARK|(702)767-8574||19560509|F||SA|561-98-5748|||ORLEANS HOTEL   CASINO|4500 W TROPICANA AVE.^^LAS VEGAS^NV^89103|(702)365-7111|||F\nGT1|2||^^^^^||^^^^^^^^|||||||||||^^^^\nIN1|1|BCOOS||BLUE CROSS OUT OF STATE|PO BOX 5747^^DENVER^CO^80217^USA||(877)833-5742|174172M2AS|BOYD GAMING|||20170101||||WILSON^TERRY^L^^^|01|19560509||||||||||||||||||BYM963M78509|||||||F\nZMR|1|H000059103\nZCD|1|1REG0M031A^4. Illness/injury due to work related accident/condition?^N\nZCD|2|1REG0M041A^1. Was illness/injury due to a non-work related accident?^NO\nZCD|3|1REG0M065A^Occurrence Code:^11\nZCD|4|1REG0M066A^Date:^20170611\nZCD|5|1REG0M234A^FC1:^08\nZCD|6|ETHNICITY^ETHNICITY^2\nZCD|7|ZSS.AMTREQ^AMT REQ^200.00\nZCD|8|ZSS.DEPREQ^DEPOSIT REQ?^N\nZCD|9|ZSS.ESTCHG^EST PT DUE^0.00\nZCD|10|ZSS.UNABLE^Comment if FULL amt requested NOT collected^NOT INF\nZIN|1|SP|BLUE CROSS|Y|20170611|PPI||Y|||||BCOOS\nZCS|ORLHO|4500 W TROPICANA AVE.^^LAS VEGAS^NV^89103|F|DECLINED|DECLINED|02270\n"
  //  "MSH|^~\\&|MT_COCQA1A|COCQA1A|DBM||201601190838||ADT^A02|MT_COCQA1A_ADT_QA1AGTADM.1.229576.567|D|2.5||KYA\nEVN|A02|201601190838|||1TSQBE8554^HAMMOCK^BRITTANY^^^^\nPID|1||J000423598|J500217|Jones^Jessica^Campbell^^|UNKNOWN|20031230|F|CAGE^JESSICA^CAMPBELL JONES^|U|456 MARVEL STREETFRANKLIN^TN^37064^USA^^WILLIAMSON||(615)555-6261|(615)555-6261|ENG|S|NON|J00021004053|302-30-2015\nPV1|1|I|J.DEVICU^J.DEVICU1^A|EL||J.DE2^J.DE2^229|DRFIRST^FIRST^DOCTOR^^^||DRBRI^DOCTOR^BRITTANY^^|IM||||ER||Y|ADMITTING^PHYSICIAN^TEST^ADMITTING^^|INO||08|||||||||||||||||||COCQA1A|OBSERVATION|ADM|||201601190811\nAL1|1|DA|1000031^Bee^Bee|SV|ANAPHYLAXIS|20160114\nAL1|2|DA|F006004630^sufentanil^sufentanil|MI|ANXIETY|20160114\nACC|20160119^|11\nGT1|1||Jones^Jessica^Campbell^^||456 MARVEL STREETFRANKLIN^TN^37064^USA^WILLIAMSON|(615)555-6261||20031230|F||SA|302-30-2015|||ALIAS|^^^||||FT\nGT1|2||^^^^||^^^^^^|||||||||||^^^\nIN1|1|AETNA||AETNA|10 WHITE STREET^INS ST2^ANYTOWN^TN^00111^USA||(615)825-5555|AETNA GROUP #|AETNA GROUP NAME|||||||Jones^Jessica^Campbell^^^|01|20031230||||||||||||||||||302302015|||||||F\nZCD|1|ETHNICITY^ETHNICITY^3\nZCD|2|Z.ADDLRACE^ADDITIONAL RACE^U\nZCD|3|ZSS.DEPREQ^DEPOSIT REQ?^N\nZCD|4|ZSS.UNABLE^Comment if FULL amt requested NOT collected^NR\nZCD|5|hca0000200^Reason-^2\nZCD|6|hca0000227^Able to perform TB Contagious Respiratory Infection Point of Entry Screen^N\nZIN|1|SP|AETNA INSURANCE|N||AET PRECERT CONTACT||N|||||AETNA\nZCS|ALIAS|456 MARVEL STREET^^FRANKLIN^TN^37064|FT|EMAIL@TEST.COM|EMAIL@TEST.COM|04446"
  //"MSH|^~\\&||COCHM|||201703310757||ADT^A31|MT_COCHM_ADT_TNAGTMRI.1.7325521|P|2.1\nEVN|A31|201703310757||E\nPID|1||Q002023752|Q95587|GUPTON^BRANDY^LEIGH^^^|ANGELA|19900517|F|GUPTON^BRANDY^^^^|W|2704 HWY 47 NORTH^^WHITE BLUFF^TN^37187^USA^^^DICKSO.TN||615-972-6793|615-446-8000|ENG|S|NON|Q95587|412-65-5356\nIN1|1|TC.AMERIC||TNCARE AMERICHOICE|PO BOX 5220^STE 200^KINGSTON^NY^12402-5220||800-690-1606|MT01|TNCARE AMERICHOICE|||20081001|20110516|||GUPTON^BRANDY^L^^^|01|||||||||||||||||||JD3794405\nIN1|2|TC.AMGRP||TNCARE AMERIGROUP|PO BOX 61010^TN CLAIMS^VIRGINIA BEACH^VA^23466-1010||800-454-3730|||||||||GUPTON^BRANDY^L^^^|01|||||||||||||||||||712927939\nIN1|3|TC.BC||TNCARE BLUECARE|1 CAMERON HILL CIRCLE^SUITE 0002^CHATTANOOGA^TN^37402-0002||800-276-1978|125000||||20150101||||GUPTON^BRANDY^^^^|01|||||||||||||||||||ZECM12714949\nIN1|4|TC.UHCCMPL||TNCARE UHC COMMUNITY PLAN|PO BOX 5220^^KINGSTON^NY^12402-5220||800-690-1606|MT05||||20110601||||GUPTON^BRANDY^L^^^|01|||||||||||||||||||JD3794405\nIN1|5|UNINSURED||UNINSURED DISCOUNT PLAN|552 METROPLEX DR^^NASHVILLE^TN^37211||615-886-5660|||||||||GUPTON^BRANDY^LEIGH^^^|01|||||||||||||||||||412655356\n"
  //"MSH|^~\\&||COCXG|||201701231800||RDE^O01|MT_COCXG_RDE_XGPHAORD.1.10910266|P|2.2\nPID|||J000466169|J429090|KERR^BURGRTT^ULANE^^^||19499517|||||||||||J00073669669\nPV1|I||J.PACUH^J.801^A||||LAZJE^Lazarus^Jeffrey^J MD"

  private val messageTypes = lookUpProp("hl7.messages.type") split COMMA
  private val hl7MsgMeta = messageTypes.map(mtyp => hl7(mtyp) -> getMsgTypeMeta(hl7(mtyp), lookUpProp(mtyp + ".kafka.source"))) toMap
  private val templatesMapping = loadTemplate(lookUpProp("hl7.template"))
  private val segmentsMapping = applySegmentsToAll(loadSegments(lookUpProp("hl7.segments")) ++ loadSegments(lookUpProp("hl7.adhoc-segments")), messageTypes)
  private val modelsForHl7 = hl7MsgMeta.map(msgType => msgType._1 -> segmentsForHl7Type(msgType._1, segmentsMapping(msgType._1.toString)))
  private val registeredSegmentsForHl7 = modelsForHl7.mapValues(_.models.keySet)
  private val hl7Parsers = hl7MsgMeta map (hl7 => hl7._1 -> new HL7Parser(hl7._1, templatesMapping))
  private val jsonAuditor = hl7MsgMeta map (msgType => msgType._1 -> (auditMsg(msgType._1.toString, jsonStage)(EMPTYSTR, _: MSGMeta)))
  private val segmentsAuditor = hl7MsgMeta map (msgType => msgType._1 -> (auditMsg(msgType._1.toString, segmentStage)(_: String, _: MSGMeta)))
  private val adhocAuditor = hl7MsgMeta map (msgType => msgType._1 -> (auditMsg(msgType._1.toString, adhocStage)(_: String, _: MSGMeta)))
  private val allSegmentsInHl7Auditor = hl7MsgMeta map (msgType => msgType._1 -> (auditMsg(msgType._1.toString, segmentsInHL7)(_: String, _: MSGMeta)))
  private val tlmAuditor = tlmAckMsg("test", applicationReceiving, HDFS, _: String)(_: MSGMeta)
  private val segmentsHandler = modelsForHl7 map (hl7 => hl7._1 -> new DataModelHandler(hl7._2, registeredSegmentsForHl7(hl7._1), segmentsAuditor(hl7._1),
    allSegmentsInHl7Auditor(hl7._1), adhocAuditor(hl7._1), tlmAckMsg(hl7._1.toString, applicationReceiving, HDFS, _: String)(_: MSGMeta)))
  var tlmAckIO: (String, String) => Unit = null
  modelsForHl7.filter(_._1.toString == "MDM")
  //.filter(_._2.models.filter(_._1.contains("ADHOC")))
  TLMAcknowledger("test", "test")(lookUpProp("mq.hosts"), lookUpProp("mq.manager"), lookUpProp("mq.channel"), lookUpProp("mq.destination.queues"))
  tlmAckIO = TLMAcknowledger.ackMessage(_: String, _: String)

  Try(hl7Parsers(msgType).transformHL7(msgs, reject) rec) match {
    case Success(map) =>
      map match {
        case Left(out) =>
          info("json: " + out._1)
          segmentsHandler(msgType).handleSegments(outio, templateerrorReject, audit, adhocDestination,Some(tlmAckIO),null)(out._2, msgs, out._3)
        case Right(t) =>
          error(t);
      }
    case Failure(t) =>
      error(t)
  }

  private def outio(k: String, v: String) = {
    // info("outio: " + k)
  }

  private def reject(k: AnyRef, v: String) = {
    info("reject: " + k)
  }
  private def templateerrorReject(k: AnyRef, v: String) = {
    info("reject: " + k+ " " + v)
  }
  private def audit(k: String, v: String) = {
    // info("audit: " + k)
  }

  private def adhocDestination(k: String, v: String, dest: String) = {
    info("adhocDestiation: " + k)
  }

}





