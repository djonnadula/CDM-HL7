use hl7_qa;

CREATE EXTERNAL TABLE hl7_acc_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
acc_accident_date_time String,
acc_accident_code String,
acc_accident_code_primary_id String,
acc_accident_code_text String,
acc_accident_code_name_of_coding_sys String,
acc_accident_code_alt_id String,
acc_accident_code_alt_text String,
acc_accident_code_name_of_alt_coding_sys String,
acc_accident_code_coding_sys_ver_id String,
acc_accident_code_alt_coding_sys_ver_id String,
acc_accident_code_original_text String,
acc_accident_code_second_alt_id String,
acc_accident_code_second_alt_text String,
acc_accident_code_name_of_second_alt_coding_sys String,
acc_accident_code_second_alt_coding_sys_ver_id String,
acc_accident_code_coding_sys_oid String,
acc_accident_code_value_set_oid String,
acc_accident_code_value_set_ver_id String,
acc_accident_code_alt_coding_sys_oid String,
acc_accident_code_alt_value_set_oid String,
acc_accident_code_alt_value_set_ver_id String,
acc_accident_code_second_alt_coding_sys_oid String,
acc_accident_code_second_alt_value_set_oid String,
acc_accident_code_second_alt_value_set_ver_id String,
acc_accident_location String,
acc_auto_accident_state String,
acc_accident_job_related_ind String,
acc_accident_death_ind String,
acc_entered_by String,
acc_accident_desc String,
acc_brought_in_by String,
acc_police_notified_ind String,
acc_accident_address String,
acc_degree_of_patient_liability String,
etl_firstinsert_datetime String
) 
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_acc_data AS SELECT * FROM hl7_acc_data WHERE segment_type='ACC';

CREATE EXTERNAL TABLE hl7_al1_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
al1_set_id String,
al1_allergen_type_code String,
al1_allergen_code String,
al1_allergen_code_primary_id String,
al1_allergen_code_text String,
al1_allergen_code_name_of_coding_sys String,
al1_allergen_code_alt_id String,
al1_allergen_code_alt_text String,
al1_allergen_code_name_of_alt_coding_sys String,
al1_allergen_code_coding_sys_ver_id String,
al1_allergen_code_alt_coding_sys_ver_id String,
al1_allergen_code_original_text String,
al1_allergen_code_second_alt_id String,
al1_allergen_code_second_alt_text String,
al1_allergen_code_name_of_second_alt_coding_sys String,
al1_allergen_code_second_alt_coding_sys_ver_id String,
al1_allergen_code_coding_sys_oid String,
al1_allergen_code_value_set_oid String,
al1_allergen_code_value_set_ver_id String,
al1_allergen_code_alt_coding_sys_oid String,
al1_allergen_code_alt_value_set_oid String,
al1_allergen_code_alt_value_set_ver_id String,
al1_allergen_code_second_alt_coding_sys_oid String,
al1_allergen_code_second_alt_value_set_oid String,
al1_allergen_code_second_alt_value_set_ver_id String,
al1_allergy_severity_code String,
al1_allergy_reaction_code String,
al1_identification_date String,
etl_firstinsert_datetime String
) 
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_al1_data AS SELECT * FROM hl7_al1_data WHERE segment_type='AL1';

CREATE EXTERNAL TABLE hl7_cti_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
cti_sponsor_study_id String,
cti_study_phase_id String,
cti_study_scheduled_time_point String,
etl_firstinsert_datetime String
) 
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_cti_data AS SELECT * FROM hl7_cti_data WHERE segment_type='CTI';

CREATE EXTERNAL TABLE hl7_dg1_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
dg1_set_id String,
dg1_diagnosis_coding_method String,
dg1_diagnosis_code String,
dg1_diagnosis_code_primary_id String,
dg1_diagnosis_code_text String,
dg1_diagnosis_code_name_of_coding_sys String,
dg1_diagnosis_code_alt_id String,
dg1_diagnosis_code_alt_text String,
dg1_diagnosis_code_name_of_alt_coding_sys String,
dg1_diagnosis_code_coding_sys_ver_id String,
dg1_diagnosis_code_alt_coding_sys_ver_id String,
dg1_diagnosis_code_original_text String,
dg1_diagnosis_code_second_alt_id String,
dg1_diagnosis_code_second_alt_text String,
dg1_diagnosis_code_name_of_second_alt_coding_sys String,
dg1_diagnosis_code_second_alt_coding_sys_ver_id String,
dg1_diagnosis_code_coding_sys_oid String,
dg1_diagnosis_code_value_set_oid String,
dg1_diagnosis_code_value_set_ver_id String,
dg1_diagnosis_code_alt_coding_sys_oid String,
dg1_diagnosis_code_alt_value_set_oid String,
dg1_diagnosis_code_alt_value_set_ver_id String,
dg1_diagnosis_code_second_alt_coding_sys_oid String,
dg1_diagnosis_code_second_alt_value_set_oid String,
dg1_diagnosis_code_second_alt_value_set_ver_id String,
dg1_diagnosis_desc String,
dg1_diagnosis_date_time String,
dg1_diagnosis_type String,
dg1_major_diagnostic_category String,
dg1_diagnostic_related_group String,
dg1_drg_approval_ind String,
dg1_drg_grouper_review_code String,
dg1_outlier_type String,
dg1_outlier_day String,
dg1_outlier_cost String,
dg1_grouper_version_type String,
dg1_diagnosis_priority String,
dg1_diagnosing_clinician String,
dg1_diagnosis_classification String,
dg1_confidential_ind String,
dg1_attestation_date_time String,
dg1_diagnosis_id String,
dg1_diagnosis_action_code String,
dg1_parent_diagnosis String,
dg1_drg_ccl_value_code String,
dg1_drg_grouping_usage String,
dg1_drg_diagnosis_determination_status String,
dg1_present_on_admission_ind String,
etl_firstinsert_datetime String
) 
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_dg1_data AS SELECT * FROM hl7_dg1_data WHERE segment_type='DG1';

CREATE EXTERNAL TABLE hl7_dsc_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
dsc_continuation_pointer String,
dsc_continuation_style String,
etl_firstinsert_datetime String
) 
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_dsc_data AS SELECT * FROM hl7_dsc_data WHERE segment_type='DSC';

CREATE EXTERNAL TABLE hl7_evn_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
evn_evnt_type String,
evn_recorded_date_time String,
evn_planned_evnt_date_time String,
evn_evnt_resn_code String,
evn_evnt_resn_code_primary_id String,
evn_evnt_resn_code_text String,
evn_evnt_resn_code_name_of_coding_sys String,
evn_evnt_resn_code_alt_id String,
evn_evnt_resn_code_alt_text String,
evn_evnt_resn_code_name_of_alt_coding_sys String,
evn_evnt_resn_code_coding_sys_ver_id String,
evn_evnt_resn_code_alt_coding_sys_ver_id String,
evn_evnt_resn_code_original_text String,
evn_evnt_resn_code_second_alt_id String,
evn_evnt_resn_code_second_alt_text String,
evn_evnt_resn_code_name_of_second_alt_coding_sys String,
evn_evnt_resn_code_second_alt_coding_sys_ver_id String,
evn_evnt_resn_code_coding_sys_oid String,
evn_evnt_resn_code_value_set_oid String,
evn_evnt_resn_code_value_set_ver_id String,
evn_evnt_resn_code_alt_coding_sys_oid String,
evn_evnt_resn_code_alt_value_set_oid String,
evn_evnt_resn_code_alt_value_set_ver_id String,
evn_evnt_resn_code_second_alt_coding_sys_oid String,
evn_evnt_resn_code_second_alt_value_set_oid String,
evn_evnt_resn_code_second_alt_value_set_ver_id String,
evn_oper_id String,
evn_oper_id_person_id String,
evn_oper_id_last_name String,
evn_oper_id_first_name String,
evn_oper_id_middle_name String,
evn_oper_id_suffix String,
evn_oper_id_person_prefix String,
evn_oper_id_degree String,
evn_oper_id_source_table String,
evn_oper_id_assgn_authr String,
evn_oper_id_name_type_code String,
evn_oper_id_identifier_check_digit String,
evn_oper_id_check_digit_scheme String,
evn_oper_id_identifier_type_code String,
evn_oper_id_assgn_facility String,
evn_oper_id_name_rep_code String,
evn_oper_id_context String,
evn_oper_id_validity_range String,
evn_oper_id_assembly_order String,
evn_oper_id_eff_from_date_time String,
evn_oper_id_eff_to_date_time String,
evn_oper_id_prof_suffix String,
evn_oper_id_assgn_jurisdiction String,
evn_oper_id_assgn_agency_dept String,
evn_oper_id_security_check String,
evn_oper_id_security_check_scheme String,
evn_evnt_occurred String,
evn_evnt_facility String,
etl_firstinsert_datetime String
) 
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_evn_data AS SELECT * FROM hl7_evn_data WHERE segment_type='EVN';

CREATE EXTERNAL TABLE hl7_gt1_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
gt1_set_id String,
gt1_guarantor_num String,
gt1_guarantor_name String,
gt1_guarantor_name_last_name String,
gt1_guarantor_name_first_name String,
gt1_guarantor_name_middle_name String,
gt1_guarantor_name_suffix String,
gt1_guarantor_name_person_prefix String,
gt1_guarantor_name_degree String,
gt1_guarantor_name_type_code String,
gt1_guarantor_name_rep_code String,
gt1_guarantor_name_context String,
gt1_guarantor_name_validity_range String,
gt1_guarantor_name_assembly_order String,
gt1_guarantor_name_eff_from_date_time String,
gt1_guarantor_name_eff_to_date_time String,
gt1_guarantor_name_prof_suffix String,
gt1_guarantor_name_called_by String,
gt1_guarantor_spouse_name String,
gt1_guarantor_spouse_name_last_name String,
gt1_guarantor_spouse_name_first_name String,
gt1_guarantor_spouse_name_middle_name String,
gt1_guarantor_spouse_name_suffix String,
gt1_guarantor_spouse_name_person_prefix String,
gt1_guarantor_spouse_name_degree String,
gt1_guarantor_spouse_name_type_code String,
gt1_guarantor_spouse_name_rep_code String,
gt1_guarantor_spouse_name_context String,
gt1_guarantor_spouse_name_validity_range String,
gt1_guarantor_spouse_name_assembly_order String,
gt1_guarantor_spouse_name_eff_from_date_time String,
gt1_guarantor_spouse_name_eff_to_date_time String,
gt1_guarantor_spouse_name_prof_suffix String,
gt1_guarantor_spouse_name_called_by String,
gt1_guarantor_address String,
gt1_guarantor_address_street_address1 String,
gt1_guarantor_address_street_address2 String,
gt1_guarantor_address_city String,
gt1_guarantor_address_state_province String,
gt1_guarantor_address_zip_postal_code String,
gt1_guarantor_address_country String,
gt1_guarantor_address_address_type String,
gt1_guarantor_address_other_geo_designation String,
gt1_guarantor_address_county_parish_code String,
gt1_guarantor_address_census_tract String,
gt1_guarantor_address_rep_code String,
gt1_guarantor_address_validity_range String,
gt1_guarantor_address_eff_from_date_time String,
gt1_guarantor_address_eff_to_date_time String,
gt1_guarantor_address_expr_reason String,
gt1_guarantor_address_temporary_indicator String,
gt1_guarantor_address_bad_address_indicator String,
gt1_guarantor_address_address_usage String,
gt1_guarantor_address_addressee String,
gt1_guarantor_address_address_comment String,
gt1_guarantor_address_pref_order String,
gt1_guarantor_address_protection_code String,
gt1_guarantor_address_address_id String,
gt1_guarantor_home_phone_num String,
gt1_guarantor_home_phone_num_formatted_num String,
gt1_guarantor_home_phone_num_use_code String,
gt1_guarantor_home_phone_num_equipment_type String,
gt1_guarantor_home_phone_num_comm_address String,
gt1_guarantor_home_phone_num_country_code String,
gt1_guarantor_home_phone_num_area_city_code String,
gt1_guarantor_home_phone_num_local_number String,
gt1_guarantor_home_phone_num_extension String,
gt1_guarantor_home_phone_num_any_text String,
gt1_guarantor_home_phone_num_extension_prefix String,
gt1_guarantor_home_phone_num_speed_dial_code String,
gt1_guarantor_home_phone_num_unformatted_num String,
gt1_guarantor_home_phone_num_eff_from_date String,
gt1_guarantor_home_phone_num_eff_to_date String,
gt1_guarantor_home_phone_num_expr_reason String,
gt1_guarantor_home_phone_num_protection_code String,
gt1_guarantor_home_phone_num_shared_id String,
gt1_guarantor_home_phone_num_pref_order String,
gt1_guarantor_business_phone_num String,
gt1_guarantor_business_phone_num_formatted_num String,
gt1_guarantor_business_phone_num_use_code String,
gt1_guarantor_business_phone_num_equipment_type String,
gt1_guarantor_business_phone_num_comm_address String,
gt1_guarantor_business_phone_num_country_code String,
gt1_guarantor_business_phone_num_area_city_code String,
gt1_guarantor_business_phone_num_local_number String,
gt1_guarantor_business_phone_num_extension String,
gt1_guarantor_business_phone_num_any_text String,
gt1_guarantor_business_phone_num_extension_prefix String,
gt1_guarantor_business_phone_num_speed_dial_code String,
gt1_guarantor_business_phone_num_unformatted_num String,
gt1_guarantor_business_phone_num_eff_from_date String,
gt1_guarantor_business_phone_num_eff_to_date String,
gt1_guarantor_business_phone_num_expr_reason String,
gt1_guarantor_business_phone_num_protection_code String,
gt1_guarantor_business_phone_num_shared_id String,
gt1_guarantor_business_phone_num_pref_order String,
gt1_guarantor_birth_date_time String,
gt1_guarantor_sex String,
gt1_guarantor_type String,
gt1_guarantor_relationship String,
gt1_guarantor_social_security_num String,
gt1_guarantor_begin_date String,
gt1_guarantor_end_date String,
gt1_guarantor_priority String,
gt1_guarantor_employer_name String,
gt1_guarantor_employer_name_last_name String,
gt1_guarantor_employer_name_first_name String,
gt1_guarantor_employer_name_middle_name String,
gt1_guarantor_employer_name_suffix String,
gt1_guarantor_employer_name_person_prefix String,
gt1_guarantor_employer_name_degree String,
gt1_guarantor_employer_name_type_code String,
gt1_guarantor_employer_name_rep_code String,
gt1_guarantor_employer_name_context String,
gt1_guarantor_employer_name_validity_range String,
gt1_guarantor_employer_name_assembly_order String,
gt1_guarantor_employer_name_eff_from_date_time String,
gt1_guarantor_employer_name_eff_to_date_time String,
gt1_guarantor_employer_name_prof_suffix String,
gt1_guarantor_employer_name_called_by String,
gt1_guarantor_employer_address String,
gt1_guarantor_employer_address_street_address1 String,
gt1_guarantor_employer_address_street_address2 String,
gt1_guarantor_employer_address_city String,
gt1_guarantor_employer_address_state_province String,
gt1_guarantor_employer_address_zip_postal_code String,
gt1_guarantor_employer_address_country String,
gt1_guarantor_employer_address_address_type String,
gt1_guarantor_employer_address_other_geo_designation String,
gt1_guarantor_employer_address_county_parish_code String,
gt1_guarantor_employer_address_census_tract String,
gt1_guarantor_employer_address_rep_code String,
gt1_guarantor_employer_address_validity_range String,
gt1_guarantor_employer_address_eff_from_date_time String,
gt1_guarantor_employer_address_eff_to_date_time String,
gt1_guarantor_employer_address_expr_reason String,
gt1_guarantor_employer_address_temporary_indicator String,
gt1_guarantor_employer_address_bad_address_indicator String,
gt1_guarantor_employer_address_address_usage String,
gt1_guarantor_employer_address_addressee String,
gt1_guarantor_employer_address_address_comment String,
gt1_guarantor_employer_address_pref_order String,
gt1_guarantor_employer_address_protection_code String,
gt1_guarantor_employer_address_address_id String,
gt1_guarantor_employer_phone_num String,
gt1_guarantor_employer_phone_num_formatted_num String,
gt1_guarantor_employer_phone_num_use_code String,
gt1_guarantor_employer_phone_num_equipment_type String,
gt1_guarantor_employer_phone_num_comm_address String,
gt1_guarantor_employer_phone_num_country_code String,
gt1_guarantor_employer_phone_num_area_city_code String,
gt1_guarantor_employer_phone_num_local_number String,
gt1_guarantor_employer_phone_num_extension String,
gt1_guarantor_employer_phone_num_any_text String,
gt1_guarantor_employer_phone_num_extension_prefix String,
gt1_guarantor_employer_phone_num_speed_dial_code String,
gt1_guarantor_employer_phone_num_unformatted_num String,
gt1_guarantor_employer_phone_num_eff_from_date String,
gt1_guarantor_employer_phone_num_eff_to_date String,
gt1_guarantor_employer_phone_num_expr_reason String,
gt1_guarantor_employer_phone_num_protection_code String,
gt1_guarantor_employer_phone_num_shared_id String,
gt1_guarantor_employer_phone_num_pref_order String,
gt1_guarantor_employee_id_num String,
gt1_guarantor_employment_status String,
gt1_guarantor_organization_name String,
gt1_guarantor_billing_hold_flag String,
gt1_guarantor_credit_rating_code String,
gt1_guarantor_death_date_time String,
gt1_guarantor_death_flag String,
gt1_guarantor_charge_adjustment_code String,
gt1_guarantor_household_annual_income String,
gt1_guarantor_household_size String,
gt1_guarantor_employer_id_num String,
gt1_guarantor_marital_status_code String,
gt1_guarantor_effective_hire_date String,
gt1_employment_stop_date String,
gt1_living_dependency String,
gt1_ambulatory_status String,
gt1_citizenship String,
gt1_primary_language String,
gt1_living_arrangement String,
gt1_publicity_code String,
gt1_protection_ind String,
gt1_student_ind String,
gt1_religion String,
gt1_mother_maiden_name String,
gt1_nationality String,
gt1_ethnic_group String,
gt1_contact_person_name String,
gt1_contact_person_telephone_num String,
gt1_contact_reason String,
gt1_contact_relationship String,
gt1_job_title String,
gt1_job_code_classification String,
gt1_guarantor_employer_organization_name String,
gt1_handicap String,
gt1_job_status String,
gt1_guarantor_financial_classification String,
gt1_guarantor_race String,
gt1_guarantor_race_primary_id String,
gt1_guarantor_race_text String,
gt1_guarantor_race_name_of_coding_sys String,
gt1_guarantor_race_alt_id String,
gt1_guarantor_race_alt_text String,
gt1_guarantor_race_name_of_alt_coding_sys String,
gt1_guarantor_race_coding_sys_ver_id String,
gt1_guarantor_race_alt_coding_sys_ver_id String,
gt1_guarantor_race_original_text String,
gt1_guarantor_race_second_alt_id String,
gt1_guarantor_race_second_alt_text String,
gt1_guarantor_race_name_of_second_alt_coding_sys String,
gt1_guarantor_race_second_alt_coding_sys_ver_id String,
gt1_guarantor_race_coding_sys_oid String,
gt1_guarantor_race_value_set_oid String,
gt1_guarantor_race_value_set_ver_id String,
gt1_guarantor_race_alt_coding_sys_oid String,
gt1_guarantor_race_alt_value_set_oid String,
gt1_guarantor_race_alt_value_set_ver_id String,
gt1_guarantor_race_second_alt_coding_sys_oid String,
gt1_guarantor_race_second_alt_value_set_oid String,
gt1_guarantor_race_second_alt_value_set_ver_id String,
gt1_guarantor_birth_place String,
gt1_vip_ind String,
etl_firstinsert_datetime String
) 
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_gt1_data AS SELECT * FROM hl7_gt1_data WHERE segment_type='GT1';

CREATE EXTERNAL TABLE hl7_in1_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
in1_set_id String,
in1_insurance_plan_id String,
in1_insurance_plan_id_primary_id String,
in1_insurance_plan_id_text String,
in1_insurance_plan_id_name_of_coding_sys String,
in1_insurance_plan_id_alt_id String,
in1_insurance_plan_id_alt_text String,
in1_insurance_plan_id_name_of_alt_coding_sys String,
in1_insurance_plan_id_coding_sys_ver_id String,
in1_insurance_plan_id_alt_coding_sys_ver_id String,
in1_insurance_plan_id_original_text String,
in1_insurance_plan_id_second_alt_id String,
in1_insurance_plan_id_second_alt_text String,
in1_insurance_plan_id_name_of_second_alt_coding_sys String,
in1_insurance_plan_id_second_alt_coding_sys_ver_id String,
in1_insurance_plan_id_coding_sys_oid String,
in1_insurance_plan_id_value_set_oid String,
in1_insurance_plan_id_value_set_ver_id String,
in1_insurance_plan_id_alt_coding_sys_oid String,
in1_insurance_plan_id_alt_value_set_oid String,
in1_insurance_plan_id_alt_value_set_ver_id String,
in1_insurance_plan_id_second_alt_coding_sys_oid String,
in1_insurance_plan_id_second_alt_value_set_oid String,
in1_insurance_plan_id_second_alt_value_set_ver_id String,
in1_insurance_company_id String,
in1_insurance_company_name String,
in1_insurance_company_address String,
in1_insurance_company_address_street_address1 String,
in1_insurance_company_address_street_address2 String,
in1_insurance_company_address_city String,
in1_insurance_company_address_state_province String,
in1_insurance_company_address_zip_postal_code String,
in1_insurance_company_address_country String,
in1_insurance_company_address_address_type String,
in1_insurance_company_address_other_geo_designation String,
in1_insurance_company_address_county_parish_code String,
in1_insurance_company_address_census_tract String,
in1_insurance_company_address_rep_code String,
in1_insurance_company_address_validity_range String,
in1_insurance_company_address_eff_from_date_time String,
in1_insurance_company_address_eff_to_date_time String,
in1_insurance_company_address_expr_reason String,
in1_insurance_company_address_temporary_indicator String,
in1_insurance_company_address_bad_address_indicator String,
in1_insurance_company_address_address_usage String,
in1_insurance_company_address_addressee String,
in1_insurance_company_address_address_comment String,
in1_insurance_company_address_pref_order String,
in1_insurance_company_address_protection_code String,
in1_insurance_company_address_address_id String,
in1_insurance_company_contact_person String,
in1_insurance_company_contact_person_last_name String,
in1_insurance_company_contact_person_first_name String,
in1_insurance_company_contact_person_middle_name String,
in1_insurance_company_contact_person_suffix String,
in1_insurance_company_contact_person_person_prefix String,
in1_insurance_company_contact_person_degree String,
in1_insurance_company_contact_person_type_code String,
in1_insurance_company_contact_person_rep_code String,
in1_insurance_company_contact_person_context String,
in1_insurance_company_contact_person_validity_range String,
in1_insurance_company_contact_person_assembly_order String,
in1_insurance_company_contact_person_eff_from_date_time String,
in1_insurance_company_contact_person_eff_to_date_time String,
in1_insurance_company_contact_person_prof_suffix String,
in1_insurance_company_contact_person_called_by String,
in1_insurance_company_phone_num String,
in1_insurance_company_phone_num_formatted_num String,
in1_insurance_company_phone_num_use_code String,
in1_insurance_company_phone_num_equipment_type String,
in1_insurance_company_phone_num_comm_address String,
in1_insurance_company_phone_num_country_code String,
in1_insurance_company_phone_num_area_city_code String,
in1_insurance_company_phone_num_local_number String,
in1_insurance_company_phone_num_extension String,
in1_insurance_company_phone_num_any_text String,
in1_insurance_company_phone_num_extension_prefix String,
in1_insurance_company_phone_num_speed_dial_code String,
in1_insurance_company_phone_num_unformatted_num String,
in1_insurance_company_phone_num_eff_from_date String,
in1_insurance_company_phone_num_eff_to_date String,
in1_insurance_company_phone_num_expr_reason String,
in1_insurance_company_phone_num_protection_code String,
in1_insurance_company_phone_num_shared_id String,
in1_insurance_company_phone_num_pref_order String,
in1_group_num String,
in1_group_name String,
in1_insured_group_employee_id String,
in1_insured_group_employee_name String,
in1_plan_eff_from_date String,
in1_plan_eff_to_date String,
in1_authr_information String,
in1_authr_information_authorization_num String,
in1_authr_information_date String,
in1_authr_information_source String,
in1_plan_type String,
in1_insured_name String,
in1_insured_name_last_name String,
in1_insured_name_first_name String,
in1_insured_name_middle_name String,
in1_insured_name_suffix String,
in1_insured_name_person_prefix String,
in1_insured_name_degree String,
in1_insured_name_type_code String,
in1_insured_name_rep_code String,
in1_insured_name_context String,
in1_insured_name_validity_range String,
in1_insured_name_assembly_order String,
in1_insured_name_eff_from_date_time String,
in1_insured_name_eff_to_date_time String,
in1_insured_name_prof_suffix String,
in1_insured_name_called_by String,
in1_insured_relationship_to_patient String,
in1_insured_birth_date String,
in1_insured_address String,
in1_insured_address_street_address1 String,
in1_insured_address_street_address2 String,
in1_insured_address_city String,
in1_insured_address_state_province String,
in1_insured_address_zip_postal_code String,
in1_insured_address_country String,
in1_insured_address_address_type String,
in1_insured_address_other_geo_designation String,
in1_insured_address_county_parish_code String,
in1_insured_address_census_tract String,
in1_insured_address_rep_code String,
in1_insured_address_validity_range String,
in1_insured_address_eff_from_date_time String,
in1_insured_address_eff_to_date_time String,
in1_insured_address_expr_reason String,
in1_insured_address_temporary_indicator String,
in1_insured_address_bad_indicator String,
in1_insured_address_address_usage String,
in1_insured_address_addressee String,
in1_insured_address_address_comment String,
in1_insured_address_pref_order String,
in1_insured_address_protection_code String,
in1_insured_address_address_id String,
in1_assignment_of_benefits String,
in1_coordination_of_benefits String,
in1_coordination_of_benefits_priority String,
in1_notice_of_admission_flag String,
in1_notice_of_admission_date String,
in1_report_of_eligibility_flag String,
in1_report_of_eligibility_date String,
in1_release_information_code String,
in1_pre_admission_certification String,
in1_verification_date_time String,
in1_verification_by String,
in1_verification_by_person_id String,
in1_verification_by_last_name String,
in1_verification_by_first_name String,
in1_verification_by_middle_name String,
in1_verification_by_suffix String,
in1_verification_by_person_prefix String,
in1_verification_by_degree String,
in1_verification_by_source_table String,
in1_verification_by_assgn_authr String,
in1_verification_by_name_type_code String,
in1_verification_by_identifier_check_digit String,
in1_verification_by_check_digit_scheme String,
in1_verification_by_identifier_type_code String,
in1_verification_by_assgn_facility String,
in1_verification_by_name_rep_code String,
in1_verification_by_context String,
in1_verification_by_validity_range String,
in1_verification_by_assembly_order String,
in1_verification_by_eff_from_date_time String,
in1_verification_by_eff_to_date_time String,
in1_verification_by_prof_suffix String,
in1_verification_by_assgn_jurisdiction String,
in1_verification_by_assgn_agency_dept String,
in1_verification_by_security_check String,
in1_verification_by_security_check_scheme String,
in1_type_of_agreement_code String,
in1_billing_status String,
in1_lifetime_reserve_day String,
in1_delay_before_lifetime_reserve_day String,
in1_company_plan_code String,
in1_policy_num String,
in1_policy_deductible String,
in1_policy_limit_amt String,
in1_policy_limit_day String,
in1_semi_private_room_rate String,
in1_private_room_rate String,
in1_insured_employment_status String,
in1_insured_employment_status_primary_id String,
in1_insured_employment_status_text String,
in1_insured_employment_status_name_of_coding_sys String,
in1_insured_employment_status_alt_id String,
in1_insured_employment_status_alt_text String,
in1_insured_employment_status_name_of_alt_coding_sys String,
in1_insured_employment_status_coding_sys_ver_id String,
in1_insured_employment_status_alt_coding_sys_ver_id String,
in1_insured_employment_status_original_text String,
in1_insured_employment_status_second_alt_id String,
in1_insured_employment_status_second_alt_text String,
in1_insured_employment_status_name_of_second_alt_coding_sys String,
in1_insured_employment_status_second_alt_coding_sys_ver_id String,
in1_insured_employment_status_coding_sys_oid String,
in1_insured_employment_status_value_set_oid String,
in1_insured_employment_status_value_set_ver_id String,
in1_insured_employment_status_alt_coding_sys_oid String,
in1_insured_employment_status_alt_value_set_oid String,
in1_insured_employment_status_alt_value_set_ver_id String,
in1_insured_employment_status_second_alt_coding_sys_oid String,
in1_insured_employment_status_second_alt_value_set_oid String,
in1_insured_employment_status_second_alt_value_set_ver_id String,
in1_insured_sex String,
in1_insured_employer_address String,
in1_insured_employer_address_street_address1 String,
in1_insured_employer_address_street_address2 String,
in1_insured_employer_address_city String,
in1_insured_employer_address_state_province String,
in1_insured_employer_address_zip_postal_code String,
in1_insured_employer_address_country String,
in1_insured_employer_address_address_type String,
in1_insured_employer_address_other_geo_designation String,
in1_insured_employer_address_county_parish_code String,
in1_insured_employer_address_census_tract String,
in1_insured_employer_address_rep_code String,
in1_insured_employer_address_validity_range String,
in1_insured_employer_address_eff_from_date_time String,
in1_insured_employer_address_eff_to_date_time String,
in1_insured_employer_address_expr_reason String,
in1_insured_employer_address_temporary_indicator String,
in1_insured_employer_address_bad_address_indicator String,
in1_insured_employer_address_address_usage String,
in1_insured_employer_address_addressee String,
in1_insured_employer_address_address_comment String,
in1_insured_employer_address_pref_order String,
in1_insured_employer_address_protection_code String,
in1_insured_employer_address_address_id String,
in1_verification_status String,
in1_prior_insurance_plan_id String,
in1_coverage_type String,
in1_handicap String,
in1_insured_id_num String,
in1_signature_code String,
in1_signature_code_date String,
in1_insured_birth_place String,
in1_vip_ind String,
in1_external_health_plan_id String,
etl_firstinsert_datetime String
) 
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_in1_data AS SELECT * FROM hl7_in1_data WHERE segment_type='IN1';

CREATE EXTERNAL TABLE hl7_mrg_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
mrg_prior_internal_pat_id String,
mrg_prior_internal_pat_id_identifier_num String,
mrg_prior_internal_pat_id_identifier_check_digit String,
mrg_prior_internal_pat_id_check_digit_scheme String,
mrg_prior_internal_pat_id_assgn_authr String,
mrg_prior_internal_pat_id_assgn_authr_namespace_id String,
mrg_prior_internal_pat_id_assgn_authr_universal_id String,
mrg_prior_internal_pat_id_assgn_authr_universal_id_type String,
mrg_prior_internal_pat_id_identifier_type_code String,
mrg_prior_internal_pat_id_assgn_facility String,
mrg_prior_internal_pat_id_assgn_facility_namespace_id String,
mrg_prior_internal_pat_id_assgn_facility_universal_id String,
mrg_prior_internal_pat_id_assgn_facility_universal_id_type String,
mrg_prior_internal_pat_id_eff_from_date String,
mrg_prior_internal_pat_id_eff_to_date String,
mrg_prior_internal_pat_id_assgn_jurisdiction String,
mrg_prior_internal_pat_id_assgn_agency_dept String,
mrg_prior_internal_pat_id_security_check String,
mrg_prior_internal_pat_id_security_check_scheme String,
mrg_prior_alt_pat_id String,
mrg_prior_pat_account_num String,
mrg_prior_pat_id String,
mrg_prior_pat_id_identifier_num String,
mrg_prior_pat_id_identifier_check_digit String,
mrg_prior_pat_id_check_digit_scheme String,
mrg_prior_pat_id_assgn_authr String,
mrg_prior_pat_id_assgn_authr_namespace_id String,
mrg_prior_pat_id_assgn_authr_universal_id String,
mrg_prior_pat_id_assgn_authr_universal_id_type String,
mrg_prior_pat_id_identifier_type_code String,
mrg_prior_pat_id_assgn_facility String,
mrg_prior_pat_id_assgn_facility_namespace_id String,
mrg_prior_pat_id_assgn_facility_universal_id String,
mrg_prior_pat_id_assgn_facility_universal_id_type String,
mrg_prior_pat_id_eff_from_date String,
mrg_prior_pat_id_eff_to_date String,
mrg_prior_pat_id_assgn_jurisdiction String,
mrg_prior_pat_id_assgn_agency_dept String,
mrg_prior_pat_id_security_check String,
mrg_prior_pat_id_security_check_scheme String,
mrg_prior_visit_num String,
mrg_prior_alt_visit_id String,
mrg_prior_pat_name String,
etl_firstinsert_datetime String
) 
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_mrg_data AS SELECT * FROM hl7_mrg_data WHERE segment_type='MRG';

CREATE EXTERNAL TABLE hl7_msh_data(
segment_type STRING,
msh_sending_facility STRING,
msh_msg_control_id STRING,
pid_medical_record_num STRING,
pid_medical_record_urn STRING,
pid_pat_account_num STRING,
msh_field_separator STRING,
msh_encoding_character STRING,
msh_sending_appl STRING,
msh_sending_appl_namespace_id STRING,
msh_sending_appl_universal_id STRING,
msh_sending_appl_universal_id_type STRING,
msh_sending_facility_namespace_id STRING,
msh_sending_facility_universal_id STRING,
msh_sending_facility_universal_id_type STRING,
msh_receiving_appl STRING,
msh_receiving_appl_namespace_id STRING,
msh_receiving_appl_universal_id STRING,
msh_receiving_appl_universal_id_type STRING,
msh_receiving_facility STRING,
msh_receiving_facility_namespace_id STRING,
msh_receiving_facility_universal_id STRING,
msh_receiving_facility_universal_id_type STRING,
msh_msg_create_date_time STRING,
msh_msg_create_date_time_1 STRING,
msh_msg_create_precision STRING,
msh_security STRING,
msh_msg_type STRING,
msh_msg_type_message_code STRING,
msh_msg_type_trigger_event STRING,
msh_msg_type_message_structure STRING,
msh_processing_id STRING,
msh_processing_id_processing_id STRING,
msh_processing_id_processing_mode STRING,
msh_version_id STRING,
msh_version_id_version_id STRING,
msh_version_id_intl_code STRING,
msh_version_id_intl_ver_id STRING,
msh_sequence_num STRING,
msh_continuation_pointer STRING,
msh_accept_acknowledgment_type STRING,
msh_appl_acknowledgment_type STRING,
msh_country_code STRING,
msh_character_set STRING,
msh_principal_language_of_msg STRING,
msh_alt_character_set_handling_scheme STRING,
msh_msg_profile_id STRING,
msh_msg_profile_id_entity_id STRING,
msh_msg_profile_id_namespace_id STRING,
msh_msg_profile_id_universal_id STRING,
msh_msg_profile_id_universal_id_type STRING,
msh_sending_responsible_organization STRING,
msh_receiving_responsible_organization STRING,
msh_sending_network_address STRING,
msh_receiving_network_address STRING,
etl_firstinsert_datetime STRING
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION 'hdfs://nameservice1/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_msh_data AS SELECT * FROM hl7_msh_data WHERE segment_type='MSH';

CREATE EXTERNAL TABLE hl7_nk1_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
nk1_set_id String,
nk1_name String,
nk1_name_last_name String,
nk1_name_first_name String,
nk1_name_middle_name String,
nk1_name_suffix String,
nk1_name_person_prefix String,
nk1_name_degree String,
nk1_name_type_code String,
nk1_name_rep_code String,
nk1_name_context String,
nk1_name_validity_range String,
nk1_name_assembly_order String,
nk1_name_eff_from_date_time String,
nk1_name_eff_to_date_time String,
nk1_name_prof_suffix String,
nk1_name_called_by String,
nk1_relationship String,
nk1_relationship_primary_id String,
nk1_relationship_text String,
nk1_relationship_name_of_coding_sys String,
nk1_relationship_alt_id String,
nk1_relationship_alt_text String,
nk1_relationship_name_of_alt_coding_sys String,
nk1_relationship_coding_sys_ver_id String,
nk1_relationship_alt_coding_sys_ver_id String,
nk1_relationship_original_text String,
nk1_relationship_second_alt_id String,
nk1_relationship_second_alt_text String,
nk1_relationship_name_of_second_alt_coding_sys String,
nk1_relationship_second_alt_coding_sys_ver_id String,
nk1_relationship_coding_sys_oid String,
nk1_relationship_value_set_oid String,
nk1_relationship_value_set_ver_id String,
nk1_relationship_alt_coding_sys_oid String,
nk1_relationship_alt_value_set_oid String,
nk1_relationship_alt_value_set_ver_id String,
nk1_relationship_second_alt_coding_sys_oid String,
nk1_relationship_second_alt_value_set_oid String,
nk1_relationship_second_alt_value_set_ver_id String,
nk1_address String,
nk1_address_street_address1 String,
nk1_address_street_address2 String,
nk1_address_city String,
nk1_address_state_province String,
nk1_address_zip_postal_code String,
nk1_address_country String,
nk1_address_address_type String,
nk1_address_other_geo_designation String,
nk1_address_county_parish_code String,
nk1_address_census_tract String,
nk1_address_rep_code String,
nk1_address_validity_range String,
nk1_address_eff_from_date_time String,
nk1_address_eff_to_date_time String,
nk1_address_expr_reason String,
nk1_address_temporary_indicator String,
nk1_address_bad_address_indicator String,
nk1_address_address_usage String,
nk1_address_addressee String,
nk1_address_address_comment String,
nk1_address_pref_order String,
nk1_address_protection_code String,
nk1_address_address_id String,
nk1_phone_num String,
nk1_phone_num_formatted_num String,
nk1_phone_num_use_code String,
nk1_phone_num_equipment_type String,
nk1_phone_num_comm_address String,
nk1_phone_num_country_code String,
nk1_phone_num_area_city_code String,
nk1_phone_num_local_number String,
nk1_phone_num_extension String,
nk1_phone_num_any_text String,
nk1_phone_num_extension_prefix String,
nk1_phone_num_speed_dial_code String,
nk1_phone_num_unformatted_num String,
nk1_phone_num_eff_from_date String,
nk1_phone_num_eff_to_date String,
nk1_phone_num_expr_reason String,
nk1_phone_num_protection_code String,
nk1_phone_num_shared_id String,
nk1_phone_num_pref_order String,
nk1_business_phone_num String,
nk1_business_phone_num_formatted_num String,
nk1_business_phone_num_use_code String,
nk1_business_phone_num_equipment_type String,
nk1_business_phone_num_comm_address String,
nk1_business_phone_num_country_code String,
nk1_business_phone_num_area_city_code String,
nk1_business_phone_num_local_number String,
nk1_business_phone_num_extension String,
nk1_business_phone_num_any_text String,
nk1_business_phone_num_extension_prefix String,
nk1_business_phone_num_speed_dial_code String,
nk1_business_phone_num_unformatted_num String,
nk1_business_phone_num_eff_from_date String,
nk1_business_phone_num_eff_to_date String,
nk1_business_phone_num_expr_reason String,
nk1_business_phone_num_protection_code String,
nk1_business_phone_num_shared_id String,
nk1_business_phone_num_pref_order String,
nk1_contact_role String,
nk1_start_date String,
nk1_end_date String,
nk1_asoc_party_job_title String,
nk1_asoc_party_job_code String,
nk1_asoc_party_employee_num String,
nk1_organization_name String,
nk1_marital_status String,
nk1_sex String,
nk1_birth_date_time String,
nk1_living_dependency String,
nk1_ambulatory_status String,
nk1_citizenship String,
nk1_primary_language String,
nk1_living_arrangement String,
nk1_publicity_code String,
nk1_protection_ind String,
nk1_student_ind String,
nk1_religion String,
nk1_mother_maiden_name String,
nk1_mother_maiden_name_last_name String,
nk1_mother_maiden_name_first_name String,
nk1_mother_maiden_name_middle_name String,
nk1_mother_maiden_name_suffix String,
nk1_mother_maiden_name_person_prefix String,
nk1_mother_maiden_name_degree String,
nk1_mother_maiden_name_type_code String,
nk1_mother_maiden_name_rep_code String,
nk1_mother_maiden_name_context String,
nk1_mother_maiden_name_validity_range String,
nk1_mother_maiden_name_assembly_order String,
nk1_mother_maiden_name_eff_from_date_time String,
nk1_mother_maiden_name_eff_to_date_time String,
nk1_mother_maiden_name_prof_suffix String,
nk1_mother_maiden_name_called_by String,
nk1_nationality String,
nk1_ethnic_group String,
nk1_contact_reason String,
nk1_contact_person_name String,
nk1_contact_person_name_last_name String,
nk1_contact_person_name_first_name String,
nk1_contact_person_name_middle_name String,
nk1_contact_person_name_suffix String,
nk1_contact_person_name_person_prefix String,
nk1_contact_person_name_degree String,
nk1_contact_person_name_type_code String,
nk1_contact_person_name_rep_code String,
nk1_contact_person_name_context String,
nk1_contact_person_name_validity_range String,
nk1_contact_person_name_assembly_order String,
nk1_contact_person_name_eff_from_date_time String,
nk1_contact_person_name_eff_to_date_time String,
nk1_contact_person_name_prof_suffix String,
nk1_contact_person_name_called_by String,
nk1_contact_person_phone_num String,
nk1_contact_person_phone_num_formatted_num String,
nk1_contact_person_phone_num_use_code String,
nk1_contact_person_phone_num_equipment_type String,
nk1_contact_person_phone_num_comm_address String,
nk1_contact_person_phone_num_country_code String,
nk1_contact_person_phone_num_area_city_code String,
nk1_contact_person_phone_num_local_number String,
nk1_contact_person_phone_num_extension String,
nk1_contact_person_phone_num_any_text String,
nk1_contact_person_phone_num_extension_prefix String,
nk1_contact_person_phone_num_speed_dial_code String,
nk1_contact_person_phone_num_unformatted_num String,
nk1_contact_person_phone_num_eff_from_date String,
nk1_contact_person_phone_num_eff_to_date String,
nk1_contact_person_phone_num_expr_reason String,
nk1_contact_person_phone_num_protection_code String,
nk1_contact_person_phone_num_shared_id String,
nk1_contact_person_phone_num_pref_order String,
nk1_contact_person_address String,
nk1_contact_person_address_street_address1 String,
nk1_contact_person_address_street_address2 String,
nk1_contact_person_address_city String,
nk1_contact_person_address_state_province String,
nk1_contact_person_address_zip_postal_code String,
nk1_contact_person_address_country String,
nk1_contact_person_address_address_type String,
nk1_contact_person_address_other_geo_designation String,
nk1_contact_person_address_county_parish_code String,
nk1_contact_person_address_census_tract String,
nk1_contact_person_address_rep_code String,
nk1_contact_person_address_validity_range String,
nk1_contact_person_address_eff_from_date_time String,
nk1_contact_person_address_eff_to_date_time String,
nk1_contact_person_address_expr_reason String,
nk1_contact_person_address_temporary_indicator String,
nk1_contact_person_address_bad_indicator String,
nk1_contact_person_address_address_usage String,
nk1_contact_person_address_addressee String,
nk1_contact_person_address_address_comment String,
nk1_contact_person_address_pref_order String,
nk1_contact_person_address_protection_code String,
nk1_contact_person_address_address_id String,
nk1_asoc_party_id String,
nk1_job_status String,
nk1_job_status_primary_id String,
nk1_job_status_text String,
nk1_job_status_name_of_coding_sys String,
nk1_job_status_alt_id String,
nk1_job_status_alt_text String,
nk1_job_status_name_of_alt_coding_sys String,
nk1_job_status_coding_sys_ver_id String,
nk1_job_status_alt_coding_sys_ver_id String,
nk1_job_status_original_text String,
nk1_job_status_second_alt_id String,
nk1_job_status_second_alt_text String,
nk1_job_status_name_of_second_alt_coding_sys String,
nk1_job_status_second_alt_coding_sys_ver_id String,
nk1_job_status_coding_sys_oid String,
nk1_job_status_value_set_oid String,
nk1_job_status_value_set_ver_id String,
nk1_job_status_alt_coding_sys_oid String,
nk1_job_status_alt_value_set_oid String,
nk1_job_status_alt_value_set_ver_id String,
nk1_job_status_second_alt_coding_sys_oid String,
nk1_job_status_second_alt_value_set_oid String,
nk1_job_status_second_alt_value_set_ver_id String,
nk1_race String,
nk1_handicap String,
nk1_contact_person_social_security_num String,
nk1_next_of_kin_birth_place String,
nk1_vip_ind String,
nk1_next_of_kin_telecom_info String,
nk1_next_of_kin_telecom_info_formatted_num String,
nk1_next_of_kin_telecom_info_use_code String,
nk1_next_of_kin_telecom_info_equipment_type String,
nk1_next_of_kin_telecom_info_comm_address String,
nk1_next_of_kin_telecom_info_country_code String,
nk1_next_of_kin_telecom_info_area_city_code String,
nk1_next_of_kin_telecom_info_local_number String,
nk1_next_of_kin_telecom_info_extension String,
nk1_next_of_kin_telecom_info_any_text String,
nk1_next_of_kin_telecom_info_extension_prefix String,
nk1_next_of_kin_telecom_info_speed_dial_code String,
nk1_next_of_kin_telecom_info_unformatted_num String,
nk1_next_of_kin_telecom_info_eff_from_date String,
nk1_next_of_kin_telecom_info_eff_to_date String,
nk1_next_of_kin_telecom_info_expr_reason String,
nk1_next_of_kin_telecom_info_protection_code String,
nk1_next_of_kin_telecom_info_shared_id String,
nk1_next_of_kin_telecom_info_pref_order String,
nk1_contact_person_telecom_info String,
nk1_contact_person_telecom_info_formatted_num String,
nk1_contact_person_telecom_info_use_code String,
nk1_contact_person_telecom_info_equipment_type String,
nk1_contact_person_telecom_info_comm_address String,
nk1_contact_person_telecom_info_country_code String,
nk1_contact_person_telecom_info_area_city_code String,
nk1_contact_person_telecom_info_local_number String,
nk1_contact_person_telecom_info_extension String,
nk1_contact_person_telecom_info_any_text String,
nk1_contact_person_telecom_info_extension_prefix String,
nk1_contact_person_telecom_info_speed_dial_code String,
nk1_contact_person_telecom_info_unformatted_num String,
nk1_contact_person_telecom_info_eff_from_date String,
nk1_contact_person_telecom_info_eff_to_date String,
nk1_contact_person_telecom_info_expr_reason String,
nk1_contact_person_telecom_info_protection_code String,
nk1_contact_person_telecom_info_shared_id String,
nk1_contact_person_telecom_info_pref_order String,
etl_firstinsert_datetime String
) 
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_nk1_data AS SELECT * FROM hl7_nk1_data WHERE segment_type='NK1';

CREATE EXTERNAL TABLE hl7_nte_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
nte_set_id String,
nte_comment_source String,
nte_comment String,
nte_comment_type String,
nte_comment_type_primary_id String,
nte_comment_type_text String,
nte_comment_type_name_of_coding_sys String,
nte_comment_type_alt_id String,
nte_comment_type_alt_text String,
nte_comment_type_name_of_alt_coding_sys String,
nte_comment_type_coding_sys_ver_id String,
nte_comment_type_alt_coding_sys_ver_id String,
nte_comment_type_original_text String,
nte_comment_type_second_alt_id String,
nte_comment_type_second_alt_text String,
nte_comment_type_name_of_second_alt_coding_sys String,
nte_comment_type_second_alt_coding_sys_ver_id String,
nte_comment_type_coding_sys_oid String,
nte_comment_type_value_set_oid String,
nte_comment_type_value_set_ver_id String,
nte_comment_type_alt_coding_sys_oid String,
nte_comment_type_alt_value_set_oid String,
nte_comment_type_alt_value_set_ver_id String,
nte_comment_type_second_alt_coding_sys_oid String,
nte_comment_type_second_alt_value_set_oid String,
nte_comment_type_second_alt_value_set_ver_id String,
nte_entered_by String,
nte_entered_date_time String,
nte_effective_start_date_time String,
nte_expiration_date_time String,
etl_firstinsert_datetime String
) 
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_nte_data AS SELECT * FROM hl7_nte_data WHERE segment_type='NTE';

CREATE EXTERNAL TABLE hl7_obr_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
obr_set_id String,
obr_placer_order_num String,
obr_placer_order_num_entity_id String,
obr_placer_order_num_namespace_id String,
obr_placer_order_num_universal_id String,
obr_placer_order_num_universal_id_type String,
obr_filler_order_num String,
obr_filler_order_num_entity_id String,
obr_filler_order_num_namespace_id String,
obr_filler_order_num_universal_id String,
obr_filler_order_num_universal_id_type String,
obr_universal_service_id String,
obr_universal_service_id_primary_id String,
obr_universal_service_id_text String,
obr_universal_service_id_name_of_coding_sys String,
obr_universal_service_id_alt_id String,
obr_universal_service_id_alt_text String,
obr_universal_service_id_name_of_alt_coding_sys String,
obr_universal_service_id_coding_sys_ver_id String,
obr_universal_service_id_alt_coding_sys_ver_id String,
obr_universal_service_id_original_text String,
obr_universal_service_id_second_alt_id String,
obr_universal_service_id_second_alt_text String,
obr_universal_service_id_name_of_second_alt_coding_sys String,
obr_universal_service_id_second_alt_coding_sys_ver_id String,
obr_universal_service_id_coding_sys_oid String,
obr_universal_service_id_value_set_oid String,
obr_universal_service_id_value_set_ver_id String,
obr_universal_service_id_alt_coding_sys_oid String,
obr_universal_service_id_alt_value_set_oid String,
obr_universal_service_id_alt_value_set_ver_id String,
obr_universal_service_id_second_alt_coding_sys_oid String,
obr_universal_service_id_second_alt_value_set_oid String,
obr_universal_service_id_second_alt_value_set_ver_id String,
obr_priority String,
obr_requested_date_time String,
obr_observation_date_time String,
obr_observation_end_date_time String,
obr_collection_volume String,
obr_collector_id String,
obr_specimen_action_code String,
obr_danger_code String,
obr_relevant_clinical_information String,
obr_specimen_received_date_time String,
obr_specimen_source String,
obr_specimen_source_name_code String,
obr_specimen_source_additives String,
obr_specimen_source_free_text String,
obr_specimen_source_body_site String,
obr_specimen_source_site_modfr String,
obr_specimen_source_coll_method_modfr_code String,
obr_ordering_provider String,
obr_ordering_provider_person_id String,
obr_ordering_provider_last_name String,
obr_ordering_provider_first_name String,
obr_ordering_provider_middle_name String,
obr_ordering_provider_suffix String,
obr_ordering_provider_person_prefix String,
obr_ordering_provider_degree String,
obr_ordering_provider_source_table String,
obr_ordering_provider_assgn_authr String,
obr_ordering_provider_assgn_authr_namespace_id String,
obr_ordering_provider_assgn_authr_universal_id String,
obr_ordering_provider_assgn_authr_universal_id_type String,
obr_ordering_provider_name_type_code String,
obr_ordering_provider_identifier_check_digit String,
obr_ordering_provider_check_digit_scheme String,
obr_ordering_provider_identifier_type_code String,
obr_ordering_provider_assgn_facility String,
obr_ordering_provider_name_rep_code String,
obr_ordering_provider_context String,
obr_ordering_provider_validity_range String,
obr_ordering_provider_assembly_order String,
obr_ordering_provider_eff_from_date_time String,
obr_ordering_provider_eff_to_date_time String,
obr_ordering_provider_prof_suffix String,
obr_ordering_provider_assgn_jurisdiction String,
obr_ordering_provider_assgn_agency_dept String,
obr_ordering_provider_security_check String,
obr_ordering_provider_security_check_scheme String,
obr_order_callback_phone_num String,
obr_order_callback_phone_num_formatted_num String,
obr_order_callback_phone_num_use_code String,
obr_order_callback_phone_num_equipment_type String,
obr_order_callback_phone_num_comm_address String,
obr_order_callback_phone_num_country_code String,
obr_order_callback_phone_num_area_city_code String,
obr_order_callback_phone_num_local_number String,
obr_order_callback_phone_num_extension String,
obr_order_callback_phone_num_any_text String,
obr_order_callback_phone_num_extension_prefix String,
obr_order_callback_phone_num_speed_dial_code String,
obr_order_callback_phone_num_unformatted_num String,
obr_order_callback_phone_num_eff_from_date String,
obr_order_callback_phone_num_eff_to_date String,
obr_order_callback_phone_num_expr_reason String,
obr_order_callback_phone_num_protection_code String,
obr_order_callback_phone_num_shared_id String,
obr_order_callback_phone_num_pref_order String,
obr_placer_first_generic_field String,
obr_placer_second_generic_field String,
obr_filler_first_generic_field String,
obr_filler_second_generic_field String,
obr_results_reported_status_change_date_time String,
obr_charge_to_practice String,
obr_diagnostic_service_section_id String,
obr_result_status String,
obr_parent_result String,
obr_qty_timing String,
obr_qty_timing_quantity String,
obr_qty_timing_interval String,
obr_qty_timing_duration String,
obr_qty_timing_eff_from_date_time String,
obr_qty_timing_eff_to_date_time String,
obr_qty_timing_priority String,
obr_qty_timing_condition String,
obr_qty_timing_text String,
obr_qty_timing_conjunction String,
obr_qty_timing_order_seq String,
obr_qty_timing_occurrence_dur String,
obr_qty_timing_total_occurence String,
obr_result_copy_to String,
obr_result_copy_to_person_id String,
obr_result_copy_to_last_name String,
obr_result_copy_to_first_name String,
obr_result_copy_to_middle_name String,
obr_result_copy_to_suffix String,
obr_result_copy_to_person_prefix String,
obr_result_copy_to_degree String,
obr_result_copy_to_source_table String,
obr_result_copy_to_assgn_authr String,
obr_result_copy_to_assgn_authr_namespace_id String,
obr_result_copy_to_assgn_authr_universal_id String,
obr_result_copy_to_assgn_authr_universal_id_type String,
obr_result_copy_to_name_type_code String,
obr_result_copy_to_identifier_check_digit String,
obr_result_copy_to_check_digit_scheme String,
obr_result_copy_to_identifier_type_code String,
obr_result_copy_to_assgn_facility String,
obr_result_copy_to_name_rep_code String,
obr_result_copy_to_context String,
obr_result_copy_to_validity_range String,
obr_result_copy_to_assembly_order String,
obr_result_copy_to_eff_from_date_time String,
obr_result_copy_to_eff_to_date_time String,
obr_result_copy_to_prof_suffix String,
obr_result_copy_to_assgn_jurisdiction String,
obr_result_copy_to_assgn_agency_dept String,
obr_result_copy_to_security_check String,
obr_result_copy_to_security_check_scheme String,
obr_parent_result_observation_id String,
obr_transportation_mode String,
obr_reason_for_study String,
obr_reason_for_study_primary_id String,
obr_reason_for_study_text String,
obr_reason_for_study_name_of_coding_sys String,
obr_reason_for_study_alt_id String,
obr_reason_for_study_alt_text String,
obr_reason_for_study_name_of_alt_coding_sys String,
obr_reason_for_study_coding_sys_ver_id String,
obr_reason_for_study_alt_coding_sys_ver_id String,
obr_reason_for_study_original_text String,
obr_reason_for_study_second_alt_id String,
obr_reason_for_study_second_alt_text String,
obr_reason_for_study_name_of_second_alt_coding_sys String,
obr_reason_for_study_second_alt_coding_sys_ver_id String,
obr_reason_for_study_coding_sys_oid String,
obr_reason_for_study_value_set_oid String,
obr_reason_for_study_value_set_ver_id String,
obr_reason_for_study_alt_coding_sys_oid String,
obr_reason_for_study_alt_value_set_oid String,
obr_reason_for_study_alt_value_set_ver_id String,
obr_reason_for_study_second_alt_coding_sys_oid String,
obr_reason_for_study_second_alt_value_set_oid String,
obr_reason_for_study_second_alt_value_set_ver_id String,
obr_principal_result_interpreter String,
obr_principal_result_interpreter_name String,
obr_principal_result_interpreter_name_person_id String,
obr_principal_result_interpreter_name_last_name String,
obr_principal_result_interpreter_name_first_name String,
obr_principal_result_interpreter_name_middle_name String,
obr_principal_result_interpreter_name_suffix String,
obr_principal_result_interpreter_name_person_prefix String,
obr_principal_result_interpreter_name_degree String,
obr_principal_result_interpreter_name_source_table String,
obr_principal_result_interpreter_name_assgn_authr_namespace_id String,
obr_principal_result_interpreter_name_assgn_authr_universal_id String,
obr_principal_result_interpreter_name_assgn_authr_universal_id_type String,
obr_principal_result_interpreter_eff_from_date_time String,
obr_principal_result_interpreter_eff_to_date_time String,
obr_principal_result_interpreter_point_of_care String,
obr_principal_result_interpreter_room String,
obr_principal_result_interpreter_bed String,
obr_principal_result_interpreter_facility String,
obr_principal_result_interpreter_status String,
obr_principal_result_interpreter_person_loc_type String,
obr_principal_result_interpreter_building String,
obr_principal_result_interpreter_loc_floor String,
obr_assistant_result_interpreter String,
obr_technician String,
obr_technician_name String,
obr_technician_name_person_id String,
obr_technician_name_last_name String,
obr_technician_name_first_name String,
obr_technician_name_middle_name String,
obr_technician_name_suffix String,
obr_technician_name_person_prefix String,
obr_technician_name_degree String,
obr_technician_name_source_table String,
obr_technician_name_assgn_authr_namespace_id String,
obr_technician_name_assgn_authr_universal_id String,
obr_technician_name_assgn_authr_universal_id_type String,
obr_technician_eff_from_date_time String,
obr_technician_eff_to_date_time String,
obr_technician_point_of_care String,
obr_technician_room String,
obr_technician_bed String,
obr_technician_facility String,
obr_technician_status String,
obr_technician_person_loc_type String,
obr_technician_building String,
obr_technician_loc_floor String,
obr_transcriptionist String,
obr_transcriptionist_name String,
obr_transcriptionist_name_person_id String,
obr_transcriptionist_name_last_name String,
obr_transcriptionist_name_first_name String,
obr_transcriptionist_name_middle_name String,
obr_transcriptionist_name_suffix String,
obr_transcriptionist_name_person_prefix String,
obr_transcriptionist_name_degree String,
obr_transcriptionist_name_source_table String,
obr_transcriptionist_name_assgn_authr_namespace_id String,
obr_transcriptionist_name_assgn_authr_universal_id String,
obr_transcriptionist_name_assgn_authr_universal_id_type String,
obr_transcriptionist_eff_from_date_time String,
obr_transcriptionist_eff_to_date_time String,
obr_transcriptionist_point_of_care String,
obr_transcriptionist_room String,
obr_transcriptionist_bed String,
obr_transcriptionist_facility String,
obr_transcriptionist_status String,
obr_transcriptionist_person_loc_type String,
obr_transcriptionist_building String,
obr_transcriptionist_loc_floor String,
obr_scheduled_date_time String,
obr_sample_container String,
obr_collected_sample_transport_logistic String,
obr_collector_comment String,
obr_transport_arrangement_responsibility String,
obr_transport_arranged String,
obr_escort_required String,
obr_planned_patient_transport_comment String,
obr_procedure_code String,
obr_procedure_code_primary_id String,
obr_procedure_code_text String,
obr_procedure_code_name_of_coding_sys String,
obr_procedure_code_alt_id String,
obr_procedure_code_alt_text String,
obr_procedure_code_name_of_alt_coding_sys String,
obr_procedure_code_coding_sys_ver_id String,
obr_procedure_code_alt_coding_sys_ver_id String,
obr_procedure_code_original_text String,
obr_procedure_code_second_alt_id String,
obr_procedure_code_second_alt_text String,
obr_procedure_code_name_of_second_alt_coding_sys String,
obr_procedure_code_second_alt_coding_sys_ver_id String,
obr_procedure_code_coding_sys_oid String,
obr_procedure_code_value_set_oid String,
obr_procedure_code_value_set_ver_id String,
obr_procedure_code_alt_coding_sys_oid String,
obr_procedure_code_alt_value_set_oid String,
obr_procedure_code_alt_value_set_ver_id String,
obr_procedure_code_second_alt_coding_sys_oid String,
obr_procedure_code_second_alt_value_set_oid String,
obr_procedure_code_second_alt_value_set_ver_id String,
obr_procedure_code_modifier String,
obr_procedure_code_modifier_primary_id String,
obr_procedure_code_modifier_text String,
obr_procedure_code_modifier_name_of_coding_sys String,
obr_procedure_code_modifier_alt_id String,
obr_procedure_code_modifier_alt_text String,
obr_procedure_code_modifier_name_of_alt_coding_sys String,
obr_procedure_code_modifier_coding_sys_ver_id String,
obr_procedure_code_modifier_alt_coding_sys_ver_id String,
obr_procedure_code_modifier_original_text String,
obr_procedure_code_modifier_second_alt_id String,
obr_procedure_code_modifier_second_alt_text String,
obr_procedure_code_modifier_name_of_second_alt_coding_sys String,
obr_procedure_code_modifier_second_alt_coding_sys_ver_id String,
obr_procedure_code_modifier_coding_sys_oid String,
obr_procedure_code_modifier_value_set_oid String,
obr_procedure_code_modifier_value_set_ver_id String,
obr_procedure_code_modifier_alt_coding_sys_oid String,
obr_procedure_code_modifier_alt_value_set_oid String,
obr_procedure_code_modifier_alt_value_set_ver_id String,
obr_procedure_code_modifier_second_alt_coding_sys_oid String,
obr_procedure_code_modifier_second_alt_value_set_oid String,
obr_procedure_code_modifier_second_alt_value_set_ver_id String,
obr_placer_supplemental_service_information String,
obr_filler_supplemental_service_information String,
obr_medically_necessary_duplicate_procedure_reason String,
obr_result_handling String,
obr_parent_universal_service_id String,
obr_observation_group_id String,
obr_parent_observation_group_id String,
obr_alternate_placer_order_num String,
etl_firstinsert_datetime String
) 
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_obr_data AS SELECT * FROM hl7_obr_data WHERE segment_type='OBR';

CREATE EXTERNAL TABLE hl7_obx_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
obx_set_id String,
obx_value_type String,
obx_observation_id String,
obx_observation_id_primary_id String,
obx_observation_id_text String,
obx_observation_id_name_of_coding_sys String,
obx_observation_id_alt_id String,
obx_observation_id_alt_text String,
obx_observation_id_name_of_alt_coding_sys String,
obx_observation_id_coding_sys_ver_id String,
obx_observation_id_alt_coding_sys_ver_id String,
obx_observation_id_original_text String,
obx_observation_id_second_alt_id String,
obx_observation_id_second_alt_text String,
obx_observation_id_name_of_second_alt_coding_sys String,
obx_observation_id_second_alt_coding_sys_ver_id String,
obx_observation_id_coding_sys_oid String,
obx_observation_id_value_set_oid String,
obx_observation_id_value_set_ver_id String,
obx_observation_id_alt_coding_sys_oid String,
obx_observation_id_alt_value_set_oid String,
obx_observation_id_alt_value_set_ver_id String,
obx_observation_id_second_alt_coding_sys_oid String,
obx_observation_id_second_alt_value_set_oid String,
obx_observation_id_second_alt_value_set_ver_id String,
obx_observation_sub_id String,
obx_observation_value String,
obx_observation_value_primary_id String,
obx_observation_value_text String,
obx_observation_value_name_of_coding_sys String,
obx_unit String,
obx_unit_primary_id String,
obx_unit_text String,
obx_unit_name_of_coding_sys String,
obx_unit_alt_id String,
obx_unit_alt_text String,
obx_unit_name_of_alt_coding_sys String,
obx_unit_coding_sys_ver_id String,
obx_unit_alt_coding_sys_ver_id String,
obx_unit_original_text String,
obx_unit_second_alt_id String,
obx_unit_second_alt_text String,
obx_unit_name_of_second_alt_coding_sys String,
obx_unit_second_alt_coding_sys_ver_id String,
obx_unit_coding_sys_oid String,
obx_unit_value_set_oid String,
obx_unit_value_set_ver_id String,
obx_unit_alt_coding_sys_oid String,
obx_unit_alt_value_set_oid String,
obx_unit_alt_value_set_ver_id String,
obx_unit_second_alt_coding_sys_oid String,
obx_unit_second_alt_value_set_oid String,
obx_unit_second_alt_value_set_ver_id String,
obx_reference_range String,
obx_interpretation_code String,
obx_probability String,
obx_nature_of_abnormal_test String,
obx_observation_result_status String,
obx_reference_range_eff_date_time String,
obx_user_defined_access_check String,
obx_observation_date_time String,
obx_producer_id String,
obx_producer_id_primary_id String,
obx_producer_id_text String,
obx_producer_id_name_of_coding_sys String,
obx_producer_id_alt_id String,
obx_producer_id_alt_text String,
obx_producer_id_name_of_alt_coding_sys String,
obx_producer_id_coding_sys_ver_id String,
obx_producer_id_alt_coding_sys_ver_id String,
obx_producer_id_original_text String,
obx_producer_id_second_alt_id String,
obx_producer_id_second_alt_text String,
obx_producer_id_name_of_second_alt_coding_sys String,
obx_producer_id_second_alt_coding_sys_ver_id String,
obx_producer_id_coding_sys_oid String,
obx_producer_id_value_set_oid String,
obx_producer_id_value_set_ver_id String,
obx_producer_id_alt_coding_sys_oid String,
obx_producer_id_alt_value_set_oid String,
obx_producer_id_alt_value_set_ver_id String,
obx_producer_id_second_alt_coding_sys_oid String,
obx_producer_id_second_alt_value_set_oid String,
obx_producer_id_second_alt_value_set_ver_id String,
obx_responsible_observer String,
obx_responsible_observer_person_id String,
obx_responsible_observer_last_name String,
obx_responsible_observer_first_name String,
obx_responsible_observer_middle_name String,
obx_responsible_observer_suffix String,
obx_responsible_observer_person_prefix String,
obx_responsible_observer_degree String,
obx_responsible_observer_source_table String,
obx_responsible_observer_assgn_authr String,
obx_responsible_observer_assgn_authr_namespace_id String,
obx_responsible_observer_assgn_authr_universal_id String,
obx_responsible_observer_assgn_authr_universal_id_type String,
obx_responsible_observer_name_type_code String,
obx_responsible_observer_identifier_check_digit String,
obx_responsible_observer_check_digit_scheme String,
obx_responsible_observer_identifier_type_code String,
obx_responsible_observer_assgn_facility String,
obx_responsible_observer_name_rep_code String,
obx_responsible_observer_context String,
obx_responsible_observer_validity_range String,
obx_responsible_observer_assembly_order String,
obx_responsible_observer_eff_from_date_time String,
obx_responsible_observer_eff_to_date_time String,
obx_responsible_observer_prof_suffix String,
obx_responsible_observer_assgn_jurisdiction String,
obx_responsible_observer_assgn_agency_dept String,
obx_responsible_observer_security_check String,
obx_responsible_observer_security_check_scheme String,
obx_observation_method String,
obx_equipment_instance_id String,
obx_analysis_date_time String,
obx_observation_site String,
obx_observation_instance_id String,
obx_mood_code String,
obx_performing_organization_name String,
obx_performing_organization_name_org_name String,
obx_performing_organization_name_org_name_type_code String,
obx_performing_organization_name_identifier_num String,
obx_performing_organization_name_check_digit String,
obx_performing_organization_name_check_digit_scheme String,
obx_performing_organization_name_assgn_authr String,
obx_performing_organization_name_assgn_authr_namespace_id String,
obx_performing_organization_name_assgn_authr_universal_id String,
obx_performing_organization_name_assgn_authr_universal_id_type String,
obx_performing_organization_name_identifier_type_code String,
obx_performing_organization_name_assgn_facility String,
obx_performing_organization_name_name_rep_code String,
obx_performing_organization_name_org_id String,
obx_performing_organization_address String,
obx_performing_organization_address_street_address1 String,
obx_performing_organization_address_street_address2 String,
obx_performing_organization_address_city String,
obx_performing_organization_address_state_province String,
obx_performing_organization_address_zip_postal_code String,
obx_performing_organization_address_country String,
obx_performing_organization_address_address_type String,
obx_performing_organization_address_other_geo_designation String,
obx_performing_organization_address_county_parish_code String,
obx_performing_organization_address_census_tract String,
obx_performing_organization_address_rep_code String,
obx_performing_organization_address_validity_range String,
obx_performing_organization_address_eff_from_date_time String,
obx_performing_organization_address_eff_to_date_time String,
obx_performing_organization_address_expr_reason String,
obx_performing_organization_address_temporary_indicator String,
obx_performing_organization_address_bad_address_indicator String,
obx_performing_organization_address_address_usage String,
obx_performing_organization_address_addressee String,
obx_performing_organization_address_address_comment String,
obx_performing_organization_address_pref_order String,
obx_performing_organization_address_protection_code String,
obx_performing_organization_address_address_id String,
obx_performing_organization_medical_director_name String,
obx_patient_result_release_category String,
etl_firstinsert_datetime String
) 
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_obx_data AS SELECT * FROM hl7_obx_data WHERE segment_type='OBX';

CREATE EXTERNAL TABLE hl7_orc_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
orc_order_control String,
orc_placer_order_num String,
orc_placer_order_num_entity_id String,
orc_placer_order_num_namespace_id String,
orc_placer_order_num_universal_id String,
orc_placer_order_num_universal_id_type String,
orc_filler_order_num String,
orc_filler_order_num_entity_id String,
orc_filler_order_num_namespace_id String,
orc_filler_order_num_universal_id String,
orc_filler_order_num_universal_id_type String,
orc_placer_group_num String,
orc_placer_group_num_placer_assigned_id String,
orc_placer_group_num_filler_assigned_id String,
orc_order_status String,
orc_response_flag String,
orc_qty_timing String,
orc_qty_timing_quantity String,
orc_qty_timing_interval String,
orc_qty_timing_interval_repeat_pattern String,
orc_qty_timing_interval_time_interval String,
orc_qty_timing_duration String,
orc_qty_timing_eff_from_date_time String,
orc_qty_timing_eff_to_date_time String,
orc_qty_timing_priority String,
orc_qty_timing_condition String,
orc_qty_timing_text String,
orc_qty_timing_conjunction String,
orc_qty_timing_order_seq String,
orc_qty_timing_occurrence_dur String,
orc_qty_timing_total_occurence String,
orc_parent_order String,
orc_transaction_date_time String,
orc_entered_by String,
orc_entered_by_person_id String,
orc_entered_by_last_name String,
orc_entered_by_first_name String,
orc_entered_by_middle_name String,
orc_entered_by_suffix String,
orc_entered_by_person_prefix String,
orc_entered_by_degree String,
orc_entered_by_source_table String,
orc_entered_by_assgn_authr String,
orc_entered_by_assgn_authr_namespace_id String,
orc_entered_by_assgn_authr_universal_id String,
orc_entered_by_assgn_authr_universal_id_type String,
orc_entered_by_name_type_code String,
orc_entered_by_identifier_check_digit String,
orc_entered_by_check_digit_scheme String,
orc_entered_by_identifier_type_code String,
orc_entered_by_assgn_facility String,
orc_entered_by_name_rep_code String,
orc_entered_by_context String,
orc_entered_by_validity_range String,
orc_entered_by_assembly_order String,
orc_entered_by_eff_from_date_time String,
orc_entered_by_eff_to_date_time String,
orc_entered_by_prof_suffix String,
orc_entered_by_assgn_jurisdiction String,
orc_entered_by_assgn_agency_dept String,
orc_entered_by_security_check String,
orc_entered_by_security_check_scheme String,
orc_verified_by String,
orc_ordering_provider String,
orc_ordering_provider_person_id String,
orc_ordering_provider_last_name String,
orc_ordering_provider_first_name String,
orc_ordering_provider_middle_name String,
orc_ordering_provider_suffix String,
orc_ordering_provider_person_prefix String,
orc_ordering_provider_degree String,
orc_ordering_provider_source_table String,
orc_ordering_provider_assgn_authr String,
orc_ordering_provider_assgn_authr_namespace_id String,
orc_ordering_provider_assgn_authr_universal_id String,
orc_ordering_provider_assgn_authr_universal_id_type String,
orc_ordering_provider_name_type_code String,
orc_ordering_provider_identifier_check_digit String,
orc_ordering_provider_check_digit_scheme String,
orc_ordering_provider_identifier_type_code String,
orc_ordering_provider_assgn_facility String,
orc_ordering_provider_name_rep_code String,
orc_ordering_provider_context String,
orc_ordering_provider_validity_range String,
orc_ordering_provider_assembly_order String,
orc_ordering_provider_eff_from_date_time String,
orc_ordering_provider_eff_to_date_time String,
orc_ordering_provider_prof_suffix String,
orc_ordering_provider_assgn_jurisdiction String,
orc_ordering_provider_assgn_agency_dept String,
orc_ordering_provider_security_check String,
orc_ordering_provider_security_check_scheme String,
orc_enterer_location String,
orc_enterer_location_point_of_care String,
orc_enterer_location_room String,
orc_enterer_location_bed String,
orc_enterer_location_facility String,
orc_enterer_location_status String,
orc_enterer_location_person_loc_type String,
orc_enterer_location_building String,
orc_enterer_location_loc_floor String,
orc_enterer_location_loc_desc String,
orc_enterer_location_cmprhnsv_loc_id String,
orc_enterer_location_assgn_authr_for_loc String,
orc_call_back_phone_num String,
orc_call_back_phone_num_formatted_num String,
orc_call_back_phone_num_use_code String,
orc_call_back_phone_num_equipment_type String,
orc_call_back_phone_num_comm_address String,
orc_call_back_phone_num_country_code String,
orc_call_back_phone_num_area_city_code String,
orc_call_back_phone_num_local_number String,
orc_call_back_phone_num_extension String,
orc_call_back_phone_num_any_text String,
orc_call_back_phone_num_extension_prefix String,
orc_call_back_phone_num_speed_dial_code String,
orc_call_back_phone_num_unformatted_num String,
orc_call_back_phone_num_eff_from_date String,
orc_call_back_phone_num_eff_to_date String,
orc_call_back_phone_num_expr_reason String,
orc_call_back_phone_num_protection_code String,
orc_call_back_phone_num_shared_id String,
orc_call_back_phone_num_pref_order String,
orc_order_eff_date_time String,
orc_order_control_code_reason String,
orc_entering_organization String,
orc_entering_device String,
orc_entering_device_primary_id String,
orc_entering_device_text String,
orc_entering_device_name_of_coding_sys String,
orc_entering_device_alt_id String,
orc_entering_device_alt_text String,
orc_entering_device_name_of_alt_coding_sys String,
orc_entering_device_coding_sys_ver_id String,
orc_entering_device_alt_coding_sys_ver_id String,
orc_entering_device_original_text String,
orc_entering_device_second_alt_id String,
orc_entering_device_second_alt_text String,
orc_entering_device_name_of_second_alt_coding_sys String,
orc_entering_device_second_alt_coding_sys_ver_id String,
orc_entering_device_coding_sys_oid String,
orc_entering_device_value_set_oid String,
orc_entering_device_value_set_ver_id String,
orc_entering_device_alt_coding_sys_oid String,
orc_entering_device_alt_value_set_oid String,
orc_entering_device_alt_value_set_ver_id String,
orc_entering_device_second_alt_coding_sys_oid String,
orc_entering_device_second_alt_value_set_oid String,
orc_entering_device_second_alt_value_set_ver_id String,
orc_action_by String,
orc_advanced_beneficiary_notice_code String,
orc_ordering_facility_name String,
orc_ordering_facility_name_org_name String,
orc_ordering_facility_name_org_name_type_code String,
orc_ordering_facility_name_identifier_num String,
orc_ordering_facility_name_check_digit String,
orc_ordering_facility_name_check_digit_scheme String,
orc_ordering_facility_name_assgn_authr String,
orc_ordering_facility_name_assgn_authr_namespace_id String,
orc_ordering_facility_name_assgn_authr_universal_id String,
orc_ordering_facility_name_assgn_authr_universal_id_type String,
orc_ordering_facility_name_identifier_type_code String,
orc_ordering_facility_name_assgn_facility String,
orc_ordering_facility_name_name_rep_code String,
orc_ordering_facility_name_org_id String,
orc_ordering_facility_address String,
orc_ordering_facility_address_street_address1 String,
orc_ordering_facility_address_street_address2 String,
orc_ordering_facility_address_city String,
orc_ordering_facility_address_state_province String,
orc_ordering_facility_address_zip_postal_code String,
orc_ordering_facility_address_country String,
orc_ordering_facility_address_address_type String,
orc_ordering_facility_address_other_geo_designation String,
orc_ordering_facility_address_county_parish_code String,
orc_ordering_facility_address_census_tract String,
orc_ordering_facility_address_rep_code String,
orc_ordering_facility_address_validity_range String,
orc_ordering_facility_address_eff_from_date_time String,
orc_ordering_facility_address_eff_to_date_time String,
orc_ordering_facility_address_expr_reason String,
orc_ordering_facility_address_temporary_indicator String,
orc_ordering_facility_address_bad_address_indicator String,
orc_ordering_facility_address_address_usage String,
orc_ordering_facility_address_addressee String,
orc_ordering_facility_address_address_comment String,
orc_ordering_facility_address_pref_order String,
orc_ordering_facility_address_protection_code String,
orc_ordering_facility_address_address_id String,
orc_ordering_facility_phone_num String,
orc_ordering_facility_phone_num_formatted_num String,
orc_ordering_facility_phone_num_use_code String,
orc_ordering_facility_phone_num_equipment_type String,
orc_ordering_facility_phone_num_comm_address String,
orc_ordering_facility_phone_num_country_code String,
orc_ordering_facility_phone_num_area_city_code String,
orc_ordering_facility_phone_num_local_number String,
orc_ordering_facility_phone_num_extension String,
orc_ordering_facility_phone_num_any_text String,
orc_ordering_facility_phone_num_extension_prefix String,
orc_ordering_facility_phone_num_speed_dial_code String,
orc_ordering_facility_phone_num_unformatted_num String,
orc_ordering_facility_phone_num_eff_from_date String,
orc_ordering_facility_phone_num_eff_to_date String,
orc_ordering_facility_phone_num_expr_reason String,
orc_ordering_facility_phone_num_protection_code String,
orc_ordering_facility_phone_num_shared_id String,
orc_ordering_facility_phone_num_pref_order String,
orc_ordering_provider_address String,
orc_ordering_provider_address_street_address1 String,
orc_ordering_provider_address_street_address2 String,
orc_ordering_provider_address_city String,
orc_ordering_provider_address_state_province String,
orc_ordering_provider_address_zip_postal_code String,
orc_ordering_provider_address_country String,
orc_ordering_provider_address_address_type String,
orc_ordering_provider_address_other_geo_designation String,
orc_ordering_provider_address_county_parish_code String,
orc_ordering_provider_address_census_tract String,
orc_ordering_provider_address_rep_code String,
orc_ordering_provider_address_validity_range String,
orc_ordering_provider_address_eff_from_date_time String,
orc_ordering_provider_address_eff_to_date_time String,
orc_ordering_provider_address_expr_reason String,
orc_ordering_provider_address_temporary_indicator String,
orc_ordering_provider_address_bad_address_indicator String,
orc_ordering_provider_address_address_usage String,
orc_ordering_provider_address_addressee String,
orc_ordering_provider_address_address_comment String,
orc_ordering_provider_address_pref_order String,
orc_ordering_provider_address_protection_code String,
orc_ordering_provider_address_address_id String,
orc_order_status_modifier String,
orc_advanced_beneficiary_notice_override_reason String,
orc_filler_expected_availability_date_time String,
orc_confidentiality_code String,
orc_order_type String,
orc_enterer_authr_mode String,
orc_parent_universal_service_id String,
orc_advanced_beneficiary_notice_date String,
orc_alternate_placer_order_num String,
etl_firstinsert_datetime String
) 
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_orc_data AS SELECT * FROM hl7_orc_data WHERE segment_type='ORC';

CREATE EXTERNAL TABLE hl7_pd1_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
pd1_living_dependency String,
pd1_living_arrangement String,
pd1_patient_prim_facility String,
pd1_patient_prim_facility_org_name String,
pd1_patient_prim_facility_org_name_type_code String,
pd1_patient_prim_facility_identifier_num String,
pd1_patient_prim_facility_check_digit String,
pd1_patient_prim_facility_check_digit_scheme String,
pd1_patient_prim_facility_assgn_authr String,
pd1_patient_prim_facility_identifier_type_code String,
pd1_patient_prim_facility_assgn_facility String,
pd1_patient_prim_facility_name_rep_code String,
pd1_patient_prim_facility_org_id String,
pd1_prim_care_provider String,
pd1_prim_care_provider_person_id String,
pd1_prim_care_provider_last_name String,
pd1_prim_care_provider_first_name String,
pd1_prim_care_provider_middle_name String,
pd1_prim_care_provider_suffix String,
pd1_prim_care_provider_person_prefix String,
pd1_prim_care_provider_degree String,
pd1_prim_care_provider_source_table String,
pd1_prim_care_provider_assgn_authr String,
pd1_prim_care_provider_name_type_code String,
pd1_prim_care_provider_identifier_check_digit String,
pd1_prim_care_provider_check_digit_scheme String,
pd1_prim_care_provider_identifier_type_code String,
pd1_prim_care_provider_assgn_facility String,
pd1_prim_care_provider_name_rep_code String,
pd1_prim_care_provider_context String,
pd1_prim_care_provider_validity_range String,
pd1_student_ind String,
pd1_handicap String,
pd1_living_will_code String,
pd1_organ_donor_code String,
pd1_separate_bill String,
pd1_duplicate_patient String,
pd1_publicity_code String,
pd1_protection_ind String,
pd1_protection_ind_eff_date String,
pd1_place_of_worship String,
pd1_place_of_worship_org_name String,
pd1_place_of_worship_org_name_type_code String,
pd1_place_of_worship_identifier_num String,
pd1_place_of_worship_check_digit String,
pd1_place_of_worship_check_digit_scheme String,
pd1_place_of_worship_assgn_authr String,
pd1_place_of_worship_identifier_type_code String,
pd1_place_of_worship_assgn_facility String,
pd1_place_of_worship_name_rep_code String,
pd1_place_of_worship_org_id String,
pd1_advance_directive_code String,
pd1_immunization_registry_status String,
pd1_immunization_registry_status_eff_date String,
pd1_publicity_code_eff_date String,
pd1_military_branch String,
pd1_military_rank_grade String,
pd1_military_status String,
pd1_advance_directive_last_verified_date String,
etl_firstinsert_datetime String
) 
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_pd1_data AS SELECT * FROM hl7_pd1_data WHERE segment_type='PD1';

CREATE EXTERNAL TABLE hl7_pid_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
pid_set_id String,
pid_pat_id String,
pid_pat_id_identifier_num String,
pid_pat_id_identifier_check_digit String,
pid_pat_id_check_digit_scheme String,
pid_pat_id_assgn_authr String,
pid_pat_id_assgn_authr_namespace_id String,
pid_pat_id_assgn_authr_universal_id String,
pid_pat_id_assgn_authr_universal_id_type String,
pid_pat_id_identifier_type_code String,
pid_pat_id_assgn_facility String,
pid_pat_id_assgn_facility_namespace_id String,
pid_pat_id_assgn_facility_universal_id String,
pid_pat_id_assgn_facility_universal_id_type String,
pid_pat_id_eff_from_date String,
pid_pat_id_eff_to_date String,
pid_pat_id_assgn_jurisdiction String,
pid_pat_id_assgn_agency_dept String,
pid_pat_id_list String,
pid_pat_id_list_identifier_num String,
pid_pat_id_list_identifier_check_digit String,
pid_pat_id_list_check_digit_scheme String,
pid_pat_id_list_assgn_authr String,
pid_pat_id_list_assgn_authr_namespace_id String,
pid_pat_id_list_assgn_authr_universal_id String,
pid_pat_id_list_assgn_authr_universal_id_type String,
pid_pat_id_list_identifier_type_code String,
pid_pat_id_list_assgn_facility String,
pid_pat_id_list_assgn_facility_namespace_id String,
pid_pat_id_list_assgn_facility_universal_id String,
pid_pat_id_list_assgn_facility_universal_id_type String,
pid_pat_id_list_eff_from_date String,
pid_pat_id_list_eff_to_date String,
pid_pat_id_list_assgn_jurisdiction String,
pid_pat_id_list_assgn_agency_dept String,
pid_pat_id_list_security_check String,
pid_pat_id_list_security_check_scheme String,
pid_alt_pat_id String,
pid_alt_pat_id_identifier_num String,
pid_alt_pat_id_identifier_check_digit String,
pid_alt_pat_id_check_digit_scheme String,
pid_alt_pat_id_assgn_authr String,
pid_alt_pat_id_assgn_authr_namespace_id String,
pid_alt_pat_id_assgn_authr_universal_id String,
pid_alt_pat_id_assgn_authr_universal_id_type String,
pid_alt_pat_id_identifier_type_code String,
pid_alt_pat_id_assgn_facility String,
pid_alt_pat_id_assgn_facility_namespace_id String,
pid_alt_pat_id_assgn_facility_universal_id String,
pid_alt_pat_id_assgn_facility_universal_id_type String,
pid_alt_pat_id_eff_from_date String,
pid_alt_pat_id_eff_to_date String,
pid_alt_pat_id_assgn_jurisdiction String,
pid_alt_pat_id_assgn_agency_dept String,
pid_pat_name String,
pid_pat_name_last_name String,
pid_pat_name_first_name String,
pid_pat_name_middle_name String,
pid_pat_name_suffix String,
pid_pat_name_person_prefix String,
pid_pat_name_degree String,
pid_pat_name_type_code String,
pid_pat_name_rep_code String,
pid_pat_name_context String,
pid_pat_name_validity_range String,
pid_pat_name_assembly_order String,
pid_pat_name_eff_from_date_time String,
pid_pat_name_eff_to_date_time String,
pid_pat_name_prof_suffix String,
pid_pat_name_called_by String,
pid_mother_name String,
pid_mother_name_last_name String,
pid_mother_name_first_name String,
pid_mother_name_middle_name String,
pid_mother_name_suffix String,
pid_mother_name_person_prefix String,
pid_mother_name_degree String,
pid_mother_name_type_code String,
pid_mother_name_rep_code String,
pid_mother_name_context String,
pid_mother_name_validity_range String,
pid_mother_name_assembly_order String,
pid_mother_name_eff_from_date_time String,
pid_mother_name_eff_to_date_time String,
pid_mother_name_prof_suffix String,
pid_mother_name_called_by String,
pid_birth_date_time String,
pid_sex String,
pid_pat_alias String,
pid_pat_alias_last_name String,
pid_pat_alias_first_name String,
pid_pat_alias_middle_name String,
pid_pat_alias_suffix String,
pid_pat_alias_person_prefix String,
pid_pat_alias_degree String,
pid_pat_alias_type_code String,
pid_pat_alias_name_rep_code String,
pid_pat_alias_context String,
pid_pat_alias_validity_range String,
pid_pat_alias_assembly_order String,
pid_pat_alias_eff_from_date_time String,
pid_pat_alias_eff_to_date_time String,
pid_pat_alias_prof_suffix String,
pid_race String,
pid_race_primary_id String,
pid_race_text String,
pid_race_name_of_coding_sys String,
pid_race_alt_id String,
pid_race_alt_text String,
pid_race_name_of_alt_coding_sys String,
pid_race_coding_sys_ver_id String,
pid_race_alt_coding_sys_ver_id String,
pid_race_original_text String,
pid_race_second_alt_id String,
pid_race_second_alt_text String,
pid_race_name_of_second_alt_coding_sys String,
pid_race_second_alt_coding_sys_ver_id String,
pid_race_coding_sys_oid String,
pid_race_value_set_oid String,
pid_race_value_set_ver_id String,
pid_race_alt_coding_sys_oid String,
pid_race_alt_value_set_oid String,
pid_race_alt_value_set_ver_id String,
pid_race_second_alt_coding_sys_oid String,
pid_race_second_alt_value_set_oid String,
pid_race_second_alt_value_set_ver_id String,
pid_pat_address String,
pid_pat_address_street_address1 String,
pid_pat_address_street_address2 String,
pid_pat_address_city String,
pid_pat_address_state_province String,
pid_pat_address_zip_postal_code String,
pid_pat_address_country String,
pid_pat_address_address_type String,
pid_pat_address_other_geo_designation String,
pid_pat_address_county_parish_code String,
pid_pat_address_census_tract String,
pid_pat_address_rep_code String,
pid_pat_address_validity_range String,
pid_pat_address_eff_from_date_time String,
pid_pat_address_eff_to_date_time String,
pid_pat_address_expr_reason String,
pid_pat_address_temporary_indicator String,
pid_pat_address_bad_indicator String,
pid_pat_address_address_usage String,
pid_pat_address_addressee String,
pid_pat_address_address_comment String,
pid_pat_address_pref_order String,
pid_pat_address_protection_code String,
pid_pat_address_address_id String,
pid_county_code String,
pid_home_phone_num String,
pid_home_phone_num_formatted_num String,
pid_home_phone_num_use_code String,
pid_home_phone_num_equipment_type String,
pid_home_phone_num_comm_address String,
pid_home_phone_num_country_code String,
pid_home_phone_num_area_city_code String,
pid_home_phone_num_local_number String,
pid_home_phone_num_extension String,
pid_home_phone_num_any_text String,
pid_home_phone_num_extension_prefix String,
pid_home_phone_num_speed_dial_code String,
pid_home_phone_num_unformatted_num String,
pid_home_phone_num_eff_from_date String,
pid_home_phone_num_eff_to_date String,
pid_home_phone_num_expr_reason String,
pid_home_phone_num_protection_code String,
pid_home_phone_num_shared_id String,
pid_home_phone_num_pref_order String,
pid_business_phone_num String,
pid_business_phone_num_formatted_num String,
pid_business_phone_num_use_code String,
pid_business_phone_num_equipment_type String,
pid_business_phone_num_comm_address String,
pid_business_phone_num_country_code String,
pid_business_phone_num_area_city_code String,
pid_business_phone_num_local_number String,
pid_business_phone_num_extension String,
pid_business_phone_num_any_text String,
pid_business_phone_num_extension_prefix String,
pid_business_phone_num_speed_dial_code String,
pid_business_phone_num_unformatted_num String,
pid_business_phone_num_eff_from_date String,
pid_business_phone_num_eff_to_date String,
pid_business_phone_num_expr_reason String,
pid_business_phone_num_protection_code String,
pid_business_phone_num_shared_id String,
pid_business_phone_num_pref_order String,
pid_primary_language String,
pid_primary_language_primary_id String,
pid_primary_language_text String,
pid_primary_language_name_of_coding_sys String,
pid_primary_language_alt_id String,
pid_primary_language_alt_text String,
pid_primary_language_name_of_alt_coding_sys String,
pid_primary_language_coding_sys_ver_id String,
pid_primary_language_alt_coding_sys_ver_id String,
pid_primary_language_original_text String,
pid_primary_language_second_alt_id String,
pid_primary_language_second_alt_text String,
pid_primary_language_name_of_second_alt_coding_sys String,
pid_primary_language_second_alt_coding_sys_ver_id String,
pid_primary_language_coding_sys_oid String,
pid_primary_language_value_set_oid String,
pid_primary_language_value_set_ver_id String,
pid_primary_language_alt_coding_sys_oid String,
pid_primary_language_alt_value_set_oid String,
pid_primary_language_alt_value_set_ver_id String,
pid_primary_language_second_alt_coding_sys_oid String,
pid_primary_language_second_alt_value_set_oid String,
pid_primary_language_second_alt_value_set_ver_id String,
pid_marital_status String,
pid_religion String,
pid_pat_social_security_num String,
pid_pat_driver_license_num String,
pid_mother_id String,
pid_mother_id_identifier_num String,
pid_mother_id_identifier_check_digit String,
pid_mother_id_check_digit_scheme String,
pid_mother_id_assgn_authr String,
pid_mother_id_assgn_authr_namespace_id String,
pid_mother_id_assgn_authr_universal_id String,
pid_mother_id_assgn_authr_universal_id_type String,
pid_mother_id_identifier_type_code String,
pid_mother_id_assgn_facility String,
pid_mother_id_assgn_facility_namespace_id String,
pid_mother_id_assgn_facility_universal_id String,
pid_mother_id_assgn_facility_universal_id_type String,
pid_mother_id_eff_from_date String,
pid_mother_id_eff_to_date String,
pid_mother_id_assgn_jurisdiction String,
pid_mother_id_assgn_agency_dept String,
pid_mother_id_security_check String,
pid_mother_id_security_check_scheme String,
pid_ethnic_group String,
pid_ethnic_group_primary_id String,
pid_ethnic_group_text String,
pid_ethnic_group_name_of_coding_sys String,
pid_ethnic_group_alt_id String,
pid_ethnic_group_alt_text String,
pid_ethnic_group_name_of_alt_coding_sys String,
pid_ethnic_group_coding_sys_ver_id String,
pid_ethnic_group_alt_coding_sys_ver_id String,
pid_ethnic_group_original_text String,
pid_ethnic_group_second_alt_id String,
pid_ethnic_group_second_alt_text String,
pid_ethnic_group_name_of_second_alt_coding_sys String,
pid_ethnic_group_second_alt_coding_sys_ver_id String,
pid_ethnic_group_coding_sys_oid String,
pid_ethnic_group_value_set_oid String,
pid_ethnic_group_value_set_ver_id String,
pid_ethnic_group_alt_coding_sys_oid String,
pid_ethnic_group_alt_value_set_oid String,
pid_ethnic_group_alt_value_set_ver_id String,
pid_ethnic_group_second_alt_coding_sys_oid String,
pid_ethnic_group_second_alt_value_set_oid String,
pid_ethnic_group_second_alt_value_set_ver_id String,
pid_birth_place String,
pid_multiple_birth_ind String,
pid_birth_order String,
pid_citizenship String,
pid_veterans_military_status String,
pid_nationality String,
pid_pat_death_date_time String,
pid_pat_death_ind String,
pid_identity_unknown_ind String,
pid_identity_reliability_code String,
pid_last_update_date_time String,
pid_last_update_facility String,
pid_species_code String,
pid_breed_code String,
pid_strain String,
pid_production_classification_code String,
pid_tribal_citizenship String,
pid_pat_telecom_info String,
pid_pat_telecom_info_formatted_num String,
pid_pat_telecom_info_use_code String,
pid_pat_telecom_info_equipment_type String,
pid_pat_telecom_info_comm_address String,
pid_pat_telecom_info_country_code String,
pid_pat_telecom_info_area_city_code String,
pid_pat_telecom_info_local_number String,
pid_pat_telecom_info_extension String,
pid_pat_telecom_info_any_text String,
pid_pat_telecom_info_extension_prefix String,
pid_pat_telecom_info_speed_dial_code String,
pid_pat_telecom_info_unformatted_num String,
pid_pat_telecom_info_eff_from_date String,
pid_pat_telecom_info_eff_to_date String,
pid_pat_telecom_info_expr_reason String,
pid_pat_telecom_info_protection_code String,
pid_pat_telecom_info_shared_id String,
pid_pat_telecom_info_pref_order String,
etl_firstinsert_datetime String
) 
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_pid_data AS SELECT * FROM hl7_pid_data WHERE segment_type='PID';

CREATE EXTERNAL TABLE hl7_pr1_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
pr1_set_id String,
pr1_procedure_coding_method String,
pr1_procedure_code String,
pr1_procedure_code_primary_id String,
pr1_procedure_code_text String,
pr1_procedure_code_name_of_coding_sys String,
pr1_procedure_code_alt_id String,
pr1_procedure_code_alt_text String,
pr1_procedure_code_name_of_alt_coding_sys String,
pr1_procedure_code_coding_sys_ver_id String,
pr1_procedure_code_alt_coding_sys_ver_id String,
pr1_procedure_code_original_text String,
pr1_procedure_code_second_alt_id String,
pr1_procedure_code_second_alt_text String,
pr1_procedure_code_name_of_second_alt_coding_sys String,
pr1_procedure_code_second_alt_coding_sys_ver_id String,
pr1_procedure_code_coding_sys_oid String,
pr1_procedure_code_value_set_oid String,
pr1_procedure_code_value_set_ver_id String,
pr1_procedure_code_alt_coding_sys_oid String,
pr1_procedure_code_alt_value_set_oid String,
pr1_procedure_code_alt_value_set_ver_id String,
pr1_procedure_code_second_alt_coding_sys_oid String,
pr1_procedure_code_second_alt_value_set_oid String,
pr1_procedure_code_second_alt_value_set_ver_id String,
pr1_procedure_desc String,
pr1_procedure_date_time String,
pr1_procedure_functional_type String,
pr1_procedure_minute String,
pr1_anesthesiologist String,
pr1_anesthesia_code String,
pr1_anesthesia_minute String,
pr1_surgeon String,
pr1_procedure_practitioner String,
pr1_consent_code String,
pr1_procedure_priority String,
pr1_associated_diagnosis_code String,
pr1_procedure_code_modifier String,
pr1_procedure_drg_type String,
pr1_tissue_type_code String,
pr1_procedure_id String,
pr1_procedure_action_code String,
pr1_drg_procedure_determination_status String,
pr1_drg_procedure_relevance String,
pr1_treating_organization_unit String,
pr1_respiratory_within_surgery String,
pr1_parent_procedure_id String,
etl_firstinsert_datetime String
) 
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_pr1_data AS SELECT * FROM hl7_pr1_data WHERE segment_type='PR1';

CREATE EXTERNAL TABLE hl7_pv1_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
pv1_set_id String,
pv1_pat_classification String,
pv1_assgn_pat_loc String,
pv1_assgn_pat_loc_point_of_care String,
pv1_assgn_pat_loc_room String,
pv1_assgn_pat_loc_bed String,
pv1_assgn_pat_loc_facility String,
pv1_assgn_pat_loc_status String,
pv1_assgn_pat_loc_person_loc_type String,
pv1_assgn_pat_loc_building String,
pv1_assgn_pat_loc_loc_floor String,
pv1_assgn_pat_loc_loc_desc String,
pv1_assgn_pat_loc_cmprhnsv_loc_id String,
pv1_assgn_pat_loc_assgn_authr_for_loc String,
pv1_adm_type String,
pv1_preadm_num String,
pv1_prior_pat_loc String,
pv1_prior_pat_loc_point_of_care String,
pv1_prior_pat_loc_room String,
pv1_prior_pat_loc_bed String,
pv1_prior_pat_loc_facility String,
pv1_prior_pat_loc_status String,
pv1_prior_pat_loc_person_loc_type String,
pv1_prior_pat_loc_building String,
pv1_prior_pat_loc_loc_floor String,
pv1_prior_pat_loc_loc_desc String,
pv1_prior_pat_loc_cmprhnsv_loc_id String,
pv1_prior_pat_loc_assgn_authr_for_loc String,
pv1_attending_doctor String,
pv1_attending_doctor_person_id String,
pv1_attending_doctor_last_name String,
pv1_attending_doctor_first_name String,
pv1_attending_doctor_middle_name String,
pv1_attending_doctor_suffix String,
pv1_attending_doctor_person_prefix String,
pv1_attending_doctor_degree String,
pv1_attending_doctor_source_table String,
pv1_attending_doctor_assgn_authr String,
pv1_attending_doctor_assgn_authr_namespace_id String,
pv1_attending_doctor_assgn_authr_universal_id String,
pv1_attending_doctor_assgn_authr_universal_id_type String,
pv1_attending_doctor_name_type_code String,
pv1_attending_doctor_identifier_check_digit String,
pv1_attending_doctor_check_digit_scheme String,
pv1_attending_doctor_identifier_type_code String,
pv1_attending_doctor_assgn_facility String,
pv1_attending_doctor_name_rep_code String,
pv1_attending_doctor_context String,
pv1_attending_doctor_validity_range String,
pv1_attending_doctor_assembly_order String,
pv1_attending_doctor_eff_from_date_time String,
pv1_attending_doctor_eff_to_date_time String,
pv1_attending_doctor_prof_suffix String,
pv1_attending_doctor_assgn_jurisdiction String,
pv1_attending_doctor_assgn_agency_dept String,
pv1_attending_doctor_security_check String,
pv1_attending_doctor_security_check_scheme String,
pv1_referring_doctor String,
pv1_referring_doctor_person_id String,
pv1_referring_doctor_last_name String,
pv1_referring_doctor_first_name String,
pv1_referring_doctor_middle_name String,
pv1_referring_doctor_suffix String,
pv1_referring_doctor_person_prefix String,
pv1_referring_doctor_degree String,
pv1_referring_doctor_source_table String,
pv1_referring_doctor_assgn_authr String,
pv1_referring_doctor_assgn_authr_namespace_id String,
pv1_referring_doctor_assgn_authr_universal_id String,
pv1_referring_doctor_assgn_authr_universal_id_type String,
pv1_referring_doctor_name_type_code String,
pv1_referring_doctor_identifier_check_digit String,
pv1_referring_doctor_check_digit_scheme String,
pv1_referring_doctor_identifier_type_code String,
pv1_referring_doctor_assgn_facility String,
pv1_referring_doctor_name_rep_code String,
pv1_referring_doctor_context String,
pv1_referring_doctor_validity_range String,
pv1_referring_doctor_assembly_order String,
pv1_referring_doctor_eff_from_date_time String,
pv1_referring_doctor_eff_to_date_time String,
pv1_referring_doctor_prof_suffix String,
pv1_referring_doctor_assgn_jurisdiction String,
pv1_referring_doctor_assgn_agency_dept String,
pv1_referring_doctor_security_check String,
pv1_referring_doctor_security_check_scheme String,
pv1_consulting_doctor String,
pv1_consulting_doctor_person_id String,
pv1_consulting_doctor_last_name String,
pv1_consulting_doctor_first_name String,
pv1_consulting_doctor_middle_name String,
pv1_consulting_doctor_suffix String,
pv1_consulting_doctor_person_prefix String,
pv1_consulting_doctor_degree String,
pv1_consulting_doctor_source_table String,
pv1_consulting_doctor_assgn_authr String,
pv1_consulting_doctor_assgn_authr_namespace_id String,
pv1_consulting_doctor_assgn_authr_universal_id String,
pv1_consulting_doctor_assgn_authr_universal_id_type String,
pv1_consulting_doctor_name_type_code String,
pv1_consulting_doctor_identifier_check_digit String,
pv1_consulting_doctor_check_digit_scheme String,
pv1_consulting_doctor_identifier_type_code String,
pv1_consulting_doctor_assgn_facility String,
pv1_consulting_doctor_name_rep_code String,
pv1_consulting_doctor_context String,
pv1_consulting_doctor_validity_range String,
pv1_consulting_doctor_assembly_order String,
pv1_consulting_doctor_eff_from_date_time String,
pv1_consulting_doctor_eff_to_date_time String,
pv1_consulting_doctor_prof_suffix String,
pv1_consulting_doctor_assgn_jurisdiction String,
pv1_consulting_doctor_assgn_agency_dept String,
pv1_consulting_doctor_security_check String,
pv1_consulting_doctor_security_check_scheme String,
pv1_hospital_service String,
pv1_temp_loc String,
pv1_temp_loc_point_of_care String,
pv1_temp_loc_room String,
pv1_temp_loc_bed String,
pv1_temp_loc_facility String,
pv1_temp_loc_status String,
pv1_temp_loc_person_loc_type String,
pv1_temp_loc_building String,
pv1_temp_loc_loc_floor String,
pv1_temp_loc_loc_desc String,
pv1_temp_loc_cmprhnsv_loc_id String,
pv1_temp_loc_assgn_authr_for_loc String,
pv1_preadm_test_ind String,
pv1_re_adm_ind String,
pv1_adm_source String,
pv1_ambulatory_status String,
pv1_vip_ind String,
pv1_admitting_doctor String,
pv1_admitting_doctor_person_id String,
pv1_admitting_doctor_last_name String,
pv1_admitting_doctor_first_name String,
pv1_admitting_doctor_middle_name String,
pv1_admitting_doctor_suffix String,
pv1_admitting_doctor_person_prefix String,
pv1_admitting_doctor_degree String,
pv1_admitting_doctor_source_table String,
pv1_admitting_doctor_assgn_authr String,
pv1_admitting_doctor_assgn_authr_namespace_id String,
pv1_admitting_doctor_assgn_authr_universal_id String,
pv1_admitting_doctor_assgn_authr_universal_id_type String,
pv1_admitting_doctor_name_type_code String,
pv1_admitting_doctor_identifier_check_digit String,
pv1_admitting_doctor_check_digit_scheme String,
pv1_admitting_doctor_identifier_type_code String,
pv1_admitting_doctor_assgn_facility String,
pv1_admitting_doctor_name_rep_code String,
pv1_admitting_doctor_context String,
pv1_admitting_doctor_validity_range String,
pv1_admitting_doctor_assembly_order String,
pv1_admitting_doctor_eff_from_date_time String,
pv1_admitting_doctor_eff_to_date_time String,
pv1_admitting_doctor_prof_suffix String,
pv1_admitting_doctor_assgn_jurisdiction String,
pv1_admitting_doctor_assgn_agency_dept String,
pv1_admitting_doctor_security_check String,
pv1_admitting_doctor_security_check_scheme String,
pv1_pat_type String,
pv1_visit_num String,
pv1_financial_classification String,
pv1_financial_classification_financial_class_code String,
pv1_financial_classification_eff_from_date_time String,
pv1_charge_price_ind String,
pv1_courtesy_code String,
pv1_credit_rating String,
pv1_contract_code String,
pv1_contract_eff_date String,
pv1_contract_amt String,
pv1_contract_period_duration String,
pv1_interest_code String,
pv1_transfer_to_bad_debt_code String,
pv1_transfer_to_bad_debt_date String,
pv1_bad_debt_agency_code String,
pv1_bad_debt_transfer_amt String,
pv1_bad_debt_recovery_amt String,
pv1_delete_account_ind String,
pv1_delete_account_date String,
pv1_dchg_disposition String,
pv1_dchgd_to_loc String,
pv1_diet_type String,
pv1_servicing_facility String,
pv1_bed_status String,
pv1_account_status String,
pv1_pending_loc String,
pv1_pending_loc_point_of_care String,
pv1_pending_loc_room String,
pv1_pending_loc_bed String,
pv1_pending_loc_facility String,
pv1_pending_loc_status String,
pv1_pending_loc_person_loc_type String,
pv1_pending_loc_building String,
pv1_pending_loc_loc_floor String,
pv1_pending_loc_loc_desc String,
pv1_pending_loc_cmprhnsv_loc_id String,
pv1_pending_loc_assgn_authr_for_loc String,
pv1_prior_temp_loc String,
pv1_prior_temp_loc_point_of_care String,
pv1_prior_temp_loc_room String,
pv1_prior_temp_loc_bed String,
pv1_prior_temp_loc_facility String,
pv1_prior_temp_loc_status String,
pv1_prior_temp_loc_person_loc_type String,
pv1_prior_temp_loc_building String,
pv1_prior_temp_loc_loc_floor String,
pv1_prior_temp_loc_loc_desc String,
pv1_prior_temp_loc_cmprhnsv_loc_id String,
pv1_prior_temp_loc_assgn_authr_for_loc String,
pv1_adm_date_time String,
pv1_dchg_date_time String,
pv1_current_pat_balance String,
pv1_total_charge String,
pv1_total_adjustment String,
pv1_total_payment String,
pv1_alternate_visit_id String,
pv1_visit_ind String,
pv1_other_hcare_provider String,
pv1_other_hcare_provider_person_id String,
pv1_other_hcare_provider_last_name String,
pv1_other_hcare_provider_first_name String,
pv1_other_hcare_provider_middle_name String,
pv1_other_hcare_provider_suffix String,
pv1_other_hcare_provider_person_prefix String,
pv1_other_hcare_provider_degree String,
pv1_other_hcare_provider_source_table String,
pv1_other_hcare_provider_assgn_authr String,
pv1_other_hcare_provider_assgn_authr_namespace_id String,
pv1_other_hcare_provider_assgn_authr_universal_id String,
pv1_other_hcare_provider_assgn_authr_universal_id_type String,
pv1_other_hcare_provider_name_type_code String,
pv1_other_hcare_provider_identifier_check_digit String,
pv1_other_hcare_provider_check_digit_scheme String,
pv1_other_hcare_provider_identifier_type_code String,
pv1_other_hcare_provider_assgn_facility String,
pv1_other_hcare_provider_name_rep_code String,
pv1_other_hcare_provider_context String,
pv1_other_hcare_provider_validity_range String,
pv1_other_hcare_provider_assembly_order String,
pv1_other_hcare_provider_eff_from_date_time String,
pv1_other_hcare_provider_eff_to_date_time String,
pv1_other_hcare_provider_prof_suffix String,
pv1_other_hcare_provider_assgn_jurisdiction String,
pv1_other_hcare_provider_assgn_agency_dept String,
pv1_other_hcare_provider_security_check String,
pv1_other_hcare_provider_security_check_scheme String,
pv1_service_episode_desc String,
pv1_service_episode_id String,
etl_firstinsert_datetime String
) 
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_pv1_data AS SELECT * FROM hl7_pv1_data WHERE segment_type='PV1';

CREATE EXTERNAL TABLE hl7_pv2_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
pv2_prior_pending_location String,
pv2_accommodation_code String,
pv2_adm_reason String,
pv2_transfer_reason String,
pv2_patient_valuable String,
pv2_patient_valuable_location String,
pv2_visit_user_code String,
pv2_expected_adm_date_time String,
pv2_expected_dchg_date_time String,
pv2_estimated_length_of_inpatient_stay String,
pv2_actual_length_of_inpatient_stay String,
pv2_visit_desc String,
pv2_referral_source_code String,
pv2_previous_service_date String,
pv2_empl_illness_related_ind String,
pv2_purge_status_code String,
pv2_purge_status_date String,
pv2_special_program_code String,
pv2_retention_ind String,
pv2_insurance_plan_expected_num String,
pv2_visit_publicity_code String,
pv2_visit_protection_ind String,
pv2_clinic_organization_name String,
pv2_patient_status_code String,
pv2_visit_priority_code String,
pv2_previous_treatment_date String,
pv2_expected_dchg_disposition String,
pv2_signature_on_file_date String,
pv2_first_similar_illness_date String,
pv2_patient_charge_adjustment_code String,
pv2_recurring_service_code String,
pv2_billing_media_code String,
pv2_expected_surgery_date_and_time String,
pv2_military_partnership_code String,
pv2_military_non_availability_code String,
pv2_newborn_baby_ind String,
pv2_baby_detained_ind String,
pv2_mode_of_arrival_code String,
pv2_recreational_drug_use_code String,
pv2_adm_level_of_care_code String,
pv2_precaution_code String,
pv2_patient_condition_code String,
pv2_living_will_code String,
pv2_organ_donor_code String,
pv2_advance_directive_code String,
pv2_patient_status_eff_date String,
pv2_expected_leave_of_absence_return_date_time String,
pv2_expected_preadm_testing_date_time String,
pv2_notify_clergy_code String,
pv2_advance_directive_last_verified_date String,
etl_firstinsert_datetime String
) 
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_pv2_data AS SELECT * FROM hl7_pv2_data WHERE segment_type='PV2';

CREATE EXTERNAL TABLE hl7_sft_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
sft_software_vendor_organization String,
sft_software_certified_version_release_num String,
sft_software_product_name String,
sft_software_binary_id String,
sft_software_product_information String,
sft_software_install_date String,
etl_firstinsert_datetime String
) 
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_sft_data AS SELECT * FROM hl7_sft_data WHERE segment_type='SFT';

CREATE EXTERNAL TABLE hl7_spm_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
spm_set_id String,
spm_specimen_id String,
spm_specimen_id_placer_assigned_id String,
spm_specimen_id_placer_assigned_id_entity_id String,
spm_specimen_id_placer_assigned_id_namespace_id String,
spm_specimen_id_placer_assigned_id_universal_id String,
spm_specimen_id_placer_assigned_id_universal_id_type String,
spm_specimen_id_filler_assigned_id String,
spm_specimen_id_filler_assigned_id_entity_id String,
spm_specimen_id_filler_assigned_id_namespace_id String,
spm_specimen_id_filler_assigned_id_universal_id String,
spm_specimen_id_filler_assigned_id_universal_id_type String,
spm_specimen_parent_id String,
spm_specimen_parent_id_placer_assigned_id String,
spm_specimen_parent_id_filler_assigned_id String,
spm_specimen_type String,
spm_specimen_type_primary_id String,
spm_specimen_type_text String,
spm_specimen_type_name_of_coding_sys String,
spm_specimen_type_alt_id String,
spm_specimen_type_alt_text String,
spm_specimen_type_name_of_alt_coding_sys String,
spm_specimen_type_coding_sys_ver_id String,
spm_specimen_type_alt_coding_sys_ver_id String,
spm_specimen_type_original_text String,
spm_specimen_type_second_alt_id String,
spm_specimen_type_second_alt_text String,
spm_specimen_type_name_of_second_alt_coding_sys String,
spm_specimen_type_second_alt_coding_sys_ver_id String,
spm_specimen_type_coding_sys_oid String,
spm_specimen_type_value_set_oid String,
spm_specimen_type_value_set_ver_id String,
spm_specimen_type_alt_coding_sys_oid String,
spm_specimen_type_alt_value_set_oid String,
spm_specimen_type_alt_value_set_ver_id String,
spm_specimen_type_second_alt_coding_sys_oid String,
spm_specimen_type_second_alt_value_set_oid String,
spm_specimen_type_second_alt_value_set_ver_id String,
spm_specimen_type_modifier String,
spm_specimen_additive String,
spm_specimen_collection_method String,
spm_specimen_collection_method_primary_id String,
spm_specimen_collection_method_text String,
spm_specimen_collection_method_name_of_coding_sys String,
spm_specimen_collection_method_alt_id String,
spm_specimen_collection_method_alt_text String,
spm_specimen_collection_method_name_of_alt_coding_sys String,
spm_specimen_collection_method_coding_sys_ver_id String,
spm_specimen_collection_method_alt_coding_sys_ver_id String,
spm_specimen_collection_method_original_text String,
spm_specimen_collection_method_second_alt_id String,
spm_specimen_collection_method_second_alt_text String,
spm_specimen_collection_method_name_of_second_alt_coding_sys String,
spm_specimen_collection_method_second_alt_coding_sys_ver_id String,
spm_specimen_collection_method_coding_sys_oid String,
spm_specimen_collection_method_value_set_oid String,
spm_specimen_collection_method_value_set_ver_id String,
spm_specimen_collection_method_alt_coding_sys_oid String,
spm_specimen_collection_method_alt_value_set_oid String,
spm_specimen_collection_method_alt_value_set_ver_id String,
spm_specimen_collection_method_second_alt_coding_sys_oid String,
spm_specimen_collection_method_second_alt_value_set_oid String,
spm_specimen_collection_method_second_alt_value_set_ver_id String,
spm_specimen_source_site String,
spm_specimen_source_site_modifier String,
spm_specimen_collection_site String,
spm_specimen_role String,
spm_specimen_collection_amt String,
spm_grouped_specimen_cnt String,
spm_specimen_desc String,
spm_specimen_handling_code String,
spm_specimen_risk_code String,
spm_specimen_collection_date_time String,
spm_specimen_received_date_time String,
spm_specimen_expiration_date_time String,
spm_specimen_availability String,
spm_specimen_reject_reason String,
spm_specimen_quality String,
spm_specimen_appropriateness String,
spm_specimen_condition String,
spm_specimen_current_qty String,
spm_specimen_containers_num String,
spm_container_type String,
spm_container_type_primary_id String,
spm_container_type_text String,
spm_container_type_name_of_coding_sys String,
spm_container_type_alt_id String,
spm_container_type_alt_text String,
spm_container_type_name_of_alt_coding_sys String,
spm_container_type_coding_sys_ver_id String,
spm_container_type_alt_coding_sys_ver_id String,
spm_container_type_original_text String,
spm_container_type_second_alt_id String,
spm_container_type_second_alt_text String,
spm_container_type_name_of_second_alt_coding_sys String,
spm_container_type_second_alt_coding_sys_ver_id String,
spm_container_type_coding_sys_oid String,
spm_container_type_value_set_oid String,
spm_container_type_value_set_ver_id String,
spm_container_type_alt_coding_sys_oid String,
spm_container_type_alt_value_set_oid String,
spm_container_type_alt_value_set_ver_id String,
spm_container_type_second_alt_coding_sys_oid String,
spm_container_type_second_alt_value_set_oid String,
spm_container_type_second_alt_value_set_ver_id String,
spm_container_condition String,
spm_specimen_child_role String,
spm_accession_id String,
spm_other_specimen_id String,
spm_shipment_id String,
etl_firstinsert_datetime String
) 
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_spm_data AS SELECT * FROM hl7_spm_data WHERE segment_type='SPM';

CREATE EXTERNAL TABLE hl7_tq1_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
tq1_set_id String,
tq1_qty String,
tq1_repeat_pattern String,
tq1_explicit_time String,
tq1_relative_time_and_units String,
tq1_service_duration String,
tq1_start_date_time String,
tq1_end_date_time String,
tq1_priority String,
tq1_condition_text String,
tq1_instruction_text String,
tq1_conjunction String,
tq1_occurrence_duration String,
tq1_total_occurrence String,
etl_firstinsert_datetime String
) 
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_tq1_data AS SELECT * FROM hl7_tq1_data WHERE segment_type='TQ1';

CREATE EXTERNAL TABLE hl7_txa_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
txa_set_id String,
txa_document_type String,
txa_document_type_primary_id String,
txa_document_type_text String,
txa_document_type_name_of_coding_sys String,
txa_document_type_alt_id String,
txa_document_type_alt_text String,
txa_document_type_name_of_alt_coding_sys String,
txa_document_type_coding_sys_ver_id String,
txa_document_type_alt_coding_sys_ver_id String,
txa_document_type_original_text String,
txa_document_type_second_alt_id String,
txa_document_type_second_alt_text String,
txa_document_type_name_of_second_alt_coding_sys String,
txa_document_type_second_alt_coding_sys_ver_id String,
txa_document_type_coding_sys_oid String,
txa_document_type_value_set_oid String,
txa_document_type_value_set_ver_id String,
txa_document_type_alt_coding_sys_oid String,
txa_document_type_alt_value_set_oid String,
txa_document_type_alt_value_set_ver_id String,
txa_document_type_second_alt_coding_sys_oid String,
txa_document_type_second_alt_value_set_oid String,
txa_document_type_second_alt_value_set_ver_id String,
txa_document_content_presentation String,
txa_activity_date_time String,
txa_primary_activity_provider_code_name String,
txa_primary_activity_provider_code_name_person_id String,
txa_primary_activity_provider_code_name_last_name String,
txa_primary_activity_provider_code_name_first_name String,
txa_primary_activity_provider_code_name_middle_name String,
txa_primary_activity_provider_code_name_suffix String,
txa_primary_activity_provider_code_name_person_prefix String,
txa_primary_activity_provider_code_name_degree String,
txa_primary_activity_provider_code_name_source_table String,
txa_primary_activity_provider_code_name_assgn_authr String,
txa_primary_activity_provider_code_name_name_type_code String,
txa_primary_activity_provider_code_name_identifier_check_digit String,
txa_primary_activity_provider_code_name_check_digit_scheme String,
txa_primary_activity_provider_code_name_identifier_type_code String,
txa_primary_activity_provider_code_name_assgn_facility String,
txa_primary_activity_provider_code_name_name_rep_code String,
txa_primary_activity_provider_code_name_context String,
txa_primary_activity_provider_code_name_validity_range String,
txa_primary_activity_provider_code_name_assembly_order String,
txa_primary_activity_provider_code_name_eff_from_date_time String,
txa_primary_activity_provider_code_name_eff_to_date_time String,
txa_primary_activity_provider_code_name_prof_suffix String,
txa_primary_activity_provider_code_name_assgn_jurisdiction String,
txa_primary_activity_provider_code_name_assgn_agency_dept String,
txa_primary_activity_provider_code_name_security_check String,
txa_primary_activity_provider_code_name_security_check_scheme String,
txa_origination_date_time String,
txa_transcription_date_time String,
txa_edit_date_time String,
txa_originator_code_name String,
txa_originator_code_name_person_id String,
txa_originator_code_name_last_name String,
txa_originator_code_name_first_name String,
txa_originator_code_name_middle_name String,
txa_originator_code_name_suffix String,
txa_originator_code_name_person_prefix String,
txa_originator_code_name_degree String,
txa_originator_code_name_source_table String,
txa_originator_code_name_assgn_authr String,
txa_originator_code_name_name_type_code String,
txa_originator_code_name_identifier_check_digit String,
txa_originator_code_name_check_digit_scheme String,
txa_originator_code_name_identifier_type_code String,
txa_originator_code_name_assgn_facility String,
txa_originator_code_name_name_rep_code String,
txa_originator_code_name_context String,
txa_originator_code_name_validity_range String,
txa_originator_code_name_assembly_order String,
txa_originator_code_name_eff_from_date_time String,
txa_originator_code_name_eff_to_date_time String,
txa_originator_code_name_prof_suffix String,
txa_originator_code_name_assgn_jurisdiction String,
txa_originator_code_name_assgn_agency_dept String,
txa_originator_code_name_security_check String,
txa_originator_code_name_security_check_scheme String,
txa_assigned_document_authenticator String,
txa_transcriptionist_code_name String,
txa_transcriptionist_code_name_person_id String,
txa_transcriptionist_code_name_last_name String,
txa_transcriptionist_code_name_first_name String,
txa_transcriptionist_code_name_middle_name String,
txa_transcriptionist_code_name_suffix String,
txa_transcriptionist_code_name_person_prefix String,
txa_transcriptionist_code_name_degree String,
txa_transcriptionist_code_name_source_table String,
txa_transcriptionist_code_name_assgn_authr String,
txa_transcriptionist_code_name_name_type_code String,
txa_transcriptionist_code_name_identifier_check_digit String,
txa_transcriptionist_code_name_check_digit_scheme String,
txa_transcriptionist_code_name_identifier_type_code String,
txa_transcriptionist_code_name_assgn_facility String,
txa_transcriptionist_code_name_name_rep_code String,
txa_transcriptionist_code_name_context String,
txa_transcriptionist_code_name_validity_range String,
txa_transcriptionist_code_name_assembly_order String,
txa_transcriptionist_code_name_eff_from_date_time String,
txa_transcriptionist_code_name_eff_to_date_time String,
txa_transcriptionist_code_name_prof_suffix String,
txa_transcriptionist_code_name_assgn_jurisdiction String,
txa_transcriptionist_code_name_assgn_agency_dept String,
txa_transcriptionist_code_name_security_check String,
txa_transcriptionist_code_name_security_check_scheme String,
txa_unique_document_num String,
txa_unique_document_num_entity_id String,
txa_unique_document_num_namespace_id String,
txa_unique_document_num_universal_id String,
txa_unique_document_num_universal_id_type String,
txa_parent_document_num String,
txa_placer_order_num String,
txa_filler_order_num String,
txa_unique_document_file_name String,
txa_document_completion_status String,
txa_document_confidentiality_status String,
txa_document_availability_status String,
txa_document_storage_status String,
txa_document_change_reason String,
txa_person_authentication_time_stamp String,
txa_person_authentication_time_stamp_person_id String,
txa_person_authentication_time_stamp_last_name String,
txa_person_authentication_time_stamp_first_name String,
txa_person_authentication_time_stamp_middle_name String,
txa_person_authentication_time_stamp_suffix String,
txa_person_authentication_time_stamp_person_prefix String,
txa_person_authentication_time_stamp_degree String,
txa_person_authentication_time_stamp_source_table String,
txa_person_authentication_time_stamp_assgn_authr String,
txa_person_authentication_time_stamp_name_type_code String,
txa_person_authentication_time_stamp_identifier_check_digit String,
txa_person_authentication_time_stamp_check_digit_scheme String,
txa_person_authentication_time_stamp_identifier_type_code String,
txa_person_authentication_time_stamp_assgn_facility String,
txa_person_authentication_time_stamp_name_rep_code String,
txa_person_authentication_time_stamp_context String,
txa_person_authentication_time_stamp_validity_range String,
txa_person_authentication_time_stamp_assembly_order String,
txa_person_authentication_time_stamp_eff_from_date_time String,
txa_person_authentication_time_stamp_eff_to_date_time String,
txa_person_authentication_time_stamp_prof_suffix String,
txa_person_authentication_time_stamp_assgn_jurisdiction String,
txa_person_authentication_time_stamp_assgn_agency_dept String,
txa_person_authentication_time_stamp_security_check String,
txa_person_authentication_time_stamp_security_check_scheme String,
txa_distributed_copies_code_and_name_of_recipient String,
txa_folder_assignment String,
txa_document_title String,
txa_agreed_due_date_time String,
etl_firstinsert_datetime String
) 
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_txa_data AS SELECT * FROM hl7_txa_data WHERE segment_type='TXA';

CREATE EXTERNAL TABLE  hl7_zcd_data( 
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
zcd_set_id String,
zcd_query_data String,
zcd_query_data_mnem String,
zcd_query_data_text String,
zcd_query_data_response String , 
 etl_firstinsert_datetime String )
 ROW FORMAT DELIMITED 
 FIELDS TERMINATED BY '|' 
 STORED AS TEXTFILE 
 LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data'; 

CREATE VIEW vw_hl7_zcd_data AS
SELECT * FROM hl7_zcd_data WHERE segment_type = 'ZCD';

CREATE EXTERNAL TABLE  hl7_zcn_data( 
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
zcn_set_id String,
zcn_collection_note_date_time String,
zcn_collection_note_user String,
zcn_collection_note_text String , 
 etl_firstinsert_datetime String )
 ROW FORMAT DELIMITED 
 FIELDS TERMINATED BY '|' 
 STORED AS TEXTFILE 
 LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data'; 

CREATE VIEW vw_hl7_zcn_data AS
SELECT * FROM hl7_zcn_data WHERE segment_type = 'ZCN';

CREATE EXTERNAL TABLE  hl7_zcs_data( 
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
zcs_patient_employer String,
zcs_patient_employer_address String,
zcs_patient_employer_address_street_address1 String,
zcs_patient_employer_address_street_address2 String,
zcs_patient_employer_address_city String,
zcs_patient_employer_address_state_province String,
zcs_patient_employer_address_zip_postal_code String,
zcs_patient_employment_status String,
zcs_patient_e_mail_address String,
zcs_guarantor_e_mail_address String,
zcs_patient_accounting_facility_id String , 
 etl_firstinsert_datetime String )
 ROW FORMAT DELIMITED 
 FIELDS TERMINATED BY '|' 
 STORED AS TEXTFILE 
 LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data'; 

CREATE VIEW vw_hl7_zcs_data AS
SELECT * FROM hl7_zcs_data WHERE segment_type = 'ZCS';

CREATE EXTERNAL TABLE  hl7_zex_data( 
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
zex_patient_death_date_time String,
zex_patient_death_ind String , 
 etl_firstinsert_datetime String )
 ROW FORMAT DELIMITED 
 FIELDS TERMINATED BY '|' 
 STORED AS TEXTFILE 
 LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data'; 

CREATE VIEW vw_hl7_zex_data AS
SELECT * FROM hl7_zex_data WHERE segment_type = 'ZEX';

CREATE EXTERNAL TABLE hl7_zin_data (
segment_type STRING,
msh_sending_facility STRING,
msh_msg_control_id STRING,
pid_medical_record_num STRING,
pid_medical_record_urn STRING,
pid_pat_account_num STRING,
zin_precertification_agency_name STRING,
zin_bed_days_information STRING,
zin_bed_days_information_start_date STRING,
zin_bed_days_information_end_date STRING,
zin_bed_days_information_bed_days_type STRING,
zin_bed_days_information_total_days STRING,
zin_bed_days_next_review_date STRING,
zin_total_approved_day STRING,
zin_denied_days_information STRING,
zin_denied_days_information_start_date STRING,
zin_denied_days_information_end_date STRING,
zin_total_denied_day STRING,
zin_alternative_subscriber_name STRING,
zin_alternative_subscriber_birth_date STRING,
zin_insured_relationship_to_guarantor STRING,
zin_member_relationship_to_guarantor STRING,
zin_process_control_num STRING,
zin_attached_referral_id STRING,
etl_firstinsert_datetime STRING
)
 ROW FORMAT DELIMITED 
 FIELDS TERMINATED BY '|' 
 STORED AS TEXTFILE 
 LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data'; 

CREATE VIEW vw_hl7_zin_data AS
SELECT * FROM hl7_zin_data WHERE segment_type = 'ZIN';

CREATE EXTERNAL TABLE  hl7_zm1_data( 
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
zm1_set_id String,
zm1_insurance String,
zm1_query_data String,
zm1_query_data_mnem String,
zm1_query_data_text String,
zm1_query_data_response String , 
 etl_firstinsert_datetime String )
 ROW FORMAT DELIMITED 
 FIELDS TERMINATED BY '|' 
 STORED AS TEXTFILE 
 LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data'; 

CREATE VIEW vw_hl7_zm1_data AS
SELECT * FROM hl7_zm1_data WHERE segment_type = 'ZM1';

CREATE EXTERNAL TABLE  hl7_zmr_data( 
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
zmr_set_id String,
zmr_med_rec_num String , 
 etl_firstinsert_datetime String )
 ROW FORMAT DELIMITED 
 FIELDS TERMINATED BY '|' 
 STORED AS TEXTFILE 
 LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data'; 

CREATE VIEW vw_hl7_zmr_data AS
SELECT * FROM hl7_zmr_data WHERE segment_type = 'ZMR';

CREATE EXTERNAL TABLE  hl7_zsu_data( 
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
zsu_event_type String,
zsu_patient_prior_unit_num String , 
 etl_firstinsert_datetime String )
 ROW FORMAT DELIMITED 
 FIELDS TERMINATED BY '|' 
 STORED AS TEXTFILE 
 LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data'; 

CREATE VIEW vw_hl7_zsu_data AS
SELECT * FROM hl7_zsu_data WHERE segment_type = 'ZSU';

CREATE EXTERNAL TABLE  hl7_zur_data( 
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
zur_set_id String,
zur_information String , 
 etl_firstinsert_datetime String )
 ROW FORMAT DELIMITED 
 FIELDS TERMINATED BY '|' 
 STORED AS TEXTFILE 
 LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data'; 

CREATE VIEW vw_hl7_zur_data AS
SELECT * FROM hl7_zur_data WHERE segment_type = 'ZUR';

CREATE EXTERNAL TABLE  hl7_zrq_data( 
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
zrq_set_id String,
zrq_data_type String,
zrq_external_id String,
zrq_sub_id String,
zrq_item_value String , 
 etl_firstinsert_datetime String )
 ROW FORMAT DELIMITED 
 FIELDS TERMINATED BY '|' 
 STORED AS TEXTFILE 
 LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data'; 

CREATE VIEW vw_hl7_zrq_data AS
SELECT * FROM hl7_zrq_data WHERE segment_type = 'ZRQ';

CREATE EXTERNAL TABLE  hl7_zid_data( 
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
zid_surviving_id String,
zid_non_surviving_id String , 
 etl_firstinsert_datetime String )
 ROW FORMAT DELIMITED 
 FIELDS TERMINATED BY '|' 
 STORED AS TEXTFILE 
 LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data'; 

CREATE VIEW vw_hl7_zid_data AS
SELECT * FROM hl7_zid_data WHERE segment_type = 'ZID';

CREATE EXTERNAL TABLE  hl7_zpe_data( 
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
zpe_record_id String,
zpe_transfer_priority String,
zpe_bed_type String,
zpe_ordering_provider String,
zpe_bed_request_status String,
zpe_reason String,
zpe_comment String , 
 etl_firstinsert_datetime String )
 ROW FORMAT DELIMITED 
 FIELDS TERMINATED BY '|' 
 STORED AS TEXTFILE 
 LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data'; 

CREATE VIEW vw_hl7_zpe_data AS
SELECT * FROM hl7_zpe_data WHERE segment_type = 'ZPE';

CREATE EXTERNAL TABLE  hl7_zg1_data( 
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
zg1_fpl_effective_from_date String,
zg1_fpl_effective_to_date String,
zg1_fpl_pct String,
zg1_guarantor_service_area String , 
 etl_firstinsert_datetime String )
 ROW FORMAT DELIMITED 
 FIELDS TERMINATED BY '|' 
 STORED AS TEXTFILE 
 LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data'; 

CREATE VIEW vw_hl7_zg1_data AS
SELECT * FROM hl7_zg1_data WHERE segment_type = 'ZG1';

CREATE EXTERNAL TABLE  hl7_zmp_data( 
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
zmp_set_id String,
zmp_black_lung_benefit String,
zmp_black_lung_benefit_date String,
zmp_service_paid_by_government_program String,
zmp_va_authorization String,
zmp_accident String,
zmp_work_related_accident String,
zmp_injury_illness_date String,
zmp_worker_comp_policy_num String,
zmp_worker_comp_address String,
zmp_worker_comp_address_street_address1 String,
zmp_worker_comp_address_street_address2 String,
zmp_worker_comp_address_city String,
zmp_worker_comp_address_state_province String,
zmp_worker_comp_address_zip_postal_code String,
zmp_accident_liability_policy String,
zmp_worker_comp_employer_name String,
zmp_worker_comp_employer_address String,
zmp_worker_comp_employer_address_street_address1 String,
zmp_worker_comp_employer_address_street_address2 String,
zmp_worker_comp_employer_address_city String,
zmp_worker_comp_employer_address_state_province String,
zmp_worker_comp_employer_address_zip_postal_code String,
zmp_illness_due_to_non_work_related_accident String,
zmp_auto_related_injury String,
zmp_accident_date String,
zmp_no_fault_non_liability_insurance_name String,
zmp_no_fault_non_liability_insurance_address String,
zmp_no_fault_non_liability_insurance_address_street_address1 String,
zmp_no_fault_non_liability_insurance_address_street_address2 String,
zmp_no_fault_non_liability_insurance_address_city String,
zmp_no_fault_non_liability_insurance_address_state_province String,
zmp_no_fault_non_liability_insurance_address_zip_postal_code String,
zmp_no_fault_non_liability_insurance_claim_num String,
zmp_third_party_liable String,
zmp_liability_insurer_name String,
zmp_liability_insurer_address String,
zmp_liability_insurer_address_street_address1 String,
zmp_liability_insurer_address_street_address2 String,
zmp_liability_insurer_address_city String,
zmp_liability_insurer_address_state_province String,
zmp_liability_insurer_address_zip_postal_code String,
zmp_liability_claim_num String,
zmp_medicare_eligibility_reason String,
zmp_patient_employment_status String,
zmp_patient_retirement_date String,
zmp_patient_employer_name String,
zmp_patient_employer_address String,
zmp_patient_employer_address_street_address1 String,
zmp_patient_employer_address_street_address2 String,
zmp_patient_employer_address_city String,
zmp_patient_employer_address_state_province String,
zmp_patient_employer_address_zip_postal_code String,
zmp_spouse_information String,
zmp_spouse_employment_status String,
zmp_spouse_retirement_date String,
zmp_other_employer_name String,
zmp_other_employer_address String,
zmp_other_employer_address_street_address1 String,
zmp_other_employer_address_street_address2 String,
zmp_other_employer_address_city String,
zmp_other_employer_address_state_province String,
zmp_other_employer_address_zip_postal_code String,
zmp_group_hlth_coverage String,
zmp_group_hlth_coverage_employer_size String,
zmp_group_hlth_plan String,
zmp_group_hlth_plan_address String,
zmp_group_hlth_plan_address_street_address1 String,
zmp_group_hlth_plan_address_street_address2 String,
zmp_group_hlth_plan_address_city String,
zmp_group_hlth_plan_address_state_province String,
zmp_group_hlth_plan_address_zip_postal_code String,
zmp_group_hlth_plan_member_num String,
zmp_group_hlth_plan_group_num String,
zmp_group_hlth_plan_policy_hldr_name String,
zmp_group_hlth_plan_policy_hldr_relt_to_pat String,
zmp_kidney_transplant_status String,
zmp_transplant_date String,
zmp_dialysis_start_date String,
zmp_self_dialysis_training_program_start_date String,
zmp_month_coordination_period String,
zmp_initial_entitlement_based_on_esrd String,
zmp_information_supplied_by String,
zmp_mspq_completion_status String,
zmp_mspq_completion_user String,
zmp_mspq_completion_date String,
zmp_is_eghp_self_based String,
zmp_end_stage_renal_disease String,
zmp_non_esrd_disability String,
zmp_receiving_training_for_home_dialysis String,
zmp_entitled_based_on_age String,
zmp_working_aged_or_disability_provision_applies String,
zmp_received_maintenance_dialysis_treatment String,
zmp_spouse_eghp_covrage_has_employees String,
zmp_sponsored_by_patient_current_employer String,
zmp_sponsored_by_spouse_current_employer String,
zmp_sponsored_by_family_member_current_employer String , 
 etl_firstinsert_datetime String )
 ROW FORMAT DELIMITED 
 FIELDS TERMINATED BY '|' 
 STORED AS TEXTFILE 
 LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data'; 

CREATE VIEW vw_hl7_zmp_data AS
SELECT * FROM hl7_zmp_data WHERE segment_type = 'ZMP';

CREATE EXTERNAL TABLE  hl7_zdt_data( 
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
zdt_set_id String,
zdt_event_type_code String,
zdt_patient_class String,
zdt_assigned_patient_location String,
zdt_assigned_patient_location_point_of_care String,
zdt_assigned_patient_location_room String,
zdt_assigned_patient_location_bed String,
zdt_assigned_patient_location_facility String,
zdt_assigned_patient_location_status String,
zdt_assigned_patient_location_person_loc_type String,
zdt_assigned_patient_location_building String,
zdt_assigned_patient_location_floor String,
zdt_assigned_patient_location_desc String,
zdt_event_start_date_time String,
zdt_accomodation_code String,
zdt_hospital_service String,
zdt_admission_level_care_code String , 
 etl_firstinsert_datetime String )
 ROW FORMAT DELIMITED 
 FIELDS TERMINATED BY '|' 
 STORED AS TEXTFILE 
 LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data'; 

CREATE VIEW vw_hl7_zdt_data AS
SELECT * FROM hl7_zdt_data WHERE segment_type = 'ZDT';

CREATE EXTERNAL TABLE  hl7_zif_data( 
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
zif_patient_encounter_infection_type1 String,
zif_patient_encounter_infection_type1_type String,
zif_patient_encounter_infection_type1_instant_added String,
zif_patient_encounter_infection_type1_instant_resolved String,
zif_patient_encounter_infection_type2 String,
zif_patient_encounter_infection_type2_type String,
zif_patient_encounter_infection_type2_instant_added String,
zif_patient_encounter_infection_type2_instant_resolved String , 
 etl_firstinsert_datetime String )
 ROW FORMAT DELIMITED 
 FIELDS TERMINATED BY '|' 
 STORED AS TEXTFILE 
 LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data'; 

CREATE VIEW vw_hl7_zif_data AS
SELECT * FROM hl7_zif_data WHERE segment_type = 'ZIF';

CREATE EXTERNAL TABLE  hl7_zpv_data( 
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
zpv_clinic_code String,
zpv_client_code String,
zpv_current_flowsheet_value String,
zpv_current_flowsheet_value_id String,
zpv_current_flowsheet_value_value String,
zpv_adt_filter_flag String,
zpv_bed_phone_num String,
zpv_last_menstrual_period String,
zpv_insurance_type String,
zpv_research_study_id String,
zpv_billing_indicator String,
zpv_billing_indicator_n_a String,
zpv_billing_indicator_title String,
zpv_stop_bill_indicator String,
zpv_stop_bill_indicator_n_a String,
zpv_stop_bill_indicator_title String,
zpv_first_inpatient_occurence_date_time String,
zpv_first_outpatient_occurence_date_time String,
zpv_first_ed_patient_occurence_date_time String,
zpv_rtls_badge_id String,
zpv_ed_disposition String,
zpv_bed_type String,
zpv_bed_type_code String,
zpv_bed_type_text String,
zpv_bed_type_reason String,
zpv_bed_type_reason_code String,
zpv_bed_type_reason_text String,
zpv_room_type String,
zpv_room_type_code String,
zpv_room_type_text String,
zpv_room_type_reason String,
zpv_room_type_reason_code String,
zpv_room_type_reason_text String,
zpv_accomodation_code_reason String,
zpv_accomodation_code_reason_code String,
zpv_accomodation_code_reason_text String , 
 etl_firstinsert_datetime String )
 ROW FORMAT DELIMITED 
 FIELDS TERMINATED BY '|' 
 STORED AS TEXTFILE 
 LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data'; 

CREATE VIEW vw_hl7_zpv_data AS
SELECT * FROM hl7_zpv_data WHERE segment_type = 'ZPV';

CREATE EXTERNAL TABLE  hl7_zdu_data( 
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
zdu_set_id String,
zdu_academic_degree String,
zdu_academic_degree_program_date_range String,
zdu_academic_degree_program_part_date_range String,
zdu_academic_degree_granted_date String,
zdu_school_name String,
zdu_school_type_code String,
zdu_school_address String , 
 etl_firstinsert_datetime String )
 ROW FORMAT DELIMITED 
 FIELDS TERMINATED BY '|' 
 STORED AS TEXTFILE 
 LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data'; 

CREATE VIEW vw_hl7_zdu_data AS
SELECT * FROM hl7_zdu_data WHERE segment_type = 'ZDU';

CREATE EXTERNAL TABLE  hl7_zpd_data( 
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
zpd_patient_ancestry String,
zpd_preferred_communication_method String,
zpd_multiple_birth_total String,
zpd_my_chart_status String,
zpd_research_study_id String,
zpd_authorized_service_area String,
zpd_pregnancy_flag String,
zpd_expected_delivery_date String,
zpd_transplant_patient_flag String , 
 etl_firstinsert_datetime String )
 ROW FORMAT DELIMITED 
 FIELDS TERMINATED BY '|' 
 STORED AS TEXTFILE 
 LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data'; 

CREATE VIEW vw_hl7_zpd_data AS
SELECT * FROM hl7_zpd_data WHERE segment_type = 'ZPD';

CREATE EXTERNAL TABLE  hl7_zvn_data( 
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
zvn_triggering_workstation String,
zvn_triggering_workstation_id String,
zvn_triggering_workstation_name String,
zvn_triggering_workstation_n_a String,
zvn_triggering_workstation_dept_name String,
zvn_triggering_workstation_user_login_dept String , 
 etl_firstinsert_datetime String )
 ROW FORMAT DELIMITED 
 FIELDS TERMINATED BY '|' 
 STORED AS TEXTFILE 
 LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data'; 

CREATE VIEW vw_hl7_zvn_data AS
SELECT * FROM hl7_zvn_data WHERE segment_type = 'ZVN';

CREATE EXTERNAL TABLE hl7_zcl_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
zcl_counter String,
zcl_call_type String,
zcl_call_type_type_code String,
zcl_call_type_type_desc String,
zcl_caller_name String,
zcl_contact String,
zcl_contact_person_id String,
zcl_contact_type_code String,
zcl_filed_information String,
zcl_filed_information_file_date_time String,
zcl_filed_information_person_id String,
zcl_filed_information_type_code String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_zcl_data AS
SELECT * FROM hl7_zcl_data WHERE segment_type = 'ZCL';

CREATE EXTERNAL TABLE hl7_zer_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
zer_expected_arrival_date_time String,
zer_arrival_date_time String,
zer_triage_date_time String,
zer_mpi_search String,
zer_complaint String,
zer_complaint_complaint_code String,
zer_complaint_complaint_desc String,
zer_priority String,
zer_priority_priority_code String,
zer_priority_priority_name String,
zer_priority_priority_rank String,
zer_location String,
zer_location_location_code String,
zer_location_location_name String,
zer_room_treatment String,
zer_room_treatment_room_treatment_code String,
zer_room_treatment_room_treatment_name String,
zer_wait_list String,
zer_wait_list_wait_list_code String,
zer_wait_list_wait_list_description String,
zer_wait_list_wait_list_number String,
zer_current_status_event String,
zer_current_status_event_event_code String,
zer_current_status_event_event_desc String,
zer_nurse_id String,
zer_practitioner_id String,
zer_departure_information String,
zer_departure_information_departure_date String,
zer_departure_information_disposition String,
zer_departure_information_disposition_code String,
zer_departure_information_disposition_description String,
zer_departure_information_condition String,
zer_departure_information_condition_code String,
zer_departure_information_condition_description String,
zer_departure_information_departure_comment String,
zer_departure_information_impression_urn String,
zer_ambulance_company String,
zer_ambulance_company_ambulance_company String,
zer_ambulance_company_ambulance_company_mnem String,
zer_ambulance_company_ambulance_company_name String,
zer_ambulance_company_ambulance_company_id String,
zer_ambulance_company_call_date_time String,
zer_estimated_time_of_arrival String,
zer_reserved_room_treatment String,
zer_reserved_room_treatment_room_treatment_code String,
zer_reserved_room_treatment_room_treatment_name String,
zer_assessment String,
zer_assessment_assessment String,
zer_assessment_assessment_code String,
zer_assessment_assessment_description String,
zer_assessment_assessment_date_time String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_zer_data AS
SELECT * FROM hl7_zer_data WHERE segment_type = 'ZER';

CREATE EXTERNAL TABLE hl7_zsi_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
zsi_set_id String,
zsi_indicator_id String,
zsi_indicator_information String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_zsi_data AS
SELECT * FROM hl7_zsi_data WHERE segment_type = 'ZSI';

CREATE EXTERNAL TABLE hl7_zds_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
zds_study_instance String,
zds_study_instance_reference_pointer String,
zds_study_instance_application_id String,
zds_study_instance_data_type String,
zds_study_instance_subtype String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7_qa/hl7_all_segment_data';

CREATE VIEW vw_hl7_zds_data AS
SELECT * FROM hl7_zds_data WHERE segment_type = 'ZDS';