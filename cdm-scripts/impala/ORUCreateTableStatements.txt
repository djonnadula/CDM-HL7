CREATE EXTERNAL TABLE hl7.hl7_nte_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
nte_set_id String,
nte_comment_source String,
nte_comment_source_code String,
nte_comment_source_comment_type_query_mnem String,
nte_comment_source_counter_num_query_text String,
nte_comment_source_query_type String,
nte_comment String,
nte_comment_type String,
nte_entered_by String,
nte_entered_date_time String,
nte_effective_start_date_time String,
nte_expiration_date_time String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED 
FIELDS TERMINATED BY '|' 
STORED AS SEQUENCEFILE 
LOCATION '/user/hive/warehouse/hl7.db/hl7_all_segment_data'; 

CREATE VIEW hl7.vw_hl7_nte_data AS
SELECT * FROM hl7.hl7_nte_data WHERE segment_type = 'NTE';

CREATE EXTERNAL TABLE hl7.hl7_orc_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
orc_order_control String,
orc_placer_order_num_entity_id String,
orc_placer_order_num_namespace_id String,
orc_placer_order_num_universal_id String,
orc_placer_order_num_universal_id_type String,
orc_filler_order_num String,
orc_filler_order_num_entity_id String,
orc_filler_order_num_namespace_id String,
orc_filler_order_num_universal_id String,
orc_filler_order_num_universal_id_type String,
orc_placer_group_num String,
orc_placer_group_num_placer_assigned_id String,
orc_placer_group_num_filler_assigned_id String,
orc_order_status String,
orc_response_flag String,
orc_qty_timing String,
orc_parent_order String,
orc_transaction_date_time String,
orc_entered_by String,
orc_verified_by String,
orc_ordering_provider String,
orc_ordering_provider_provider_id String,
orc_ordering_provider_last_name String,
orc_ordering_provider_first_name String,
orc_ordering_provider_middle_name String,
orc_ordering_provider_suffix String,
orc_ordering_provider_prefix String,
orc_ordering_provider_degree String,
orc_ordering_provider_source_table String,
orc_ordering_provider_assgn_authr String,
orc_ordering_provider_assgn_authr_namespace_id String,
orc_ordering_provider_assgn_authr_universal_id String,
orc_ordering_provider_assgn_authr_universal_id_type String,
orc_ordering_provider_name_type_code String,
orc_ordering_provider_identifier_check_digit String,
orc_ordering_provider_check_digit_scheme String,
orc_ordering_provider_identifier_type_code String,
orc_ordering_provider_assgn_facility String,
orc_ordering_provider_name_rep_code String,
orc_ordering_provider_name_context String,
orc_ordering_provider_name_validity_range String,
orc_ordering_provider_name_assembly_order String,
orc_ordering_provider_eff_from_date_time String,
orc_ordering_provider_eff_to_date_time String,
orc_ordering_provider_prof_suffix String,
orc_ordering_provider_assgn_jurisdiction String,
orc_ordering_provider_assgn_agency_dept String,
orc_ordering_provider_security_check String,
orc_ordering_provider_security_check_scheme String,
orc_enterer_location String,
orc_enterer_location_point_of_care String,
orc_enterer_location_room String,
orc_enterer_location_bed String,
orc_enterer_location_facility String,
orc_enterer_location_status String,
orc_enterer_location_person_loc_type String,
orc_enterer_location_building String,
orc_enterer_location_floor String,
orc_enterer_location_desc String,
orc_enterer_location_cmprhnsv_loc_identifier String,
orc_enterer_location_assgn_authr_for_loc String,
orc_call_back_phone_num String,
orc_call_back_phone_num_formatted String,
orc_call_back_phone_num_use_code String,
orc_call_back_phone_num_equipment_type String,
orc_call_back_phone_num_comm_address String,
orc_call_back_phone_num_country_code String,
orc_call_back_phone_num_area_city_code String,
orc_call_back_phone_num_local_number String,
orc_call_back_phone_num_extension String,
orc_call_back_phone_num_any_text String,
orc_call_back_phone_num_extension_prefix String,
orc_call_back_phone_num_speed_dial_code String,
orc_call_back_phone_num_unformatted String,
orc_call_back_phone_num_eff_from_date String,
orc_call_back_phone_num_eff_to_date String,
orc_call_back_phone_num_expr_reason String,
orc_call_back_phone_num_protection_code String,
orc_call_back_phone_num_shared_id String,
orc_call_back_phone_num_pref_order String,
orc_order_eff_date_time String,
orc_order_control_code_reason String,
orc_entering_organization String,
orc_entering_device String,
orc_action_by String,
orc_advanced_beneficiary_notice_code String,
orc_ordering_facility_name String,
orc_ordering_facility_name_org_name String,
orc_ordering_facility_name_org_name_type_code String,
orc_ordering_facility_name_id_num String,
orc_ordering_facility_name_check_digit String,
orc_ordering_facility_name_check_digit_scheme String,
orc_ordering_facility_name_assgn_authr String,
orc_ordering_facility_name_assgn_authr_namespace_id String,
orc_ordering_facility_name_assgn_authr_universal_id String,
orc_ordering_facility_name_assgn_authr_universal_id_type String,
orc_ordering_facility_name_identifier_type_code String,
orc_ordering_facility_name_assgn_facility String,
orc_ordering_facility_name_name_rep_code String,
orc_ordering_facility_name_org_id String,
orc_ordering_facility_address String,
orc_ordering_facility_address_street_address1 String,
orc_ordering_facility_address_street_address2 String,
orc_ordering_facility_address_city String,
orc_ordering_facility_address_state_province String,
orc_ordering_facility_address_zip_postal_code String,
orc_ordering_facility_address_country String,
orc_ordering_facility_address_type String,
orc_ordering_facility_address_other_geo_designation String,
orc_ordering_facility_address_county_parish_code String,
orc_ordering_facility_address_census_tract String,
orc_ordering_facility_address_rep_code String,
orc_ordering_facility_address_validity_range String,
orc_ordering_facility_address_eff_from_date_time String,
orc_ordering_facility_address_eff_to_date_time String,
orc_ordering_facility_address_expr_reason String,
orc_ordering_facility_address_temporary_indicator String,
orc_ordering_facility_address_bad_address_indicator String,
orc_ordering_facility_address_usage String,
orc_ordering_facility_address_addressee String,
orc_ordering_facility_address_comment String,
orc_ordering_facility_address_pref_order String,
orc_ordering_facility_address_protection_code String,
orc_ordering_facility_address_identifier String,
orc_ordering_facility_phone_num String,
orc_ordering_facility_phone_num_formatted String,
orc_ordering_facility_phone_num_use_code String,
orc_ordering_facility_phone_num_equipment_type String,
orc_ordering_facility_phone_num_comm_address String,
orc_ordering_facility_phone_num_country_code String,
orc_ordering_facility_phone_num_area_city_code String,
orc_ordering_facility_phone_num_local_number String,
orc_ordering_facility_phone_num_extension String,
orc_ordering_facility_phone_num_any_text String,
orc_ordering_facility_phone_num_extension_prefix String,
orc_ordering_facility_phone_num_speed_dial_code String,
orc_ordering_facility_phone_num_unformatted String,
orc_ordering_facility_phone_num_eff_from_date String,
orc_ordering_facility_phone_num_eff_to_date String,
orc_ordering_facility_phone_num_expr_reason String,
orc_ordering_facility_phone_num_protection_code String,
orc_ordering_facility_phone_num_shared_id String,
orc_ordering_facility_phone_num_pref_order String,
orc_ordering_provider_address String,
orc_ordering_provider_address_street_address1 String,
orc_ordering_provider_address_street_address2 String,
orc_ordering_provider_address_city String,
orc_ordering_provider_address_state_province String,
orc_ordering_provider_address_zip_postal_code String,
orc_ordering_provider_address_country String,
orc_ordering_provider_address_type String,
orc_ordering_provider_address_other_geo_designation String,
orc_ordering_provider_address_county_parish_code String,
orc_ordering_provider_address_census_tract String,
orc_ordering_provider_address_rep_code String,
orc_ordering_provider_address_validity_range String,
orc_ordering_provider_address_eff_from_date_time String,
orc_ordering_provider_address_eff_to_date_time String,
orc_ordering_provider_address_expr_reason String,
orc_ordering_provider_address_temporary_indicator String,
orc_ordering_provider_address_bad_address_indicator String,
orc_ordering_provider_address_usage String,
orc_ordering_provider_address_addressee String,
orc_ordering_provider_address_comment String,
orc_ordering_provider_address_pref_order String,
orc_ordering_provider_address_protection_code String,
orc_ordering_provider_address_identifier String,
orc_order_status_modifier String,
orc_advanced_beneficiary_notice_override_reason String,
orc_filler_expected_availability_date_time String,
orc_confidentiality_code String,
orc_order_type String,
orc_enterer_authr_mode String,
orc_parent_universal_service_id String,
orc_advanced_beneficiary_notice_date String,
orc_alternate_placer_order_num String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED 
FIELDS TERMINATED BY '|' 
STORED AS SEQUENCEFILE 
LOCATION '/user/hive/warehouse/hl7.db/hl7_all_segment_data'; 

CREATE VIEW hl7.vw_hl7_orc_data AS
SELECT * FROM hl7.hl7_orc_data WHERE segment_type = 'ORC';

CREATE EXTERNAL TABLE hl7.hl7_obr_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
obr_set_id String, 
obr_placer_order_num String, 
obr_placer_order_num_entity_id String, 
obr_placer_order_num_namespace_id String, 
obr_placer_order_num_universal_id String, 
obr_placer_order_num_universal_id_type String, 
obr_filler_order_num String, 
obr_filler_order_num_entity_id String, 
obr_filler_order_num_namespace_id String, 
obr_filler_order_num_universal_id String, 
obr_filler_order_num_universal_id_type String, 
obr_universal_service_id String, 
obr_universal_service_id_identifier String, 
obr_universal_service_id_text String, 
obr_universal_service_id_name_of_coding_sys String, 
obr_universal_service_id_alt_identifier String, 
obr_universal_service_id_alt_text String, 
obr_universal_service_id_name_of_alt_coding_sys String, 
obr_universal_service_id_coding_sys_ver_id String, 
obr_universal_service_id_alt_coding_sys_ver_id String, 
obr_universal_service_id_original_text String, 
obr_universal_service_id_second_alt_id String, 
obr_universal_service_id_second_alt_text String, 
obr_universal_service_id_name_of_second_alt_coding_sys String, 
obr_universal_service_id_second_alt_coding_sys_ver_id String, 
obr_universal_service_id_coding_sys_oid String, 
obr_universal_service_id_value_set_oid String, 
obr_universal_service_id_value_set_ver_id String, 
obr_universal_service_id_alt_coding_sys_oid String, 
obr_universal_service_id_alt_value_set_oid String, 
obr_universal_service_id_alt_value_set_ver_id String, 
obr_universal_service_id_second_alt_coding_sys_oid String, 
obr_universal_service_id_second_alt_value_set_oid String, 
obr_universal_service_id_second_alt_value_set_ver_id String, 
obr_priority String, 
obr_requested_date_time String, 
obr_observation_date_time String, 
obr_observation_end_date_time String, 
obr_collection_volume String, 
obr_collector_id String, 
obr_specimen_action_code String, 
obr_danger_code String, 
obr_relevant_clinical_information String, 
obr_specimen_received_date_time String, 
obr_specimen_source String, 
obr_specimen_source_name_code String, 
obr_specimen_source_additives String, 
obr_specimen_source_free_text String, 
obr_specimen_source_body_site String, 
obr_specimen_source_site_modfr String, 
obr_specimen_source_coll_method_modfr_code String, 
obr_ordering_provider String, 
obr_ordering_provider_person_id String, 
obr_ordering_provider_last_name String, 
obr_ordering_provider_first_name String, 
obr_ordering_provider_middle_name String, 
obr_ordering_provider_suffix String, 
obr_ordering_provider_prefix String, 
obr_ordering_provider_degree String, 
obr_ordering_provider_source_table String, 
obr_ordering_provider_assgn_authr String, 
obr_ordering_provider_assgn_authr_namespace_id String, 
obr_ordering_provider_assgn_authr_universal_id String, 
obr_ordering_provider_assgn_authr_universal_id_type String, 
obr_ordering_provider_name_type_code String, 
obr_ordering_provider_identifier_check_digit String, 
obr_ordering_provider_check_digit_scheme String, 
obr_ordering_provider_identifier_type_code String, 
obr_ordering_provider_assgn_facility String, 
obr_ordering_provider_name_rep_code String, 
obr_ordering_provider_name_context String, 
obr_ordering_provider_name_validity_range String, 
obr_ordering_provider_name_assembly_order String, 
obr_ordering_provider_eff_from_date_time String, 
obr_ordering_provider_eff_to_date_time String, 
obr_ordering_provider_prof_suffix String, 
obr_ordering_provider_assgn_jurisdiction String, 
obr_ordering_provider_assgn_agency_dept String, 
obr_ordering_provider_security_check String, 
obr_ordering_provider_security_check_scheme String, 
obr_order_callback_phone_num String, 
obr_placer_first_generic_field String, 
obr_placer_second_generic_field String, 
obr_filler_first_generic_field String, 
obr_filler_second_generic_field String, 
obr_results_reported_status_change_date_time String, 
obr_charge_to_practice String, 
obr_diagnostic_service_section_id String, 
obr_result_status String, 
obr_parent_result String, 
obr_qty_timing String, 
obr_qty_timing_quantity String, 
obr_qty_timing_interval String, 
obr_qty_timing_duration String, 
obr_qty_timing_start_date_time String, 
obr_qty_timing_end_date_time String, 
obr_qty_timing_priority String, 
obr_qty_timing_condition String, 
obr_qty_timing_text String, 
obr_qty_timing_conjunction String, 
obr_qty_timing_order_seq String, 
obr_qty_timing_occurrence_dur String, 
obr_qty_timing_total_occurence String, 
obr_result_copy_to String, 
obr_result_copy_to_person_id String, 
obr_result_copy_to_last_name String, 
obr_result_copy_to_first_name String, 
obr_result_copy_to_middle_name String, 
obr_result_copy_to_suffix String, 
obr_result_copy_to_prefix String, 
obr_result_copy_to_degree String, 
obr_result_copy_to_source_table String, 
obr_result_copy_to_assgn_authr String, 
obr_result_copy_to_assgn_authr_namespace_id String, 
obr_result_copy_to_assgn_authr_universal_id String, 
obr_result_copy_to_assgn_authr_universal_id_type String, 
obr_result_copy_to_name_type_code String, 
obr_result_copy_to_identifier_check_digit String, 
obr_result_copy_to_check_digit_scheme String, 
obr_result_copy_to_identifier_type_code String, 
obr_result_copy_to_assgn_facility String, 
obr_result_copy_to_name_rep_code String, 
obr_result_copy_to_name_context String, 
obr_result_copy_to_name_validity_range String, 
obr_result_copy_to_name_assembly_order String, 
obr_result_copy_to_eff_from_date_time String, 
obr_result_copy_to_eff_to_date_time String, 
obr_result_copy_to_prof_suffix String, 
obr_result_copy_to_assgn_jurisdiction String, 
obr_result_copy_to_assgn_agency_dept String, 
obr_result_copy_to_security_check String, 
obr_result_copy_to_security_check_scheme String, 
obr_parent_result_observation_id String, 
obr_transportation_mode String, 
obr_reason_for_study String, 
obr_reason_for_study_identifier String, 
obr_reason_for_study_text String, 
obr_reason_for_study_name_of_coding_sys String, 
obr_reason_for_study_alt_identifier String, 
obr_reason_for_study_alt_text String, 
obr_reason_for_study_name_of_alt_coding_sys String, 
obr_reason_for_study_coding_sys_ver_id String, 
obr_reason_for_study_alt_coding_sys_ver_id String, 
obr_reason_for_study_original_text String, 
obr_reason_for_study_second_alt_id String, 
obr_reason_for_study_second_alt_text String, 
obr_reason_for_study_name_of_second_alt_coding_sys String, 
obr_reason_for_study_second_alt_coding_sys_ver_id String, 
obr_reason_for_study_coding_sys_oid String, 
obr_reason_for_study_value_set_oid String, 
obr_reason_for_study_value_set_ver_id String, 
obr_reason_for_study_alt_coding_sys_oid String, 
obr_reason_for_study_alt_value_set_oid String, 
obr_reason_for_study_alt_value_set_ver_id String, 
obr_reason_for_study_second_alt_coding_sys_oid String, 
obr_reason_for_study_second_alt_value_set_oid String, 
obr_reason_for_study_second_alt_value_set_ver_id String, 
obr_principal_result_interpreter String, 
obr_principal_result_interpreter_name String, 
obr_principal_result_interpreter_name_person_id String, 
obr_principal_result_interpreter_name_last_name String, 
obr_principal_result_interpreter_name_first_name String, 
obr_principal_result_interpreter_name_middle_name String, 
obr_principal_result_interpreter_name_suffix String, 
obr_principal_result_interpreter_name_prefix String, 
obr_principal_result_interpreter_name_degree String, 
obr_principal_result_interpreter_name_source_table String, 
obr_principal_result_interpreter_name_assgn_authr_namespace_id String, 
obr_principal_result_interpreter_name_assgn_authr_universal_id String, 
obr_principal_result_interpreter_name_assgn_authr_universal_id_type String, 
obr_principal_result_interpreter_start_date_time String, 
obr_principal_result_interpreter_end_date_time String, 
obr_principal_result_interpreter_point_of_care String, 
obr_principal_result_interpreter_room String, 
obr_principal_result_interpreter_bed String, 
obr_principal_result_interpreter_facility String, 
obr_principal_result_interpreter_status String, 
obr_principal_result_interpreter_person_loc_type String, 
obr_principal_result_interpreter_building String, 
obr_principal_result_interpreter_floor String, 
obr_assistant_result_interpreter String, 
obr_technician String, 
obr_transcriptionist String, 
obr_transcriptionist_name String, 
obr_transcriptionist_start_date_time String, 
obr_transcriptionist_end_date_time String, 
obr_transcriptionist_point_of_care String, 
obr_transcriptionist_room String, 
obr_transcriptionist_bed String, 
obr_transcriptionist_facility String, 
obr_transcriptionist_status String, 
obr_transcriptionist_person_loc_type String, 
obr_transcriptionist_building String, 
obr_transcriptionist_floor String, 
obr_scheduled_date_time String, 
obr_sample_container String, 
obr_collected_sample_transport_logistic String, 
obr_collector_comment String, 
obr_transport_arrangement_responsibility String, 
obr_transport_arranged String, 
obr_escort_required String, 
obr_planned_patient_transport_comment String, 
obr_procedure_code String, 
obr_procedure_code_modifier String, 
obr_placer_supplemental_service_information String, 
obr_filler_supplemental_service_information String, 
obr_medically_necessary_duplicate_procedure_reason String, 
obr_result_handling String, 
obr_parent_universal_service_id String, 
obr_observation_group_id String, 
obr_parent_observation_group_id String, 
obr_alternate_placer_order_num String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED 
FIELDS TERMINATED BY '|' 
STORED AS SEQUENCEFILE 
LOCATION '/user/hive/warehouse/hl7.db/hl7_all_segment_data'; 

CREATE VIEW hl7.vw_hl7_obr_data AS
SELECT * FROM hl7.hl7_obr_data WHERE segment_type = 'OBR';

CREATE EXTERNAL TABLE hl7.hl7_cti_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
cti_sponsor_study_id String, 
cti_study_phase_id String, 
cti_study_scheduled_time_point String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED 
FIELDS TERMINATED BY '|' 
STORED AS SEQUENCEFILE 
LOCATION '/user/hive/warehouse/hl7.db/hl7_all_segment_data'; 

CREATE VIEW hl7.vw_hl7_cti_data AS
SELECT * FROM hl7.hl7_cti_data WHERE segment_type = 'CTI';

CREATE EXTERNAL TABLE hl7.hl7_dsc_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
dsc_continuation_pointer String, 
dsc_continuation_style String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED 
FIELDS TERMINATED BY '|' 
STORED AS SEQUENCEFILE 
LOCATION '/user/hive/warehouse/hl7.db/hl7_all_segment_data'; 

CREATE VIEW hl7.vw_hl7_dsc_data AS
SELECT * FROM hl7.hl7_dsc_data WHERE segment_type = 'DSC';

CREATE EXTERNAL TABLE hl7.hl7_sft_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
sft_software_vendor_organization String, 
sft_software_certified_version_release_num String, 
sft_software_product_name String, 
sft_software_binary_id String, 
sft_software_product_information String, 
sft_software_install_date String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED 
FIELDS TERMINATED BY '|' 
STORED AS SEQUENCEFILE 
LOCATION '/user/hive/warehouse/hl7.db/hl7_all_segment_data'; 

CREATE VIEW hl7.vw_hl7_sft_data AS
SELECT * FROM hl7.hl7_sft_data WHERE segment_type = 'SFT';

CREATE EXTERNAL TABLE hl7.hl7_spm_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
spm_set_id String, 
spm_specimen_id String, 
spm_specimen_id_placer_assigned_id String, 
spm_specimen_id_placer_assigned_id_entity_id String, 
spm_specimen_id_placer_assigned_id_namespace_id String, 
spm_specimen_id_placer_assigned_id_universal_id String, 
spm_specimen_id_placer_assigned_id_universal_id_type String, 
spm_specimen_id_filler_assigned_id String, 
spm_specimen_id_filler_assigned_id_entity_id String, 
spm_specimen_id_filler_assigned_id_namespace_id String, 
spm_specimen_id_filler_assigned_id_universal_id String, 
spm_specimen_id_filler_assigned_id_universal_id_type String, 
spm_specimen_parent_id String, 
spm_specimen_parent_id_placer_assigned_id String, 
spm_specimen_parent_id_filler_assigned_id String, 
spm_specimen_type String, 
spm_specimen_type_primary_id String, 
spm_specimen_type_text String, 
spm_specimen_type_name_of_coding_sys String, 
spm_specimen_type_alt_id String, 
spm_specimen_type_alt_text String, 
spm_specimen_type_name_of_alt_coding_sys String, 
spm_specimen_type_coding_sys_ver_id String, 
spm_specimen_type_alt_coding_sys_ver_id String, 
spm_specimen_type_original_text String, 
spm_specimen_type_second_alt_id String, 
spm_specimen_type_second_alt_text String, 
spm_specimen_type_name_of_second_alt_coding_sys String, 
spm_specimen_type_second_alt_coding_sys_ver_id String, 
spm_specimen_type_coding_sys_oid String, 
spm_specimen_type_value_set_oid String, 
spm_specimen_type_value_set_ver_id String, 
spm_specimen_type_alt_coding_sys_oid String, 
spm_specimen_type_alt_value_set_oid String, 
spm_specimen_type_alt_value_set_ver_id String, 
spm_specimen_type_second_alt_coding_sys_oid String, 
spm_specimen_type_second_alt_value_set_oid String, 
spm_specimen_type_second_alt_value_set_ver_id String, 
spm_specimen_type_modifier String, 
spm_specimen_additive String, 
spm_specimen_collection_method String, 
spm_specimen_collection_method_primary_id String, 
spm_specimen_collection_method_text String, 
spm_specimen_collection_method_name_of_coding_sys String, 
spm_specimen_collection_method_alt_id String, 
spm_specimen_collection_method_alt_text String, 
spm_specimen_collection_method_name_of_alt_coding_sys String, 
spm_specimen_collection_method_coding_sys_ver_id String, 
spm_specimen_collection_method_alt_coding_sys_ver_id String, 
spm_specimen_collection_method_original_text String, 
spm_specimen_collection_method_second_alt_id String, 
spm_specimen_collection_method_second_alt_text String, 
spm_specimen_collection_method_name_of_second_alt_coding_sys String, 
spm_specimen_collection_method_second_alt_coding_sys_ver_id String, 
spm_specimen_collection_method_coding_sys_oid String, 
spm_specimen_collection_method_value_set_oid String, 
spm_specimen_collection_method_value_set_ver_id String, 
spm_specimen_collection_method_alt_coding_sys_oid String, 
spm_specimen_collection_method_alt_value_set_oid String, 
spm_specimen_collection_method_alt_value_set_ver_id String, 
spm_specimen_collection_method_second_alt_coding_sys_oid String, 
spm_specimen_collection_method_second_alt_value_set_oid String, 
spm_specimen_collection_method_second_alt_value_set_ver_id String, 
spm_specimen_source_site String, 
spm_specimen_source_site_modifier String, 
spm_specimen_collection_site String, 
spm_specimen_role String, 
spm_specimen_collection_amt String, 
spm_grouped_specimen_cnt String, 
spm_specimen_desc String, 
spm_specimen_handling_code String, 
spm_specimen_risk_code String, 
spm_specimen_collection_date_time String, 
spm_specimen_received_date_time String, 
spm_specimen_expiration_date_time String, 
spm_specimen_availability String, 
spm_specimen_reject_reason String, 
spm_specimen_quality String, 
spm_specimen_appropriateness String, 
spm_specimen_condition String, 
spm_specimen_current_qty String, 
spm_specimen_containers_num String, 
spm_container_type String, 
spm_container_type_primary_id String, 
spm_container_type_text String, 
spm_container_type_name_of_coding_sys String, 
spm_container_type_alt_id String, 
spm_container_type_alt_text String, 
spm_container_type_name_of_alt_coding_sys String, 
spm_container_type_coding_sys_ver_id String, 
spm_container_type_alt_coding_sys_ver_id String, 
spm_container_type_original_text String, 
spm_container_type_second_alt_id String, 
spm_container_type_second_alt_text String, 
spm_container_type_name_of_second_alt_coding_sys String, 
spm_container_type_second_alt_coding_sys_ver_id String, 
spm_container_type_coding_sys_oid String, 
spm_container_type_value_set_oid String, 
spm_container_type_value_set_ver_id String, 
spm_container_type_alt_coding_sys_oid String, 
spm_container_type_alt_value_set_oid String, 
spm_container_type_alt_value_set_ver_id String, 
spm_container_type_second_alt_coding_sys_oid String, 
spm_container_type_second_alt_value_set_oid String, 
spm_container_type_second_alt_value_set_ver_id String, 
spm_container_condition String, 
spm_specimen_child_role String, 
spm_accession_id String, 
spm_other_specimen_id String, 
spm_shipment_id String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED 
FIELDS TERMINATED BY '|' 
STORED AS SEQUENCEFILE 
LOCATION '/user/hive/warehouse/hl7.db/hl7_all_segment_data'; 

CREATE VIEW hl7.vw_hl7_spm_data AS
SELECT * FROM hl7.hl7_spm_data WHERE segment_type = 'SPM';

CREATE EXTERNAL TABLE hl7.hl7_tq1_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
tq1_set_id String, 
tq1_qty String, 
tq1_repeat_pattern String, 
tq1_explicit_time String, 
tq1_relative_time_and_units String, 
tq1_service_duration String, 
tq1_start_date_time String, 
tq1_end_date_time String, 
tq1_priority String, 
tq1_condition_text String, 
tq1_instruction_text String, 
tq1_conjunction String, 
tq1_occurrence_duration String, 
tq1_total_occurrence String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED 
FIELDS TERMINATED BY '|' 
STORED AS SEQUENCEFILE 
LOCATION '/user/hive/warehouse/hl7.db/hl7_all_segment_data'; 

CREATE VIEW hl7.vw_hl7_tq1_data AS
SELECT * FROM hl7.hl7_tq1_data WHERE segment_type = 'TQ1';

CREATE EXTERNAL TABLE hl7.hl7_zcl_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
zcl_counter String, 
zcl_call_type String, 
zcl_call_type_type_code String, 
zcl_call_type_type_desc String, 
zcl_caller_name String, 
zcl_contact String, 
zcl_contact_person_id String, 
zcl_contact_type_code String, 
zcl_filed_information String, 
zcl_filed_information_file_date_time String, 
zcl_filed_information_person_id String, 
zcl_filed_information_type_code String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED 
FIELDS TERMINATED BY '|' 
STORED AS SEQUENCEFILE 
LOCATION '/user/hive/warehouse/hl7.db/hl7_all_segment_data'; 

CREATE VIEW hl7.vw_hl7_zcl_data AS
SELECT * FROM hl7.hl7_zcl_data WHERE segment_type = 'ZCL';

CREATE EXTERNAL TABLE hl7.hl7_zer_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
zer_expected_arrival_date_time String, 
zer_arrival_date_time String, 
zer_triage_date_time String, 
zer_mpi_search String, 
zer_complaint String, 
zer_complaint_complaint_code String, 
zer_complaint_complaint_desc String, 
zer_priority String, 
zer_priority_priority_code String, 
zer_priority_priority_name String, 
zer_priority_priority_rank String, 
zer_location String, 
zer_location_location_code String, 
zer_location_location_name String, 
zer_room_treatment String, 
zer_room_treatment_room_treatment_code String, 
zer_room_treatment_room_treatment_name String, 
zer_wait_list String, 
zer_wait_list_wait_list_code String, 
zer_wait_list_wait_list_description String, 
zer_wait_list_wait_list_number String, 
zer_current_status_event String, 
zer_current_status_event_event_code String, 
zer_current_status_event_event_desc String, 
zer_nurse_id String, 
zer_practitioner_id String, 
zer_departure_information String, 
zer_departure_information_departure_date String, 
zer_departure_information_disposition String, 
zer_departure_information_disposition_code String, 
zer_departure_information_disposition_description String, 
zer_departure_information_condition String, 
zer_departure_information_condition_code String, 
zer_departure_information_condition_description String, 
zer_departure_information_departure_comment String, 
zer_departure_information_impression_urn String, 
zer_ambulance_company String, 
zer_ambulance_company_ambulance_company String, 
zer_ambulance_company_ambulance_company_mnem String, 
zer_ambulance_company_ambulance_company_name String, 
zer_ambulance_company_ambulance_company_id String, 
zer_ambulance_company_call_date_time String, 
zer_estimated_time_of_arrival String, 
zer_reserved_room_treatment String, 
zer_reserved_room_treatment_room_treatment_code String, 
zer_reserved_room_treatment_room_treatment_name String, 
zer_assessment String, 
zer_assessment_assessment String, 
zer_assessment_assessment_code String, 
zer_assessment_assessment_description String, 
zer_assessment_assessment_date_time String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED 
FIELDS TERMINATED BY '|' 
STORED AS SEQUENCEFILE 
LOCATION '/user/hive/warehouse/hl7.db/hl7_all_segment_data'; 

CREATE VIEW hl7.vw_hl7_zer_data AS
SELECT * FROM hl7.hl7_zer_data WHERE segment_type = 'ZER';

CREATE EXTERNAL TABLE hl7.hl7_zsi_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
zsi_set_id String, 
zsi_indicator_id String, 
zsi_indicator_information String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED 
FIELDS TERMINATED BY '|' 
STORED AS SEQUENCEFILE 
LOCATION '/user/hive/warehouse/hl7.db/hl7_all_segment_data'; 

CREATE VIEW hl7.vw_hl7_zsi_data AS
SELECT * FROM hl7.hl7_zsi_data WHERE segment_type = 'ZSI';

CREATE EXTERNAL TABLE hl7.hl7_zds_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,  
zds_study_instance String, 
zds_study_instance_reference_pointer String, 
zds_study_instance_application_id String, 
zds_study_instance_data_type String, 
zds_study_instance_subtype String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED 
FIELDS TERMINATED BY '|' 
STORED AS SEQUENCEFILE 
LOCATION '/user/hive/warehouse/hl7.db/hl7_all_segment_data'; 

CREATE VIEW hl7.vw_hl7_zds_data AS
SELECT * FROM hl7.hl7_zds_data WHERE segment_type = 'ZDS';