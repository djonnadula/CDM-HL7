USE hl7;

DROP TABLE hl7_dg1_data;

CREATE EXTERNAL TABLE hl7_dg1_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
dg1_set_id STRING,
dg1_diagnosis_coding_method STRING,
dg1_diagnosis_code STRING,
dg1_diagnosis_code_primary_id STRING,
dg1_diagnosis_code_text STRING,
dg1_diagnosis_code_name_of_coding_sys STRING,
dg1_diagnosis_code_alt_id STRING,
dg1_diagnosis_code_alt_text STRING,
dg1_diagnosis_code_name_of_alt_coding_sys STRING,
dg1_diagnosis_code_coding_sys_ver_id STRING,
dg1_diagnosis_code_alt_coding_sys_ver_id STRING,
dg1_diagnosis_code_original_text STRING,
dg1_diagnosis_code_second_alt_id STRING,
dg1_diagnosis_code_second_alt_text STRING,
dg1_diagnosis_code_name_of_second_alt_coding_sys STRING,
dg1_diagnosis_code_second_alt_coding_sys_ver_id STRING,
dg1_diagnosis_code_coding_sys_oid STRING,
dg1_diagnosis_code_value_set_oid STRING,
dg1_diagnosis_code_value_set_ver_id STRING,
dg1_diagnosis_code_alt_coding_sys_oid STRING,
dg1_diagnosis_code_alt_value_set_oid STRING,
dg1_diagnosis_code_alt_value_set_ver_id STRING,
dg1_diagnosis_code_second_alt_coding_sys_oid STRING,
dg1_diagnosis_code_second_alt_value_set_oid STRING,
dg1_diagnosis_code_second_alt_value_set_ver_id STRING,
dg1_diagnosis_desc STRING,
dg1_diagnosis_date_time STRING,
dg1_diagnosis_type STRING,
dg1_major_diagnostic_category STRING,
dg1_diagnostic_related_group STRING,
dg1_drg_approval_ind STRING,
dg1_drg_grouper_review_code STRING,
dg1_outlier_type STRING,
dg1_bill_amt STRING,
dg1_outlier_day STRING,
dg1_total_charge_amt STRING,
dg1_outlier_cost STRING,
dg1_grouper_version_type STRING,
dg1_diagnosis_priority STRING,
dg1_diagnosing_clinician STRING,
dg1_diagnosis_classification STRING,
dg1_confidential_ind STRING,
dg1_attestation_date_time STRING,
dg1_diagnosis_id STRING,
dg1_diagnosis_action_code STRING,
dg1_parent_diagnosis STRING,
dg1_drg_ccl_value_code STRING,
dg1_drg_grouping_usage STRING,
dg1_drg_diagnosis_determination_status STRING,
dg1_present_on_admission_ind STRING,
etl_firstinsert_datetime STRING,
field_sequence_num STRING
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS SEQUENCEFILE
LOCATION '/user/hive/warehouse/hl7.db/hl7_all_segment_data';