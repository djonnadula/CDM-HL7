use hl7;

CREATE EXTERNAL TABLE hl7_arv_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
arv_set_id String,
arv_access_restriction_action_code String,
arv_access_restriction_value String,
arv_access_restriction_reason String,
arv_special_access_restriction_instruction String,
arv_access_restriction_date_range String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS SEQUENCEFILE
LOCATION '/user/hive/warehouse/hl7/hl7_all_segment_data';

CREATE VIEW vw_hl7_arv_data AS SELECT * FROM hl7_arv_data WHERE segment_type='ARV';

CREATE EXTERNAL TABLE hl7_blg_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
blg_when_to_charge String,
blg_charge_type_reason_text String,
blg_account_id String,
blg_charge_type_reason String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS SEQUENCEFILE
LOCATION '/user/hive/warehouse/hl7/hl7_all_segment_data';

CREATE VIEW vw_hl7_blg_data AS SELECT * FROM hl7_blg_data WHERE segment_type='BLG';

CREATE EXTERNAL TABLE hl7_ft1_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
ft1_set_id String,
ft1_transaction_id String,
ft1_transaction_batch_id String,
ft1_transaction_date String,
ft1_transaction_posting_date_time String,
ft1_transaction_type String,
ft1_transaction_code String,
ft1_transaction_desc String,
ft1_transaction_alternate_desc String,
ft1_transaction_qty String,
ft1_transaction_extended_amt String,
ft1_transaction_unit_amt String,
ft1_department_code String,
ft1_insurance_plan_id String,
ft1_insurance_amt String,
ft1_assigned_patient_location String,
ft1_fee_schedule String,
ft1_patient_type String,
ft1_diagnosis_code String,
ft1_performed_by_code String,
ft1_ordered_by_code String,
ft1_unit_cost String,
ft1_filler_order_num String,
ft1_entered_by_code String,
ft1_procedure_code String,
ft1_procedure_code_modifier String,
ft1_advanced_beneficiary_notice_code String,
ft1_medically_necessary_duplicate_procedure_reason String,
ft1_ndc_code String,
ft1_payment_reference_id String,
ft1_transaction_reference_key String,
ft1_performing_facility String,
ft1_ordering_facility String,
ft1_item_num String,
ft1_model_num String,
ft1_special_processing_code String,
ft1_clinic_code String,
ft1_referral_num String,
ft1_authr_num String,
ft1_service_provider_taxonomy_code String,
ft1_revenue_code String,
ft1_prescription_num String,
ft1_ndc_qty_and_unit_of_measurement String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS SEQUENCEFILE
LOCATION '/user/hive/warehouse/hl7/hl7_all_segment_data';

CREATE VIEW vw_hl7_ft1_data AS SELECT * FROM hl7_ft1_data WHERE segment_type='FT1';

CREATE EXTERNAL TABLE hl7_prt_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
prt_participation_instance_id String,
prt_action_code String,
prt_action_reason String,
prt_participation String,
prt_participation_person_name String,
prt_participation_person_provider_type String,
prt_participant_organization_unit_type String,
prt_participation_organization_name String,
prt_participation_location String,
prt_participation_device String,
prt_participation_begin_date_time String,
prt_participation_end_date_time String,
prt_participation_qualitative_duration String,
prt_participation_address String,
prt_participation_telecom_address String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS SEQUENCEFILE
LOCATION '/user/hive/warehouse/hl7/hl7_all_segment_data';

CREATE VIEW vw_hl7_prt_data AS SELECT * FROM hl7_prt_data WHERE segment_type='PRT';

CREATE EXTERNAL TABLE hl7_rxa_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
rxa_give_sub_id_counter String,
rxa_administration_sub_id_counter String,
rxa_administration_start_date_time String,
rxa_administration_end_date_time String,
rxa_administered_code String,
rxa_administered_code_primary_id String,
rxa_administered_code_text String,
rxa_administered_code_name_of_coding_sys String,
rxa_administered_code_alt_id String,
rxa_administered_code_alt_text String,
rxa_administered_code_name_of_alt_coding_sys String,
rxa_administered_code_coding_sys_ver_id String,
rxa_administered_code_alt_coding_sys_ver_id String,
rxa_administered_code_original_text String,
rxa_administered_code_second_alt_id String,
rxa_administered_code_second_alt_text String,
rxa_administered_code_name_of_second_alt_coding_sys String,
rxa_administered_code_second_alt_coding_sys_ver_id String,
rxa_administered_code_coding_sys_oid String,
rxa_administered_code_value_set_oid String,
rxa_administered_code_value_set_ver_id String,
rxa_administered_code_alt_coding_sys_oid String,
rxa_administered_code_alt_value_set_oid String,
rxa_administered_code_alt_value_set_ver_id String,
rxa_administered_code_second_alt_coding_sys_oid String,
rxa_administered_code_second_alt_value_set_oid String,
rxa_administered_code_second_alt_value_set_ver_id String,
rxa_administered_amt String,
rxa_administered_unit String,
rxa_administered_dosage_form String,
rxa_administered_dosage_form_primary_id String,
rxa_administered_dosage_form_text String,
rxa_administered_dosage_form_name_of_coding_sys String,
rxa_administered_dosage_form_alt_id String,
rxa_administered_dosage_form_alt_text String,
rxa_administered_dosage_form_name_of_alt_coding_sys String,
rxa_administered_dosage_form_coding_sys_ver_id String,
rxa_administered_dosage_form_alt_coding_sys_ver_id String,
rxa_administered_dosage_form_original_text String,
rxa_administered_dosage_form_second_alt_id String,
rxa_administered_dosage_form_second_alt_text String,
rxa_administered_dosage_form_name_of_second_alt_coding_sys String,
rxa_administered_dosage_form_second_alt_coding_sys_ver_id String,
rxa_administered_dosage_form_coding_sys_oid String,
rxa_administered_dosage_form_value_set_oid String,
rxa_administered_dosage_form_value_set_ver_id String,
rxa_administered_dosage_form_alt_coding_sys_oid String,
rxa_administered_dosage_form_alt_value_set_oid String,
rxa_administered_dosage_form_alt_value_set_ver_id String,
rxa_administered_dosage_form_second_alt_coding_sys_oid String,
rxa_administered_dosage_form_second_alt_value_set_oid String,
rxa_administered_dosage_form_second_alt_value_set_ver_id String,
rxa_administration_note String,
rxa_administration_note_primary_id String,
rxa_administration_note_text String,
rxa_administration_note_name_of_coding_sys String,
rxa_administration_note_alt_id String,
rxa_administration_note_alt_text String,
rxa_administration_note_name_of_alt_coding_sys String,
rxa_administration_note_coding_sys_ver_id String,
rxa_administration_note_alt_coding_sys_ver_id String,
rxa_administration_note_original_text String,
rxa_administration_note_second_alt_id String,
rxa_administration_note_second_alt_text String,
rxa_administration_note_name_of_second_alt_coding_sys String,
rxa_administration_note_second_alt_coding_sys_ver_id String,
rxa_administration_note_coding_sys_oid String,
rxa_administration_note_value_set_oid String,
rxa_administration_note_value_set_ver_id String,
rxa_administration_note_alt_coding_sys_oid String,
rxa_administration_note_alt_value_set_oid String,
rxa_administration_note_alt_value_set_ver_id String,
rxa_administration_note_second_alt_coding_sys_oid String,
rxa_administration_note_second_alt_value_set_oid String,
rxa_administration_note_second_alt_value_set_ver_id String,
rxa_administering_provider String,
rxa_administering_provider_person_id String,
rxa_administering_provider_last_name String,
rxa_administering_provider_first_name String,
rxa_administering_provider_middle_name String,
rxa_administering_provider_suffix String,
rxa_administering_provider_person_prefix String,
rxa_administering_provider_degree String,
rxa_administering_provider_source_table String,
rxa_administering_provider_assgn_authr String,
rxa_administering_provider_assgn_authr_namespace_id String,
rxa_administering_provider_assgn_authr_universal_id String,
rxa_administering_provider_assgn_authr_universal_id_type String,
rxa_administering_provider_name_type_code String,
rxa_administering_provider_identifier_check_digit String,
rxa_administering_provider_check_digit_scheme String,
rxa_administering_provider_identifier_type_code String,
rxa_administering_provider_assgn_facility String,
rxa_administering_provider_name_rep_code String,
rxa_administering_provider_context String,
rxa_administering_provider_validity_range String,
rxa_administering_provider_assembly_order String,
rxa_administering_provider_eff_from_date_time String,
rxa_administering_provider_eff_to_date_time String,
rxa_administering_provider_prof_suffix String,
rxa_administering_provider_assgn_jurisdiction String,
rxa_administering_provider_assgn_agency_dept String,
rxa_administering_provider_security_check String,
rxa_administering_provider_security_check_scheme String,
rxa_administered_at_location String,
rxa_administered_at_location_point_of_care String,
rxa_administered_at_location_room String,
rxa_administered_at_location_bed String,
rxa_administered_at_location_facility String,
rxa_administered_at_location_status String,
rxa_administered_at_location_person_loc_type String,
rxa_administered_at_location_building String,
rxa_administered_at_location_loc_floor String,
rxa_administered_at_location_street_address1 String,
rxa_administered_at_location_street_address2 String,
rxa_administered_at_location_city String,
rxa_administered_at_location_state_province String,
rxa_administered_at_location_zip_postal_code String,
rxa_administered_at_location_country String,
rxa_administered_at_location_address_type String,
rxa_administered_at_location_other_geo_designation String,
rxa_administered_per_time_unit String,
rxa_administered_strength String,
rxa_administered_strength_unit String,
rxa_substance_lot_num String,
rxa_substance_expiration_date String,
rxa_substance_manufacturer_name String,
rxa_substance_treatment_refusal_reason String,
rxa_indication String,
rxa_indication_primary_id String,
rxa_indication_text String,
rxa_indication_name_of_coding_sys String,
rxa_indication_alt_id String,
rxa_indication_alt_text String,
rxa_indication_name_of_alt_coding_sys String,
rxa_indication_coding_sys_ver_id String,
rxa_indication_alt_coding_sys_ver_id String,
rxa_indication_original_text String,
rxa_indication_second_alt_id String,
rxa_indication_second_alt_text String,
rxa_indication_name_of_second_alt_coding_sys String,
rxa_indication_second_alt_coding_sys_ver_id String,
rxa_indication_coding_sys_oid String,
rxa_indication_value_set_oid String,
rxa_indication_value_set_ver_id String,
rxa_indication_alt_coding_sys_oid String,
rxa_indication_alt_value_set_oid String,
rxa_indication_alt_value_set_ver_id String,
rxa_indication_second_alt_coding_sys_oid String,
rxa_indication_second_alt_value_set_oid String,
rxa_indication_second_alt_value_set_ver_id String,
rxa_completion_status String,
rxa_action_code String,
rxa_sys_entry_date_time String,
rxa_administered_drug_strength_volume String,
rxa_administered_drug_strength_volume_unit String,
rxa_administered_barcode_id String,
rxa_administered_barcode_id_primary_id String,
rxa_administered_barcode_id_text String,
rxa_administered_barcode_id_name_of_coding_sys String,
rxa_administered_barcode_id_alt_id String,
rxa_administered_barcode_id_alt_text String,
rxa_administered_barcode_id_name_of_alt_coding_sys String,
rxa_administered_barcode_id_coding_sys_ver_id String,
rxa_administered_barcode_id_alt_coding_sys_ver_id String,
rxa_administered_barcode_id_original_text String,
rxa_administered_barcode_id_second_alt_id String,
rxa_administered_barcode_id_second_alt_text String,
rxa_administered_barcode_id_name_of_second_alt_coding_sys String,
rxa_administered_barcode_id_second_alt_coding_sys_ver_id String,
rxa_administered_barcode_id_coding_sys_oid String,
rxa_administered_barcode_id_value_set_oid String,
rxa_administered_barcode_id_value_set_ver_id String,
rxa_administered_barcode_id_alt_coding_sys_oid String,
rxa_administered_barcode_id_alt_value_set_oid String,
rxa_administered_barcode_id_alt_value_set_ver_id String,
rxa_administered_barcode_id_second_alt_coding_sys_oid String,
rxa_administered_barcode_id_second_alt_value_set_oid String,
rxa_administered_barcode_id_second_alt_value_set_ver_id String,
rxa_pharmacy_order_type String,
rxa_administered_at String,
rxa_administered_at_address String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS SEQUENCEFILE
LOCATION '/user/hive/warehouse/hl7/hl7_all_segment_data';

CREATE VIEW vw_hl7_rxa_data AS SELECT * FROM hl7_rxa_data WHERE segment_type='RXA';

CREATE EXTERNAL TABLE hl7_rxc_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
rxc_rx_component_type String,
rxc_component_code String,
rxc_component_code_primary_id String,
rxc_component_code_text String,
rxc_component_code_name_of_coding_sys String,
rxc_component_code_alt_id String,
rxc_component_code_alt_text String,
rxc_component_code_name_of_alt_coding_sys String,
rxc_component_code_coding_sys_ver_id String,
rxc_component_code_alt_coding_sys_ver_id String,
rxc_component_code_original_text String,
rxc_component_code_second_alt_id String,
rxc_component_code_second_alt_text String,
rxc_component_code_name_of_second_alt_coding_sys String,
rxc_component_code_second_alt_coding_sys_ver_id String,
rxc_component_code_coding_sys_oid String,
rxc_component_code_value_set_oid String,
rxc_component_code_value_set_ver_id String,
rxc_component_code_alt_coding_sys_oid String,
rxc_component_code_alt_value_set_oid String,
rxc_component_code_alt_value_set_ver_id String,
rxc_component_code_second_alt_coding_sys_oid String,
rxc_component_code_second_alt_value_set_oid String,
rxc_component_code_second_alt_value_set_ver_id String,
rxc_component_amt String,
rxc_component_unit String,
rxc_component_strength String,
rxc_component_strength_unit String,
rxc_supplementary_code String,
rxc_component_drug_strength_volume String,
rxc_component_drug_strength_volume_unit String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS SEQUENCEFILE
LOCATION '/user/hive/warehouse/hl7/hl7_all_segment_data';

CREATE VIEW vw_hl7_rxc_data AS SELECT * FROM hl7_rxc_data WHERE segment_type='RXC';

CREATE EXTERNAL TABLE hl7_rxe_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
rxe_qty_timing String,
rxe_give_code String,
rxe_give_code_primary_id String,
rxe_give_code_text String,
rxe_give_code_name_of_coding_sys String,
rxe_give_code_alt_id String,
rxe_give_code_alt_text String,
rxe_give_code_name_of_alt_coding_sys String,
rxe_give_code_coding_sys_ver_id String,
rxe_give_code_alt_coding_sys_ver_id String,
rxe_give_code_original_text String,
rxe_give_code_second_alt_id String,
rxe_give_code_second_alt_text String,
rxe_give_code_name_of_second_alt_coding_sys String,
rxe_give_code_second_alt_coding_sys_ver_id String,
rxe_give_code_coding_sys_oid String,
rxe_give_code_value_set_oid String,
rxe_give_code_value_set_ver_id String,
rxe_give_code_alt_coding_sys_oid String,
rxe_give_code_alt_value_set_oid String,
rxe_give_code_alt_value_set_ver_id String,
rxe_give_code_second_alt_coding_sys_oid String,
rxe_give_code_second_alt_value_set_oid String,
rxe_give_code_second_alt_value_set_ver_id String,
rxe_give_minimum_amt String,
rxe_give_maximum_amt String,
rxe_give_unit String,
rxe_give_unit_primary_id String,
rxe_give_unit_text String,
rxe_give_unit_name_of_coding_sys String,
rxe_give_unit_alt_id String,
rxe_give_unit_alt_text String,
rxe_give_unit_name_of_alt_coding_sys String,
rxe_give_unit_coding_sys_ver_id String,
rxe_give_unit_alt_coding_sys_ver_id String,
rxe_give_unit_original_text String,
rxe_give_unit_second_alt_id String,
rxe_give_unit_second_alt_text String,
rxe_give_unit_name_of_second_alt_coding_sys String,
rxe_give_unit_second_alt_coding_sys_ver_id String,
rxe_give_unit_coding_sys_oid String,
rxe_give_unit_value_set_oid String,
rxe_give_unit_value_set_ver_id String,
rxe_give_unit_alt_coding_sys_oid String,
rxe_give_unit_alt_value_set_oid String,
rxe_give_unit_alt_value_set_ver_id String,
rxe_give_unit_second_alt_coding_sys_oid String,
rxe_give_unit_second_alt_value_set_oid String,
rxe_give_unit_second_alt_value_set_ver_id String,
rxe_give_dosage_form String,
rxe_provider_administration_instruction String,
rxe_provider_administration_instruction_primary_id String,
rxe_provider_administration_instruction_text String,
rxe_provider_administration_instruction_name_of_coding_sys String,
rxe_provider_administration_instruction_alt_id String,
rxe_provider_administration_instruction_alt_text String,
rxe_provider_administration_instruction_name_of_alt_coding_sys String,
rxe_provider_administration_instruction_coding_sys_ver_id String,
rxe_provider_administration_instruction_alt_coding_sys_ver_id String,
rxe_provider_administration_instruction_original_text String,
rxe_provider_administration_instruction_second_alt_id String,
rxe_provider_administration_instruction_second_alt_text String,
rxe_provider_administration_instruction_name_of_second_alt_coding_sys String,
rxe_provider_administration_instruction_second_alt_coding_sys_ver_id String,
rxe_provider_administration_instruction_coding_sys_oid String,
rxe_provider_administration_instruction_value_set_oid String,
rxe_provider_administration_instruction_value_set_ver_id String,
rxe_provider_administration_instruction_alt_coding_sys_oid String,
rxe_provider_administration_instruction_alt_value_set_oid String,
rxe_provider_administration_instruction_alt_value_set_ver_id String,
rxe_provider_administration_instruction_second_alt_coding_sys_oid String,
rxe_provider_administration_instruction_second_alt_value_set_oid String,
rxe_provider_administration_instruction_second_alt_value_set_ver_id String,
rxe_deliver_to_location String,
rxe_substitution_status String,
rxe_dispense_amt String,
rxe_dispense_unit String,
rxe_num_of_refill String,
rxe_ordering_provider_dea_num String,
rxe_pharmacist_treatment_supplier_verifier_id String,
rxe_prescription_num String,
rxe_num_of_refills_remaining String,
rxe_num_of_refill_dose_dispensed String,
rxe_most_recent_refill_dose_dispensed_date_time String,
rxe_total_daily_dose String,
rxe_needs_human_review String,
rxe_special_dispense_instruction String,
rxe_special_dispense_instruction_primary_id String,
rxe_special_dispense_instruction_text String,
rxe_special_dispense_instruction_name_of_coding_sys String,
rxe_special_dispense_instruction_alt_id String,
rxe_special_dispense_instruction_alt_text String,
rxe_special_dispense_instruction_name_of_alt_coding_sys String,
rxe_special_dispense_instruction_coding_sys_ver_id String,
rxe_special_dispense_instruction_alt_coding_sys_ver_id String,
rxe_special_dispense_instruction_original_text String,
rxe_special_dispense_instruction_second_alt_id String,
rxe_special_dispense_instruction_second_alt_text String,
rxe_special_dispense_instruction_name_of_second_alt_coding_sys String,
rxe_special_dispense_instruction_second_alt_coding_sys_ver_id String,
rxe_special_dispense_instruction_coding_sys_oid String,
rxe_special_dispense_instruction_value_set_oid String,
rxe_special_dispense_instruction_value_set_ver_id String,
rxe_special_dispense_instruction_alt_coding_sys_oid String,
rxe_special_dispense_instruction_alt_value_set_oid String,
rxe_special_dispense_instruction_alt_value_set_ver_id String,
rxe_special_dispense_instruction_second_alt_coding_sys_oid String,
rxe_special_dispense_instruction_second_alt_value_set_oid String,
rxe_special_dispense_instruction_second_alt_value_set_ver_id String,
rxe_give_per_time_unit String,
rxe_give_rate_amt String,
rxe_give_rate_unit String,
rxe_give_strength String,
rxe_give_strength_unit String,
rxe_give_indication String,
rxe_dispense_package_size String,
rxe_dispense_package_size_unit String,
rxe_dispense_package_method String,
rxe_supplementary_code String,
rxe_original_order_date_time String,
rxe_give_drug_strength_volume String,
rxe_give_drug_strength_volume_unit String,
rxe_controlled_substance_schedule String,
rxe_formulary_status String,
rxe_pharmaceutical_substance_alternative String,
rxe_pharmacy_of_most_recent_fill String,
rxe_initial_dispense_amt String,
rxe_dispensing_pharmacy String,
rxe_dispensing_pharmacy_address String,
rxe_deliver_to_patient_location String,
rxe_deliver_to_address String,
rxe_pharmacy_order_type String,
rxe_pharmacy_phone_num String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS SEQUENCEFILE
LOCATION '/user/hive/warehouse/hl7/hl7_all_segment_data';

CREATE VIEW vw_hl7_rxe_data AS SELECT * FROM hl7_rxe_data WHERE segment_type='RXE';

CREATE EXTERNAL TABLE hl7_rxo_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
rxo_requested_give_code String,
rxo_requested_give_minimum_amt String,
rxo_requested_give_maximum_amt String,
rxo_requested_give_unit String,
rxo_requested_dosage_form String,
rxo_provider_pharmacy_treatment_instruction String,
rxo_provider_administration_instruction String,
rxo_deliver_to_location String,
rxo_allow_substitution String,
rxo_requested_dispense_code String,
rxo_requested_dispense_amt String,
rxo_requested_dispense_unit String,
rxo_num_of_refill String,
rxo_ordering_provider_dea_num String,
rxo_pharmacist_treatment_supplier_verifier_id String,
rxo_human_review String,
rxo_requested_give_per_time_unit String,
rxo_requested_give_strength String,
rxo_requested_give_strength_unit String,
rxo_indication String,
rxo_requested_give_rate_amt String,
rxo_requested_give_rate_unit String,
rxo_total_daily_dose String,
rxo_supplementary_code String,
rxo_requested_drug_strength_volume String,
rxo_requested_drug_strength_volume_unit String,
rxo_pharmacy_order_type String,
rxo_dispensing_interval String,
rxo_medication_instance_id String,
rxo_segment_instance_id String,
rxo_mood_code String,
rxo_dispensing_pharmacy String,
rxo_dispensing_pharmacy_address String,
rxo_deliver_to_patient_location String,
rxo_deliver_to_address String,
rxo_pharmacy_phone_num String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS SEQUENCEFILE
LOCATION '/user/hive/warehouse/hl7/hl7_all_segment_data';

CREATE VIEW vw_hl7_rxo_data AS SELECT * FROM hl7_rxo_data WHERE segment_type='RXO';

CREATE EXTERNAL TABLE hl7_rxr_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
rxr_route String,
rxr_route_primary_id String,
rxr_route_text String,
rxr_route_name_of_coding_sys String,
rxr_route_alt_id String,
rxr_route_alt_text String,
rxr_route_name_of_alt_coding_sys String,
rxr_route_coding_sys_ver_id String,
rxr_route_alt_coding_sys_ver_id String,
rxr_route_original_text String,
rxr_route_second_alt_id String,
rxr_route_second_alt_text String,
rxr_route_name_of_second_alt_coding_sys String,
rxr_route_second_alt_coding_sys_ver_id String,
rxr_route_coding_sys_oid String,
rxr_route_value_set_oid String,
rxr_route_value_set_ver_id String,
rxr_route_alt_coding_sys_oid String,
rxr_route_alt_value_set_oid String,
rxr_route_alt_value_set_ver_id String,
rxr_route_second_alt_coding_sys_oid String,
rxr_route_second_alt_value_set_oid String,
rxr_route_second_alt_value_set_ver_id String,
rxr_administration_site String,
rxr_administration_device String,
rxr_administration_method String,
rxr_administration_method_primary_id String,
rxr_administration_method_text String,
rxr_administration_method_name_of_coding_sys String,
rxr_administration_method_alt_id String,
rxr_administration_method_alt_text String,
rxr_administration_method_name_of_alt_coding_sys String,
rxr_administration_method_coding_sys_ver_id String,
rxr_administration_method_alt_coding_sys_ver_id String,
rxr_administration_method_original_text String,
rxr_administration_method_second_alt_id String,
rxr_administration_method_second_alt_text String,
rxr_administration_method_name_of_second_alt_coding_sys String,
rxr_administration_method_second_alt_coding_sys_ver_id String,
rxr_administration_method_coding_sys_oid String,
rxr_administration_method_value_set_oid String,
rxr_administration_method_value_set_ver_id String,
rxr_administration_method_alt_coding_sys_oid String,
rxr_administration_method_alt_value_set_oid String,
rxr_administration_method_alt_value_set_ver_id String,
rxr_administration_method_second_alt_coding_sys_oid String,
rxr_administration_method_second_alt_value_set_oid String,
rxr_administration_method_second_alt_value_set_ver_id String,
rxr_routing_instruction String,
rxr_administration_site_modifier String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS SEQUENCEFILE
LOCATION '/user/hive/warehouse/hl7/hl7_all_segment_data';

CREATE VIEW vw_hl7_rxr_data AS SELECT * FROM hl7_rxr_data WHERE segment_type='RXR';

CREATE EXTERNAL TABLE hl7_tq2_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
tq2_set_id String,
tq2_sequence_results_flag String,
tq2_related_placer_num String,
tq2_related_filler_num String,
tq2_related_placer_group_num String,
tq2_sequence_condition_code String,
tq2_cyclic_entry_exit_ind String,
tq2_sequence_condition_time_interval String,
tq2_cyclic_group_maximum_repeat_num String,
tq2_special_service_request_relationship String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS SEQUENCEFILE
LOCATION '/user/hive/warehouse/hl7/hl7_all_segment_data';

CREATE VIEW vw_hl7_tq2_data AS SELECT * FROM hl7_tq2_data WHERE segment_type='TQ2';

CREATE EXTERNAL TABLE hl7_uac_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
uac_user_authentication_credential_type_code String,
uac_user_authentication_credential String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS SEQUENCEFILE
LOCATION '/user/hive/warehouse/hl7/hl7_all_segment_data';

CREATE VIEW vw_hl7_uac_data AS SELECT * FROM hl7_uac_data WHERE segment_type='UAC';

create external table hl7_cdo_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
cdo_set_id STRING,
cdo_action_code STRING,
cdo_cumulative_dosage_limit STRING,
cdo_cumulative_dosage_limit_quantity STRING,
cdo_cumulative_dosage_limit_units STRING,
cdo_cumulative_dosage_limit_units_primary_id STRING,
cdo_cumulative_dosage_limit_units_text STRING,
cdo_cumulative_dosage_limit_units_name_of_coding_sys STRING,
cdo_cumulative_dosage_limit_units_alt_identifier STRING,
cdo_cumulative_dosage_limit_units_alt_text STRING,
cdo_cumulative_dosage_limit_units_name_of_alt_coding_sys STRING,
cdo_cumulative_dosage_limit_units_coding_sys_ver_id STRING,
cdo_cumulative_dosage_limit_units_alt_coding_sys_ver_id STRING,
cdo_cumulative_dosage_limit_units_original_text STRING,
cdo_cumulative_dosage_limit_units_second_alt_id STRING,
cdo_cumulative_dosage_limit_units_second_alt_text STRING,
cdo_cumulative_dosage_limit_units_name_of_second_alt_coding_sys STRING,
cdo_cumulative_dosage_limit_units_second_alt_coding_sys_ver_id STRING,
cdo_cumulative_dosage_limit_units_coding_sys_oid STRING,
cdo_cumulative_dosage_limit_units_value_set_oid STRING,
cdo_cumulative_dosage_limit_units_value_set_ver_id STRING,
cdo_cumulative_dosage_limit_units_alt_coding_sys_oid STRING,
cdo_cumulative_dosage_limit_units_alt_value_set_oid STRING,
cdo_cumulative_dosage_limit_units_alt_value_set_ver_id STRING,
cdo_cumulative_dosage_limit_units_second_alt_coding_sys_oid STRING,
cdo_cumulative_dosage_limit_units_second_alt_value_set_oid STRING,
cdo_cumulative_dosage_limit_units_second_alt_value_set_ver_id STRING,
cdo_cumulative_dosage_limit_time_interval STRING,
cdo_cumulative_dosage_limit_time_interval_quantity STRING,
cdo_cumulative_dosage_limit_time_interval_units STRING,
cdo_cumulative_dosage_limit_time_interval_units_primary_id STRING,
cdo_cumulative_dosage_limit_time_interval_units_text STRING,
cdo_cumulative_dosage_limit_time_interval_units_name_of_coding_sys STRING,
cdo_cumulative_dosage_limit_time_interval_units_alt_identifier STRING,
cdo_cumulative_dosage_limit_time_interval_units_alt_text STRING,
cdo_cumulative_dosage_limit_time_interval_units_name_of_alt_coding_sys STRING,
cdo_cumulative_dosage_limit_time_interval_units_coding_sys_ver_id STRING,
cdo_cumulative_dosage_limit_time_interval_units_alt_coding_sys_ver_id STRING,
cdo_cumulative_dosage_limit_time_interval_units_original_text STRING,
cdo_cumulative_dosage_limit_time_interval_units_second_alt_id STRING,
cdo_cumulative_dosage_limit_time_interval_units_second_alt_text STRING,
cdo_cumulative_dosage_limit_time_interval_units_name_of_second_alt_coding_sys STRING,
cdo_cumulative_dosage_limit_time_interval_units_second_alt_coding_sys_ver_id STRING,
cdo_cumulative_dosage_limit_time_interval_units_coding_sys_oid STRING,
cdo_cumulative_dosage_limit_time_interval_units_value_set_oid STRING,
cdo_cumulative_dosage_limit_time_interval_units_value_set_ver_id STRING,
cdo_cumulative_dosage_limit_time_interval_units_alt_coding_sys_oid STRING,
cdo_cumulative_dosage_limit_time_interval_units_alt_value_set_oid STRING,
cdo_cumulative_dosage_limit_time_interval_units_alt_value_set_ver_id STRING,
cdo_cumulative_dosage_limit_time_interval_units_second_alt_coding_sys_oid STRING,
cdo_cumulative_dosage_limit_time_interval_units_second_alt_value_set_oid STRING,
cdo_cumulative_dosage_limit_time_interval_units_second_alt_value_set_ver_id STRING,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS SEQUENCEFILE
LOCATION '/user/hive/warehouse/hl7/hl7_all_segment_data';

CREATE VIEW vw_hl7_cdo_data AS SELECT * FROM hl7_cdo_data WHERE segment_type='CDO';

create external table hl7_rxv_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
rxv_set_id STRING,
rxv_bolus_type STRING,
rxv_bolus_dose_amount STRING,
rxv_bolus_dose_amount_units STRING,
rxv_bolus_dose_amount_units_primary_id STRING,
rxv_bolus_dose_amount_units_text STRING,
rxv_bolus_dose_amount_units_name_of_coding_sys STRING,
rxv_bolus_dose_amount_units_alt_identifier STRING,
rxv_bolus_dose_amount_units_alt_text STRING,
rxv_bolus_dose_amount_units_name_of_alt_coding_sys STRING,
rxv_bolus_dose_amount_units_coding_sys_ver_id STRING,
rxv_bolus_dose_amount_units_alt_coding_sys_ver_id STRING,
rxv_bolus_dose_amount_units_original_text STRING,
rxv_bolus_dose_amount_units_second_alt_id STRING,
rxv_bolus_dose_amount_units_second_alt_text STRING,
rxv_bolus_dose_amount_units_name_of_second_alt_coding_sys STRING,
rxv_bolus_dose_amount_units_second_alt_coding_sys_ver_id STRING,
rxv_bolus_dose_amount_units_coding_sys_oid STRING,
rxv_bolus_dose_amount_units_value_set_oid STRING,
rxv_bolus_dose_amount_units_value_set_ver_id STRING,
rxv_bolus_dose_amount_units_alt_coding_sys_oid STRING,
rxv_bolus_dose_amount_units_alt_value_set_oid STRING,
rxv_bolus_dose_amount_units_alt_value_set_ver_id STRING,
rxv_bolus_dose_amount_units_second_alt_coding_sys_oid STRING,
rxv_bolus_dose_amount_units_second_alt_value_set_oid STRING,
rxv_bolus_dose_amount_units_second_alt_value_set_ver_id STRING,
rxv_bolus_dose_volume STRING,
rxv_bolus_dose_volume_units STRING,
rxv_bolus_dose_volume_units_primary_id STRING,
rxv_bolus_dose_volume_units_text STRING,
rxv_bolus_dose_volume_units_name_of_coding_sys STRING,
rxv_bolus_dose_volume_units_alt_identifier STRING,
rxv_bolus_dose_volume_units_alt_text STRING,
rxv_bolus_dose_volume_units_name_of_alt_coding_sys STRING,
rxv_bolus_dose_volume_units_coding_sys_ver_id STRING,
rxv_bolus_dose_volume_units_alt_coding_sys_ver_id STRING,
rxv_bolus_dose_volume_units_original_text STRING,
rxv_bolus_dose_volume_units_second_alt_id STRING,
rxv_bolus_dose_volume_units_second_alt_text STRING,
rxv_bolus_dose_volume_units_name_of_second_alt_coding_sys STRING,
rxv_bolus_dose_volume_units_second_alt_coding_sys_ver_id STRING,
rxv_bolus_dose_volume_units_coding_sys_oid STRING,
rxv_bolus_dose_volume_units_value_set_oid STRING,
rxv_bolus_dose_volume_units_value_set_ver_id STRING,
rxv_bolus_dose_volume_units_alt_coding_sys_oid STRING,
rxv_bolus_dose_volume_units_alt_value_set_oid STRING,
rxv_bolus_dose_volume_units_alt_value_set_ver_id STRING,
rxv_bolus_dose_volume_units_second_alt_coding_sys_oid STRING,
rxv_bolus_dose_volume_units_second_alt_value_set_oid STRING,
rxv_bolus_dose_volume_units_second_alt_value_set_ver_id STRING,
rxv_pca_type STRING,
rxv_pca_dose_amount STRING,
rxv_pca_dose_amount_units STRING,
rxv_pca_dose_amount_units_primary_id STRING,
rxv_pca_dose_amount_units_text STRING,
rxv_pca_dose_amount_units_name_of_coding_sys STRING,
rxv_pca_dose_amount_units_alt_identifier STRING,
rxv_pca_dose_amount_units_alt_text STRING,
rxv_pca_dose_amount_units_name_of_alt_coding_sys STRING,
rxv_pca_dose_amount_units_coding_sys_ver_id STRING,
rxv_pca_dose_amount_units_alt_coding_sys_ver_id STRING,
rxv_pca_dose_amount_units_original_text STRING,
rxv_pca_dose_amount_units_second_alt_id STRING,
rxv_pca_dose_amount_units_second_alt_text STRING,
rxv_pca_dose_amount_units_name_of_second_alt_coding_sys STRING,
rxv_pca_dose_amount_units_second_alt_coding_sys_ver_id STRING,
rxv_pca_dose_amount_units_coding_sys_oid STRING,
rxv_pca_dose_amount_units_value_set_oid STRING,
rxv_pca_dose_amount_units_value_set_ver_id STRING,
rxv_pca_dose_amount_units_alt_coding_sys_oid STRING,
rxv_pca_dose_amount_units_alt_value_set_oid STRING,
rxv_pca_dose_amount_units_alt_value_set_ver_id STRING,
rxv_pca_dose_amount_units_second_alt_coding_sys_oid STRING,
rxv_pca_dose_amount_units_second_alt_value_set_oid STRING,
rxv_pca_dose_amount_units_second_alt_value_set_ver_id STRING,
rxv_pca_dose_amount_volume STRING,
rxv_pca_dose_amount_volume_units STRING,
rxv_pca_dose_amount_volume_units_primary_id STRING,
rxv_pca_dose_amount_volume_units_text STRING,
rxv_pca_dose_amount_volume_units_name_of_coding_sys STRING,
rxv_pca_dose_amount_volume_units_alt_identifier STRING,
rxv_pca_dose_amount_volume_units_alt_text STRING,
rxv_pca_dose_amount_volume_units_name_of_alt_coding_sys STRING,
rxv_pca_dose_amount_volume_units_coding_sys_ver_id STRING,
rxv_pca_dose_amount_volume_units_alt_coding_sys_ver_id STRING,
rxv_pca_dose_amount_volume_units_original_text STRING,
rxv_pca_dose_amount_volume_units_second_alt_id STRING,
rxv_pca_dose_amount_volume_units_second_alt_text STRING,
rxv_pca_dose_amount_volume_units_name_of_second_alt_coding_sys STRING,
rxv_pca_dose_amount_volume_units_second_alt_coding_sys_ver_id STRING,
rxv_pca_dose_amount_volume_units_coding_sys_oid STRING,
rxv_pca_dose_amount_volume_units_value_set_oid STRING,
rxv_pca_dose_amount_volume_units_value_set_ver_id STRING,
rxv_pca_dose_amount_volume_units_alt_coding_sys_oid STRING,
rxv_pca_dose_amount_volume_units_alt_value_set_oid STRING,
rxv_pca_dose_amount_volume_units_alt_value_set_ver_id STRING,
rxv_pca_dose_amount_volume_units_second_alt_coding_sys_oid STRING,
rxv_pca_dose_amount_volume_units_second_alt_value_set_oid STRING,
rxv_pca_dose_amount_volume_units_second_alt_value_set_ver_id STRING,
rxv_max_dose_amount STRING,
rxv_max_dose_amount_units STRING,
rxv_max_dose_amount_units_primary_id STRING,
rxv_max_dose_amount_units_text STRING,
rxv_max_dose_amount_units_name_of_coding_sys STRING,
rxv_max_dose_amount_units_alt_identifier STRING,
rxv_max_dose_amount_units_alt_text STRING,
rxv_max_dose_amount_units_name_of_alt_coding_sys STRING,
rxv_max_dose_amount_units_coding_sys_ver_id STRING,
rxv_max_dose_amount_units_alt_coding_sys_ver_id STRING,
rxv_max_dose_amount_units_original_text STRING,
rxv_max_dose_amount_units_second_alt_id STRING,
rxv_max_dose_amount_units_second_alt_text STRING,
rxv_max_dose_amount_units_name_of_second_alt_coding_sys STRING,
rxv_max_dose_amount_units_second_alt_coding_sys_ver_id STRING,
rxv_max_dose_amount_units_coding_sys_oid STRING,
rxv_max_dose_amount_units_value_set_oid STRING,
rxv_max_dose_amount_units_value_set_ver_id STRING,
rxv_max_dose_amount_units_alt_coding_sys_oid STRING,
rxv_max_dose_amount_units_alt_value_set_oid STRING,
rxv_max_dose_amount_units_alt_value_set_ver_id STRING,
rxv_max_dose_amount_units_second_alt_coding_sys_oid STRING,
rxv_max_dose_amount_units_second_alt_value_set_oid STRING,
rxv_max_dose_amount_units_second_alt_value_set_ver_id STRING,
rxv_max_dose_amount_volume STRING,
rxv_max_dose_amount_volume_units STRING,
rxv_max_dose_amount_volume_units_primary_id STRING,
rxv_max_dose_amount_volume_units_text STRING,
rxv_max_dose_amount_volume_units_name_of_coding_sys STRING,
rxv_max_dose_amount_volume_units_alt_identifier STRING,
rxv_max_dose_amount_volume_units_alt_text STRING,
rxv_max_dose_amount_volume_units_name_of_alt_coding_sys STRING,
rxv_max_dose_amount_volume_units_coding_sys_ver_id STRING,
rxv_max_dose_amount_volume_units_alt_coding_sys_ver_id STRING,
rxv_max_dose_amount_volume_units_original_text STRING,
rxv_max_dose_amount_volume_units_second_alt_id STRING,
rxv_max_dose_amount_volume_units_second_alt_text STRING,
rxv_max_dose_amount_volume_units_name_of_second_alt_coding_sys STRING,
rxv_max_dose_amount_volume_units_second_alt_coding_sys_ver_id STRING,
rxv_max_dose_amount_volume_units_coding_sys_oid STRING,
rxv_max_dose_amount_volume_units_value_set_oid STRING,
rxv_max_dose_amount_volume_units_value_set_ver_id STRING,
rxv_max_dose_amount_volume_units_alt_coding_sys_oid STRING,
rxv_max_dose_amount_volume_units_alt_value_set_oid STRING,
rxv_max_dose_amount_volume_units_alt_value_set_ver_id STRING,
rxv_max_dose_amount_volume_units_second_alt_coding_sys_oid STRING,
rxv_max_dose_amount_volume_units_second_alt_value_set_oid STRING,
rxv_max_dose_amount_volume_units_second_alt_value_set_ver_id STRING,
rxv_max_dose_per_time STRING,
rxv_max_dose_per_time_quantity STRING,
rxv_max_dose_per_time_units STRING,
rxv_max_dose_per_time_units_primary_id STRING,
rxv_max_dose_per_time_units_text STRING,
rxv_max_dose_per_time_units_name_of_coding_sys STRING,
rxv_max_dose_per_time_units_alt_identifier STRING,
rxv_max_dose_per_time_units_alt_text STRING,
rxv_max_dose_per_time_units_name_of_alt_coding_sys STRING,
rxv_max_dose_per_time_units_coding_sys_ver_id STRING,
rxv_max_dose_per_time_units_alt_coding_sys_ver_id STRING,
rxv_max_dose_per_time_units_original_text STRING,
rxv_max_dose_per_time_units_second_alt_id STRING,
rxv_max_dose_per_time_units_second_alt_text STRING,
rxv_max_dose_per_time_units_name_of_second_alt_coding_sys STRING,
rxv_max_dose_per_time_units_second_alt_coding_sys_ver_id STRING,
rxv_max_dose_per_time_units_coding_sys_oid STRING,
rxv_max_dose_per_time_units_value_set_oid STRING,
rxv_max_dose_per_time_units_value_set_ver_id STRING,
rxv_max_dose_per_time_units_alt_coding_sys_oid STRING,
rxv_max_dose_per_time_units_alt_value_set_oid STRING,
rxv_max_dose_per_time_units_alt_value_set_ver_id STRING,
rxv_max_dose_per_time_units_second_alt_coding_sys_oid STRING,
rxv_max_dose_per_time_units_second_alt_value_set_oid STRING,
rxv_max_dose_per_time_units_second_alt_value_set_ver_id STRING,
rxv_lockout_interval STRING,
rxv_lockout_interval_quantity STRING,
rxv_lockout_interval_units STRING,
rxv_lockout_interval_units_primary_id STRING,
rxv_lockout_interval_units_text STRING,
rxv_lockout_interval_units_name_of_coding_sys STRING,
rxv_lockout_interval_units_alt_identifier STRING,
rxv_lockout_interval_units_alt_text STRING,
rxv_lockout_interval_units_name_of_alt_coding_sys STRING,
rxv_lockout_interval_units_coding_sys_ver_id STRING,
rxv_lockout_interval_units_alt_coding_sys_ver_id STRING,
rxv_lockout_interval_units_original_text STRING,
rxv_lockout_interval_units_second_alt_id STRING,
rxv_lockout_interval_units_second_alt_text STRING,
rxv_lockout_interval_units_name_of_second_alt_coding_sys STRING,
rxv_lockout_interval_units_second_alt_coding_sys_ver_id STRING,
rxv_lockout_interval_units_coding_sys_oid STRING,
rxv_lockout_interval_units_value_set_oid STRING,
rxv_lockout_interval_units_value_set_ver_id STRING,
rxv_lockout_interval_units_alt_coding_sys_oid STRING,
rxv_lockout_interval_units_alt_value_set_oid STRING,
rxv_lockout_interval_units_alt_value_set_ver_id STRING,
rxv_lockout_interval_units_second_alt_coding_sys_oid STRING,
rxv_lockout_interval_units_second_alt_value_set_oid STRING,
rxv_lockout_interval_units_second_alt_value_set_ver_id STRING,
rxv_syringe_manufacturer STRING,
rxv_syringe_manufacturer_primary_id STRING,
rxv_syringe_manufacturer_text STRING,
rxv_syringe_manufacturer_name_of_coding_sys STRING,
rxv_syringe_manufacturer_alt_identifier STRING,
rxv_syringe_manufacturer_alt_text STRING,
rxv_syringe_manufacturer_name_of_alt_coding_sys STRING,
rxv_syringe_manufacturer_coding_sys_ver_id STRING,
rxv_syringe_manufacturer_alt_coding_sys_ver_id STRING,
rxv_syringe_manufacturer_original_text STRING,
rxv_syringe_manufacturer_second_alt_id STRING,
rxv_syringe_manufacturer_second_alt_text STRING,
rxv_syringe_manufacturer_name_of_second_alt_coding_sys STRING,
rxv_syringe_manufacturer_second_alt_coding_sys_ver_id STRING,
rxv_syringe_manufacturer_coding_sys_oid STRING,
rxv_syringe_manufacturer_value_set_oid STRING,
rxv_syringe_manufacturer_value_set_ver_id STRING,
rxv_syringe_manufacturer_alt_coding_sys_oid STRING,
rxv_syringe_manufacturer_alt_value_set_oid STRING,
rxv_syringe_manufacturer_alt_value_set_ver_id STRING,
rxv_syringe_manufacturer_second_alt_coding_sys_oid STRING,
rxv_syringe_manufacturer_second_alt_value_set_oid STRING,
rxv_syringe_manufacturer_second_alt_value_set_ver_id STRING,
rxv_syringe_model_number STRING,
rxv_syringe_model_number_primary_id STRING,
rxv_syringe_model_number_text STRING,
rxv_syringe_model_number_name_of_coding_sys STRING,
rxv_syringe_model_number_alt_identifier STRING,
rxv_syringe_model_number_alt_text STRING,
rxv_syringe_model_number_name_of_alt_coding_sys STRING,
rxv_syringe_model_number_coding_sys_ver_id STRING,
rxv_syringe_model_number_alt_coding_sys_ver_id STRING,
rxv_syringe_model_number_original_text STRING,
rxv_syringe_model_number_second_alt_id STRING,
rxv_syringe_model_number_second_alt_text STRING,
rxv_syringe_model_number_name_of_second_alt_coding_sys STRING,
rxv_syringe_model_number_second_alt_coding_sys_ver_id STRING,
rxv_syringe_model_number_coding_sys_oid STRING,
rxv_syringe_model_number_value_set_oid STRING,
rxv_syringe_model_number_value_set_ver_id STRING,
rxv_syringe_model_number_alt_coding_sys_oid STRING,
rxv_syringe_model_number_alt_value_set_oid STRING,
rxv_syringe_model_number_alt_value_set_ver_id STRING,
rxv_syringe_model_number_second_alt_coding_sys_oid STRING,
rxv_syringe_model_number_second_alt_value_set_oid STRING,
rxv_syringe_model_number_second_alt_value_set_ver_id STRING,
rxv_syringe_size STRING,
rxv_syringe_size_units STRING,
rxv_syringe_size_units_primary_id STRING,
rxv_syringe_size_units_text STRING,
rxv_syringe_size_units_name_of_coding_sys STRING,
rxv_syringe_size_units_alt_identifier STRING,
rxv_syringe_size_units_alt_text STRING,
rxv_syringe_size_units_name_of_alt_coding_sys STRING,
rxv_syringe_size_units_coding_sys_ver_id STRING,
rxv_syringe_size_units_alt_coding_sys_ver_id STRING,
rxv_syringe_size_units_original_text STRING,
rxv_syringe_size_units_second_alt_id STRING,
rxv_syringe_size_units_second_alt_text STRING,
rxv_syringe_size_units_name_of_second_alt_coding_sys STRING,
rxv_syringe_size_units_second_alt_coding_sys_ver_id STRING,
rxv_syringe_size_units_coding_sys_oid STRING,
rxv_syringe_size_units_value_set_oid STRING,
rxv_syringe_size_units_value_set_ver_id STRING,
rxv_syringe_size_units_alt_coding_sys_oid STRING,
rxv_syringe_size_units_alt_value_set_oid STRING,
rxv_syringe_size_units_alt_value_set_ver_id STRING,
rxv_syringe_size_units_second_alt_coding_sys_oid STRING,
rxv_syringe_size_units_second_alt_value_set_oid STRING,
rxv_syringe_size_units_second_alt_value_set_ver_id STRING,
rxv_action_code STRING,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS SEQUENCEFILE
LOCATION '/user/hive/warehouse/hl7/hl7_all_segment_data';

CREATE VIEW vw_hl7_rxv_data AS SELECT * FROM hl7_rxv_data WHERE segment_type='RXV';

CREATE EXTERNAL TABLE hl7_con_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
con_set_id String,
con_consent_type String,
con_consent_form_id_and_version String,
con_consent_form_num String,
con_consent_text String,
con_subject_specific_consent_text String,
con_consent_background_information String,
con_subject_specific_consent_background_text String,
con_consenter_imposed_limitations String,
con_consent_mode String,
con_consent_status String,
con_consent_discussion_date_time String,
con_consent_decision_date_time String,
con_consent_eff_from_date_time String,
con_consent_eff_to_date_time String,
con_subject_competence_ind String,
con_translator_assistance_ind String,
con_language_translated_to String,
con_informational_material_supplied_ind String,
con_consent_bypass_reason String,
con_consent_disclosure_level String,
con_consent_non_disclosure_reason String,
con_non_subject_consenter_reason String,
con_consenter_id String,
con_relationship_to_subject String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS SEQUENCEFILE
LOCATION '/user/hive/warehouse/hl7/hl7_all_segment_data';

CREATE VIEW vw_hl7_con_data AS SELECT * FROM hl7_con_data WHERE segment_type='CON';

CREATE EXTERNAL TABLE hl7_iam_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
iam_set_id String,
iam_allergen_type_code String,
iam_allergen_code_mnemonic_desc String,
iam_allergy_severity_code String,
iam_allergy_reaction_code String,
iam_allergy_action_code String,
iam_allergy_unique_id String,
iam_action_reason String,
iam_sensitivity_to_causative_agent_code String,
iam_allergen_group_code_mnemonic_desc String,
iam_onset_date String,
iam_onset_date_text String,
iam_reported_date_time String,
iam_reported_by String,
iam_relationship_to_patient_code String,
iam_alert_device_code String,
iam_allergy_clinical_status_code String,
iam_statused_by_person String,
iam_statused_by_organization String,
iam_statused_at_date_time String,
iam_inactivated_by_person String,
iam_inactivated_date_time String,
iam_initially_recorded_by_person String,
iam_initially_recorded_date_time String,
iam_modified_by_person String,
iam_modified_date_time String,
iam_clinician_identified_code String,
iam_initially_recorded_by_organization String,
iam_modified_by_organization String,
iam_inactivated_by_organization String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS SEQUENCEFILE
LOCATION '/user/hive/warehouse/hl7/hl7_all_segment_data';

CREATE VIEW vw_hl7_iam_data AS SELECT * FROM hl7_iam_data WHERE segment_type='IAM';

drop table hl7_sft_data;

CREATE EXTERNAL TABLE hl7_sft_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
sft_software_vendor_organization String,
sft_software_vendor_organization_org_name String,
sft_software_vendor_organization_org_name_type_code String,
sft_software_vendor_organization_org_name_type_code_primary_id String,
sft_software_vendor_organization_org_name_type_code_text String,
sft_software_vendor_organization_org_name_type_code_name_of_coding_sys String,
sft_software_vendor_organization_org_name_type_code_alt_id String,
sft_software_vendor_organization_org_name_type_code_alt_text String,
sft_software_vendor_organization_org_name_type_code_name_of_alt_coding_sys String,
sft_software_vendor_organization_org_name_type_code_coding_sys_ver_id String,
sft_software_vendor_organization_org_name_type_code_alt_coding_sys_ver_id String,
sft_software_vendor_organization_org_name_type_code_original_text String,
sft_software_vendor_organization_org_name_type_code_second_alt_id String,
sft_software_vendor_organization_org_name_type_code_second_alt_text String,
sft_software_vendor_organization_org_name_type_code_name_of_second_alt_coding_sys String,
sft_software_vendor_organization_org_name_type_code_second_alt_coding_sys_ver_id String,
sft_software_vendor_organization_org_name_type_code_coding_sys_oid String,
sft_software_vendor_organization_org_name_type_code_value_set_oid String,
sft_software_vendor_organization_org_name_type_code_value_set_ver_id String,
sft_software_vendor_organization_org_name_type_code_alt_coding_sys_oid String,
sft_software_vendor_organization_org_name_type_code_alt_value_set_oid String,
sft_software_vendor_organization_org_name_type_code_alt_value_set_ver_id String,
sft_software_vendor_organization_org_name_type_code_second_alt_coding_sys_oid String,
sft_software_vendor_organization_org_name_type_code_second_alt_value_set_oid String,
sft_software_vendor_organization_org_name_type_code_second_alt_value_set_ver_id String,
sft_software_vendor_organization_identifier_num String,
sft_software_vendor_organization_check_digit String,
sft_software_vendor_organization_check_digit_scheme String,
sft_software_vendor_organization_assgn_authr String,
sft_software_vendor_organization_assgn_authr_namespace_id String,
sft_software_vendor_organization_assgn_authr_universal_id String,
sft_software_vendor_organization_assgn_authr_universal_id_type String,
sft_software_vendor_organization_identifier_type_code String,
sft_software_vendor_organization_assgn_facility String,
sft_software_vendor_organization_assgn_facility_namespace_id String,
sft_software_vendor_organization_assgn_facility_universal_id String,
sft_software_vendor_organization_assgn_facility_universal_id_type String,
sft_software_vendor_organization_name_rep_code String,
sft_software_vendor_organization_org_id String,
sft_software_certified_version_release_num String,
sft_software_product_name String,
sft_software_binary_id String,
sft_software_product_information String,
sft_software_install_date String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS SEQUENCEFILE
LOCATION '/user/hive/warehouse/hl7/hl7_all_segment_data';

CREATE EXTERNAL TABLE hl7_in2_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
in2_insured_employee_id String,
in2_insured_social_security_num String,
in2_insured_employer_name_id String,
in2_employer_information_data String,
in2_mail_claim_party String,
in2_medicare_health_insurance_card_num String,
in2_medicaid_case_name String,
in2_medicaid_case_num String,
in2_military_sponsor_name String,
in2_military_id_num String,
in2_dependent_of_military_recipient String,
in2_military_organization_name String,
in2_military_station String,
in2_military_service String,
in2_military_rank_grade String,
in2_military_status String,
in2_military_retire_date String,
in2_military_non_avail_cert_on_file String,
in2_baby_coverage String,
in2_combine_baby_bill String,
in2_blood_deductible String,
in2_special_coverage_approval_name String,
in2_special_coverage_approval_title String,
in2_non_covered_insurance_code String,
in2_payor_id String,
in2_payor_subscriber_id String,
in2_eligibility_source String,
in2_room_coverage_type_amt String,
in2_policy_type_amt String,
in2_daily_deductible String,
in2_living_dependency String,
in2_ambulatory_status String,
in2_citizenship String,
in2_primary_language String,
in2_living_arrangement String,
in2_publicity_code String,
in2_protection_ind String,
in2_student_ind String,
in2_religion String,
in2_mother_maiden_name String,
in2_nationality String,
in2_ethnic_group String,
in2_marital_status String,
in2_insured_employment_start_date String,
in2_employment_stop_date String,
in2_job_title String,
in2_job_code_classification String,
in2_job_status String,
in2_employer_contact_person_name String,
in2_employer_contact_person_name_last_name String,
in2_employer_contact_person_name_first_name String,
in2_employer_contact_person_name_middle_name String,
in2_employer_contact_person_name_suffix String,
in2_employer_contact_person_name_person_prefix String,
in2_employer_contact_person_name_degree String,
in2_employer_contact_person_name_type_code String,
in2_employer_contact_person_name_rep_code String,
in2_employer_contact_person_name_context String,
in2_employer_contact_person_name_validity_range String,
in2_employer_contact_person_name_assembly_order String,
in2_employer_contact_person_name_eff_from_date_time String,
in2_employer_contact_person_name_eff_to_date_time String,
in2_employer_contact_person_name_prof_suffix String,
in2_employer_contact_person_name_called_by String,
in2_employer_contact_person_phone_num String,
in2_employer_contact_person_phone_num_formatted_num String,
in2_employer_contact_person_phone_num_use_code String,
in2_employer_contact_person_phone_num_equipment_type String,
in2_employer_contact_person_phone_num_comm_address String,
in2_employer_contact_person_phone_num_country_code String,
in2_employer_contact_person_phone_num_area_city_code String,
in2_employer_contact_person_phone_num_local_number String,
in2_employer_contact_person_phone_num_extension String,
in2_employer_contact_person_phone_num_any_text String,
in2_employer_contact_person_phone_num_extension_prefix String,
in2_employer_contact_person_phone_num_speed_dial_code String,
in2_employer_contact_person_phone_num_unformatted_num String,
in2_employer_contact_person_phone_num_eff_from_date String,
in2_employer_contact_person_phone_num_eff_to_date String,
in2_employer_contact_person_phone_num_expr_reason String,
in2_employer_contact_person_phone_num_protection_code String,
in2_employer_contact_person_phone_num_shared_id String,
in2_employer_contact_person_phone_num_pref_order String,
in2_employer_contact_reason String,
in2_insured_contact_person_name String,
in2_insured_contact_person_name_last_name String,
in2_insured_contact_person_name_first_name String,
in2_insured_contact_person_name_middle_name String,
in2_insured_contact_person_name_suffix String,
in2_insured_contact_person_name_person_prefix String,
in2_insured_contact_person_name_degree String,
in2_insured_contact_person_name_type_code String,
in2_insured_contact_person_name_rep_code String,
in2_insured_contact_person_name_context String,
in2_insured_contact_person_name_validity_range String,
in2_insured_contact_person_name_assembly_order String,
in2_insured_contact_person_name_eff_from_date_time String,
in2_insured_contact_person_name_eff_to_date_time String,
in2_insured_contact_person_name_prof_suffix String,
in2_insured_contact_person_name_called_by String,
in2_insured_contact_person_phone_num String,
in2_insured_contact_person_phone_num_formatted_num String,
in2_insured_contact_person_phone_num_use_code String,
in2_insured_contact_person_phone_num_equipment_type String,
in2_insured_contact_person_phone_num_comm_address String,
in2_insured_contact_person_phone_num_country_code String,
in2_insured_contact_person_phone_num_area_city_code String,
in2_insured_contact_person_phone_num_local_number String,
in2_insured_contact_person_phone_num_extension String,
in2_insured_contact_person_phone_num_any_text String,
in2_insured_contact_person_phone_num_extension_prefix String,
in2_insured_contact_person_phone_num_speed_dial_code String,
in2_insured_contact_person_phone_num_unformatted_num String,
in2_insured_contact_person_phone_num_eff_from_date String,
in2_insured_contact_person_phone_num_eff_to_date String,
in2_insured_contact_person_phone_num_expr_reason String,
in2_insured_contact_person_phone_num_protection_code String,
in2_insured_contact_person_phone_num_shared_id String,
in2_insured_contact_person_phone_num_pref_order String,
in2_insured_contact_person_reason String,
in2_relationship_to_patient_start_date String,
in2_relationship_to_patient_stop_date String,
in2_insurance_company_contact_reason String,
in2_insurance_company_contact_phone_num String,
in2_insurance_company_contact_phone_num_formatted_num String,
in2_insurance_company_contact_phone_num_use_code String,
in2_insurance_company_contact_phone_num_equipment_type String,
in2_insurance_company_contact_phone_num_comm_address String,
in2_insurance_company_contact_phone_num_country_code String,
in2_insurance_company_contact_phone_num_area_city_code String,
in2_insurance_company_contact_phone_num_local_number String,
in2_insurance_company_contact_phone_num_extension String,
in2_insurance_company_contact_phone_num_any_text String,
in2_insurance_company_contact_phone_num_extension_prefix String,
in2_insurance_company_contact_phone_num_speed_dial_code String,
in2_insurance_company_contact_phone_num_unformatted_num String,
in2_insurance_company_contact_phone_num_eff_from_date String,
in2_insurance_company_contact_phone_num_eff_to_date String,
in2_insurance_company_contact_phone_num_expr_reason String,
in2_insurance_company_contact_phone_num_protection_code String,
in2_insurance_company_contact_phone_num_shared_id String,
in2_insurance_company_contact_phone_num_pref_order String,
in2_policy_scope String,
in2_policy_source String,
in2_patient_member_num String,
in2_guarantor_relationship_to_insured String,
in2_insured_phone_num_home String,
in2_insured_phone_num_home_formatted_num String,
in2_insured_phone_num_home_use_code String,
in2_insured_phone_num_home_equipment_type String,
in2_insured_phone_num_home_comm_address String,
in2_insured_phone_num_home_country_code String,
in2_insured_phone_num_home_area_city_code String,
in2_insured_phone_num_home_local_number String,
in2_insured_phone_num_home_extension String,
in2_insured_phone_num_home_any_text String,
in2_insured_phone_num_home_extension_prefix String,
in2_insured_phone_num_home_speed_dial_code String,
in2_insured_phone_num_home_unformatted_num String,
in2_insured_phone_num_home_eff_from_date String,
in2_insured_phone_num_home_eff_to_date String,
in2_insured_phone_num_home_expr_reason String,
in2_insured_phone_num_home_protection_code String,
in2_insured_phone_num_home_shared_id String,
in2_insured_phone_num_home_pref_order String,
in2_insured_employer_phone_num String,
in2_insured_employer_phone_num_formatted_num String,
in2_insured_employer_phone_num_use_code String,
in2_insured_employer_phone_num_equipment_type String,
in2_insured_employer_phone_num_comm_address String,
in2_insured_employer_phone_num_country_code String,
in2_insured_employer_phone_num_area_city_code String,
in2_insured_employer_phone_num_local_number String,
in2_insured_employer_phone_num_extension String,
in2_insured_employer_phone_num_any_text String,
in2_insured_employer_phone_num_extension_prefix String,
in2_insured_employer_phone_num_speed_dial_code String,
in2_insured_employer_phone_num_unformatted_num String,
in2_insured_employer_phone_num_eff_from_date String,
in2_insured_employer_phone_num_eff_to_date String,
in2_insured_employer_phone_num_expr_reason String,
in2_insured_employer_phone_num_protection_code String,
in2_insured_employer_phone_num_shared_id String,
in2_insured_employer_phone_num_pref_order String,
in2_military_handicapped_program String,
in2_suspend_flag String,
in2_copay_limit_flag String,
in2_stoploss_limit_flag String,
in2_insured_organization_name_id String,
in2_insured_employer_organization_name_id String,
in2_race String,
in2_patient_relationship_to_insured String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS SEQUENCEFILE
LOCATION '/user/hive/warehouse/hl7/hl7_all_segment_data';

CREATE VIEW vw_hl7_in2_data AS SELECT * FROM hl7_in2_data WHERE segment_type='IN2';

CREATE EXTERNAL TABLE hl7_in3_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
in3_set_id String,
in3_certification_num String,
in3_certified_by String,
in3_certification_required String,
in3_penalty String,
in3_certification_date_time String,
in3_certification_modify_date_time String,
in3_operator String,
in3_operator_person_id String,
in3_operator_last_name String,
in3_operator_first_name String,
in3_operator_middle_name String,
in3_operator_suffix String,
in3_operator_person_prefix String,
in3_operator_degree String,
in3_operator_source_table String,
in3_operator_assgn_authr String,
in3_operator_name_type_code String,
in3_operator_identifier_check_digit String,
in3_operator_check_digit_scheme String,
in3_operator_identifier_type_code String,
in3_operator_assgn_facility String,
in3_operator_name_rep_code String,
in3_operator_context String,
in3_operator_validity_range String,
in3_operator_assembly_order String,
in3_operator_eff_from_date_time String,
in3_operator_eff_to_date_time String,
in3_operator_prof_suffix String,
in3_operator_assgn_jurisdiction String,
in3_operator_assgn_agency_dept String,
in3_operator_security_check String,
in3_operator_security_check_scheme String,
in3_certification_begin_date String,
in3_certification_end_date String,
in3_certification_days String,
in3_certification_days_type_code String,
in3_certification_days_day_cnt String,
in3_non_concurence_code_desc String,
in3_non_concurence_eff_date_time String,
in3_physician_reviewer String,
in3_certification_contact String,
in3_certification_contact_phone_num String,
in3_certification_contact_phone_num_formatted_num String,
in3_certification_contact_phone_num_use_code String,
in3_certification_contact_phone_num_equipment_type String,
in3_certification_contact_phone_num_comm_address String,
in3_certification_contact_phone_num_country_code String,
in3_certification_contact_phone_num_area_city_code String,
in3_certification_contact_phone_num_local_number String,
in3_certification_contact_phone_num_extension String,
in3_certification_contact_phone_num_any_text String,
in3_certification_contact_phone_num_extension_prefix String,
in3_certification_contact_phone_num_speed_dial_code String,
in3_certification_contact_phone_num_unformatted_num String,
in3_certification_contact_phone_num_eff_from_date String,
in3_certification_contact_phone_num_eff_to_date String,
in3_certification_contact_phone_num_expr_reason String,
in3_certification_contact_phone_num_protection_code String,
in3_certification_contact_phone_num_shared_id String,
in3_certification_contact_phone_num_pref_order String,
in3_appeal_reason String,
in3_certification_agency String,
in3_certification_agency_phone_num String,
in3_pre_certification_requirement String,
in3_case_manager String,
in3_second_opinion_date String,
in3_second_opinion_status String,
in3_second_opinion_documentation_received String,
in3_second_opinion_physician String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS SEQUENCEFILE
LOCATION '/user/hive/warehouse/hl7/hl7_all_segment_data';

CREATE VIEW vw_hl7_in3_data AS SELECT * FROM hl7_in3_data WHERE segment_type='IN3';

CREATE EXTERNAL TABLE hl7_drg_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
drg_diagnostic_related_group String,
drg_assigned_date_time String,
drg_approval_ind String,
drg_grouper_review_code String,
drg_outlier_type String,
drg_outlier_days String,
drg_outlier_cost String,
drg_payor String,
drg_outlier_reimbursement String,
drg_confidential_ind String,
drg_transfer_type String,
drg_name_of_coder String,
drg_grouper_status String,
drg_pccl_value_code String,
drg_effective_weight String,
drg_monetary_amt String,
drg_status_patient String,
drg_grouper_software_name String,
drg_grouper_software_version String,
drg_status_financial_calculation String,
drg_relative_discount_surcharge String,
drg_basic_charge String,
drg_total_charge String,
drg_discnt_surcharge String,
drg_calculated_days String,
drg_status_gender String,
drg_status_age String,
drg_status_length_of_stay String,
drg_status_same_day_flag String,
drg_status_separation_mode String,
drg_status_weight_at_birth String,
drg_status_respiration_minutes String,
drg_status_admission String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS SEQUENCEFILE
LOCATION '/user/hive/warehouse/hl7/hl7_all_segment_data';

CREATE VIEW vw_hl7_drg_data AS SELECT * FROM hl7_drg_data WHERE segment_type='DRG';

CREATE EXTERNAL TABLE hl7_ub2_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
ub2_set_id String,
ub2_co_insurance_days String,
ub2_condition_code String,
ub2_condition_code_primary_id String,
ub2_condition_code_text String,
ub2_condition_code_name_of_coding_sys String,
ub2_condition_code_alt_id String,
ub2_condition_code_alt_text String,
ub2_condition_code_name_of_alt_coding_sys String,
ub2_condition_code_coding_sys_ver_id String,
ub2_condition_code_alt_coding_sys_ver_id String,
ub2_condition_code_original_text String,
ub2_condition_code_second_alt_id String,
ub2_condition_code_second_alt_text String,
ub2_condition_code_name_of_second_alt_coding_sys String,
ub2_condition_code_second_alt_coding_sys_ver_id String,
ub2_condition_code_coding_sys_oid String,
ub2_condition_code_value_set_oid String,
ub2_condition_code_value_set_ver_id String,
ub2_condition_code_alt_coding_sys_oid String,
ub2_condition_code_alt_value_set_oid String,
ub2_condition_code_alt_value_set_ver_id String,
ub2_condition_code_second_alt_coding_sys_oid String,
ub2_condition_code_second_alt_value_set_oid String,
ub2_condition_code_second_alt_value_set_ver_id String,
ub2_covered_days String,
ub2_non_covered_days String,
ub2_value_amt_code String,
ub2_value_amt_code_value_code String,
ub2_value_amt_code_monetary_amt String,
ub2_value_amt_code_non_monetary_amt String,
ub2_value_amt_code_non_monetary_unit String,
ub2_occurrence String,
ub2_occurrence_code String,
ub2_occurrence_date String,
ub2_occurrence_span String,
ub2_occurrence_span_code String,
ub2_occurrence_span_eff_from_date String,
ub2_occurrence_span_eff_to_date String,
ub2_ub92_state_defined_locator_2 String,
ub2_ub92_state_defined_locator_11 String,
ub2_ub92_national_defined_locator_31 String,
ub2_document_control_num String,
ub2_ub92_national_defined_locator_49 String,
ub2_ub92_state_defined_locator_56 String,
ub2_ub92_national_defined_locator_57 String,
ub2_ub92_state_defined_locator_78 String,
ub2_special_visit_cnt String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS SEQUENCEFILE
LOCATION '/user/hive/warehouse/hl7/hl7_all_segment_data';

CREATE VIEW vw_hl7_ub2_data AS SELECT * FROM hl7_ub2_data WHERE segment_type='UB2';

CREATE EXTERNAL TABLE hl7_rol_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
rol_role_instance_id String,
rol_action_code String,
rol_role_name String,
rol_role_person_name String,
rol_role_person_name_person_id String,
rol_role_person_name_last_name String,
rol_role_person_name_first_name String,
rol_role_person_name_middle_name String,
rol_role_person_name_suffix String,
rol_role_person_name_person_prefix String,
rol_role_person_name_degree String,
rol_role_person_name_source_table String,
rol_role_person_name_assgn_authr String,
rol_role_person_name_name_type_code String,
rol_role_person_name_identifier_check_digit String,
rol_role_person_name_check_digit_scheme String,
rol_role_person_name_identifier_type_code String,
rol_role_person_name_assgn_facility String,
rol_role_person_name_name_rep_code String,
rol_role_person_name_context String,
rol_role_person_name_validity_range String,
rol_role_person_name_assembly_order String,
rol_role_person_name_eff_from_date_time String,
rol_role_person_name_eff_to_date_time String,
rol_role_person_name_prof_suffix String,
rol_role_person_name_assgn_jurisdiction String,
rol_role_person_name_assgn_agency_dept String,
rol_role_person_name_security_check String,
rol_role_person_name_security_check_scheme String,
rol_role_begin_date_time String,
rol_role_end_date_time String,
rol_role_duration String,
rol_role_action_reason String,
rol_role_action_reason_primary_id String,
rol_role_action_reason_text String,
rol_role_action_reason_name_of_coding_sys String,
rol_role_action_reason_alt_id String,
rol_role_action_reason_alt_text String,
rol_role_action_reason_name_of_alt_coding_sys String,
rol_role_action_reason_coding_sys_ver_id String,
rol_role_action_reason_alt_coding_sys_ver_id String,
rol_role_action_reason_original_text String,
rol_role_action_reason_second_alt_id String,
rol_role_action_reason_second_alt_text String,
rol_role_action_reason_name_of_second_alt_coding_sys String,
rol_role_action_reason_second_alt_coding_sys_ver_id String,
rol_role_action_reason_coding_sys_oid String,
rol_role_action_reason_value_set_oid String,
rol_role_action_reason_value_set_ver_id String,
rol_role_action_reason_alt_coding_sys_oid String,
rol_role_action_reason_alt_value_set_oid String,
rol_role_action_reason_alt_value_set_ver_id String,
rol_role_action_reason_second_alt_coding_sys_oid String,
rol_role_action_reason_second_alt_value_set_oid String,
rol_role_action_reason_second_alt_value_set_ver_id String,
rol_provider_type String,
rol_organization_unit_type String,
rol_office_home_address_birthplace String,
rol_office_home_address_birthplace_street_address1 String,
rol_office_home_address_birthplace_street_address2 String,
rol_office_home_address_birthplace_city String,
rol_office_home_address_birthplace_state_province String,
rol_office_home_address_birthplace_zip_postal_code String,
rol_office_home_address_birthplace_country String,
rol_office_home_address_birthplace_address_type String,
rol_office_home_address_birthplace_other_geo_designation String,
rol_office_home_address_birthplace_county_parish_code String,
rol_office_home_address_birthplace_census_tract String,
rol_office_home_address_birthplace_rep_code String,
rol_office_home_address_birthplace_validity_range String,
rol_office_home_address_birthplace_eff_from_date_time String,
rol_office_home_address_birthplace_eff_to_date_time String,
rol_office_home_address_birthplace_expr_reason String,
rol_office_home_address_birthplace_temporary_indicator String,
rol_office_home_address_birthplace_bad_address_indicator String,
rol_office_home_address_birthplace_address_usage String,
rol_office_home_address_birthplace_addressee String,
rol_office_home_address_birthplace_address_comment String,
rol_office_home_address_birthplace_pref_order String,
rol_office_home_address_birthplace_protection_code String,
rol_office_home_address_birthplace_address_id String,
rol_phone_num String,
rol_phone_num_formatted_num String,
rol_phone_num_use_code String,
rol_phone_num_equipment_type String,
rol_phone_num_comm_address String,
rol_phone_num_country_code String,
rol_phone_num_area_city_code String,
rol_phone_num_local_number String,
rol_phone_num_extension String,
rol_phone_num_any_text String,
rol_phone_num_extension_prefix String,
rol_phone_num_speed_dial_code String,
rol_phone_num_unformatted_num String,
rol_phone_num_eff_from_date String,
rol_phone_num_eff_to_date String,
rol_phone_num_expr_reason String,
rol_phone_num_protection_code String,
rol_phone_num_shared_id String,
rol_phone_num_pref_order String,
rol_person_location String,
rol_organization_name String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS TEXTFILE
LOCATION '/user/hive/warehouse/hl7/hl7_all_segment_data';

CREATE VIEW vw_hl7_rol_data AS SELECT * FROM hl7_rol_data WHERE segment_type='ROL';

CREATE EXTERNAL TABLE hl7_ub1_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
ub1_set_id String,
ub1_blood_deductible String,
ub1_blood_furnished_pint String,
ub1_blood_replaced_pint String,
ub1_blood_not_replaced_pint String,
ub1_co_insurance_days String,
ub1_condition_code String,
ub1_covered_days String,
ub1_non_covered_days String,
ub1_value_amt_code String,
ub1_grace_days_num String,
ub1_special_program_ind String,
ub1_prof_std_review_org_utilization_review_approval_ind String,
ub1_prof_std_review_org_utilization_review_approved_stay_from String,
ub1_prof_std_review_org_utilization_review_approved_stay_to String,
ub1_occurrence String,
ub1_occurrence_span String,
ub1_occur_span_start_date String,
ub1_occur_span_end_date String,
ub1_ub82_designated_pay_to_billing_provider_address String,
ub1_ub82_patient_address String,
ub1_ub82_condition_code_10 String,
ub1_ub82_revenue_code_hcpcs_service_date String,
etl_firstinsert_datetime String
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS SEQUENCEFILE
LOCATION '/user/hive/warehouse/hl7/hl7_all_segment_data';

CREATE VIEW vw_hl7_ub1_data AS SELECT * FROM hl7_ub1_data WHERE segment_type='UB1';