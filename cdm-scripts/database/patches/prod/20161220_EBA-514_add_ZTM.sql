USE HL7;

CREATE EXTERNAL TABLE hl7_ztm_data (
segment_type String,
msh_sending_facility String,
msh_msg_control_id String,
pid_medical_record_num String,
pid_medical_record_urn String,
pid_pat_account_num String,
ztm_case_pre_1_time String,
ztm_case_pre_1_time_time_desc String,
ztm_case_pre_1_time_pre_date_time String,
ztm_case_pre_1_time_delay_code String,
ztm_case_pre_1_time_delay_desc String,
ztm_case_pre_1_time_delay_duration_min String,
ztm_case_pre_2_time String,
ztm_case_pre_2_time_time_desc String,
ztm_case_pre_2_time_pre_date_time String,
ztm_case_pre_2_time_delay_code String,
ztm_case_pre_2_time_delay_desc String,
ztm_case_pre_2_time_delay_duration_min String,
ztm_case_pre_3_time String,
ztm_case_pre_3_time_time_desc String,
ztm_case_pre_3_time_pre_date_time String,
ztm_case_pre_3_time_delay_code String,
ztm_case_pre_3_time_delay_desc String,
ztm_case_pre_3_time_delay_duration_min String,
ztm_case_pre_4_time String,
ztm_case_pre_4_time_time_desc String,
ztm_case_pre_4_time_pre_date_time String,
ztm_case_pre_4_time_delay_code String,
ztm_case_pre_4_time_delay_desc String,
ztm_case_pre_4_time_delay_duration_min String,
ztm_case_hold_1_time String,
ztm_case_hold_1_time_time_desc String,
ztm_case_hold_1_time_hold_date_time String,
ztm_case_hold_1_time_delay_code String,
ztm_case_hold_1_time_delay_desc String,
ztm_case_hold_1_time_delay_duration_min String,
ztm_case_hold_2_time String,
ztm_case_hold_2_time_time_desc String,
ztm_case_hold_2_time_hold_date_time String,
ztm_case_hold_2_time_delay_code String,
ztm_case_hold_2_time_delay_desc String,
ztm_case_hold_2_time_delay_duration_min String,
ztm_case_anesthesia_1_time String,
ztm_case_anesthesia_1_time_time_desc String,
ztm_case_anesthesia_1_time_ansth_date_time String,
ztm_case_anesthesia_1_time_delay_code String,
ztm_case_anesthesia_1_time_delay_desc String,
ztm_case_anesthesia_1_time_delay_duration_min String,
ztm_case_anesthesia_2_time String,
ztm_case_anesthesia_2_time_time_desc String,
ztm_case_anesthesia_2_time_ansth_date_time String,
ztm_case_anesthesia_2_time_delay_code String,
ztm_case_anesthesia_2_time_delay_desc String,
ztm_case_anesthesia_2_time_delay_duration_min String,
ztm_case_operating_room_1_time String,
ztm_case_operating_room_1_time_time_desc String,
ztm_case_operating_room_1_time_or_date_time String,
ztm_case_operating_room_1_time_delay_code String,
ztm_case_operating_room_1_time_delay_desc String,
ztm_case_operating_room_1_time_delay_duration_min String,
ztm_case_operating_room_2_time String,
ztm_case_operating_room_2_time_time_desc String,
ztm_case_operating_room_2_time_or_date_time String,
ztm_case_operating_room_2_time_delay_code String,
ztm_case_operating_room_2_time_delay_desc String,
ztm_case_operating_room_2_time_delay_duration_min String,
ztm_case_operating_room_3_time String,
ztm_case_operating_room_3_time_time_desc String,
ztm_case_operating_room_3_time_or_date_time String,
ztm_case_operating_room_3_time_delay_code String,
ztm_case_operating_room_3_time_delay_desc String,
ztm_case_operating_room_3_time_delay_duration_min String,
ztm_case_operating_room_4_time String,
ztm_case_operating_room_4_time_time_desc String,
ztm_case_operating_room_4_time_or_date_time String,
ztm_case_operating_room_4_time_delay_code String,
ztm_case_operating_room_4_time_delay_desc String,
ztm_case_operating_room_4_time_delay_duration_min String,
ztm_case_operating_room_5_time String,
ztm_case_operating_room_5_time_time_desc String,
ztm_case_operating_room_5_time_or_date_time String,
ztm_case_operating_room_5_time_delay_code String,
ztm_case_operating_room_5_time_delay_desc String,
ztm_case_operating_room_5_time_delay_duration_min String,
ztm_case_operating_room_6_time String,
ztm_case_operating_room_6_time_time_desc String,
ztm_case_operating_room_6_time_or_date_time String,
ztm_case_operating_room_6_time_delay_code String,
ztm_case_operating_room_6_time_delay_desc String,
ztm_case_operating_room_6_time_delay_duration_min String,
ztm_case_operating_room_7_time String,
ztm_case_operating_room_7_time_time_desc String,
ztm_case_operating_room_7_time_or_date_time String,
ztm_case_operating_room_7_time_delay_code String,
ztm_case_operating_room_7_time_delay_desc String,
ztm_case_operating_room_7_time_delay_duration_min String,
ztm_case_operating_room_8_time String,
ztm_case_operating_room_8_time_time_desc String,
ztm_case_operating_room_8_time_or_date_time String,
ztm_case_operating_room_8_time_delay_code String,
ztm_case_operating_room_8_time_delay_desc String,
ztm_case_operating_room_8_time_delay_duration_min String,
ztm_case_pacu_1_time String,
ztm_case_pacu_1_time_time_desc String,
ztm_case_pacu_1_time_pacu_date_time String,
ztm_case_pacu_1_time_delay_code String,
ztm_case_pacu_1_time_delay_desc String,
ztm_case_pacu_1_time_delay_duration_min String,
ztm_case_pacu_2_time String,
ztm_case_pacu_2_time_time_desc String,
ztm_case_pacu_2_time_pacu_date_time String,
ztm_case_pacu_2_time_delay_code String,
ztm_case_pacu_2_time_delay_desc String,
ztm_case_pacu_2_time_delay_duration_min String,
ztm_case_pacu_3_time String,
ztm_case_pacu_3_time_time_desc String,
ztm_case_pacu_3_time_pacu_date_time String,
ztm_case_pacu_3_time_delay_code String,
ztm_case_pacu_3_time_delay_desc String,
ztm_case_pacu_3_time_delay_duration_min String,
ztm_case_pacu_4_time String,
ztm_case_pacu_4_time_time_desc String,
ztm_case_pacu_4_time_pacu_date_time String,
ztm_case_pacu_4_time_delay_code String,
ztm_case_pacu_4_time_delay_desc String,
ztm_case_pacu_4_time_delay_duration_min String,
ztm_case_phase2_1_time String,
ztm_case_phase2_1_time_time_desc String,
ztm_case_phase2_1_time_phase2_date_time String,
ztm_case_phase2_1_time_delay_code String,
ztm_case_phase2_1_time_delay_desc String,
ztm_case_phase2_1_time_delay_duration_min String,
ztm_case_phase2_2_time String,
ztm_case_phase2_2_time_time_desc String,
ztm_case_phase2_2_time_phase2_date_time String,
ztm_case_phase2_2_time_delay_code String,
ztm_case_phase2_2_time_delay_desc String,
ztm_case_phase2_2_time_delay_duration_min String,
etl_firstinsert_datetime String,
field_sequence_num String
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS SEQUENCEFILE
LOCATION '/user/hive/warehouse/hl7/hl7_all_segment_data';

CREATE VIEW vw_hl7_ztm_data AS SELECT * FROM hl7_ztm_data WHERE segment_type='ZTM';