use hl7;

drop table hl7_obr_data;

CREATE EXTERNAL TABLE hl7_obr_data (
segment_type STRING,
msh_sending_facility STRING,
msh_msg_control_id STRING,
pid_medical_record_num STRING,
pid_medical_record_urn STRING,
pid_pat_account_num STRING,
obr_set_id STRING,
obr_placer_order_num STRING,
obr_placer_order_num_entity_id STRING,
obr_placer_order_num_namespace_id STRING,
obr_placer_order_num_universal_id STRING,
obr_placer_order_num_universal_id_type STRING,
obr_filler_order_num STRING,
obr_filler_order_num_entity_id STRING,
obr_filler_order_num_namespace_id STRING,
obr_filler_order_num_universal_id STRING,
obr_filler_order_num_universal_id_type STRING,
obr_universal_service_id STRING,
obr_universal_service_id_primary_id STRING,
obr_universal_service_id_text STRING,
obr_universal_service_id_name_of_coding_sys STRING,
obr_universal_service_id_alt_id STRING,
obr_universal_service_id_alt_text STRING,
obr_universal_service_id_name_of_alt_coding_sys STRING,
obr_universal_service_id_coding_sys_ver_id STRING,
obr_universal_service_id_alt_coding_sys_ver_id STRING,
obr_universal_service_id_original_text STRING,
obr_universal_service_id_second_alt_id STRING,
obr_universal_service_id_second_alt_text STRING,
obr_universal_service_id_name_of_second_alt_coding_sys STRING,
obr_universal_service_id_second_alt_coding_sys_ver_id STRING,
obr_universal_service_id_coding_sys_oid STRING,
obr_universal_service_id_value_set_oid STRING,
obr_universal_service_id_value_set_ver_id STRING,
obr_universal_service_id_alt_coding_sys_oid STRING,
obr_universal_service_id_alt_value_set_oid STRING,
obr_universal_service_id_alt_value_set_ver_id STRING,
obr_universal_service_id_second_alt_coding_sys_oid STRING,
obr_universal_service_id_second_alt_value_set_oid STRING,
obr_universal_service_id_second_alt_value_set_ver_id STRING,
obr_priority STRING,
obr_requested_date_time STRING,
obr_observation_date_time STRING,
obr_observation_end_date_time STRING,
obr_collection_volume STRING,
obr_collector_id STRING,
obr_specimen_action_code STRING,
obr_danger_code STRING,
obr_relevant_clinical_information STRING,
obr_specimen_received_date_time STRING,
obr_specimen_source STRING,
obr_specimen_source_name_code STRING,
obr_specimen_source_additives STRING,
obr_specimen_source_free_text STRING,
obr_specimen_source_body_site STRING,
obr_specimen_source_site_modfr STRING,
obr_specimen_source_coll_method_modfr_code STRING,
obr_ordering_provider STRING,
obr_ordering_provider_person_id STRING,
obr_ordering_provider_last_name STRING,
obr_ordering_provider_first_name STRING,
obr_ordering_provider_middle_name STRING,
obr_ordering_provider_suffix STRING,
obr_ordering_provider_person_prefix STRING,
obr_ordering_provider_degree STRING,
obr_ordering_provider_source_table STRING,
obr_ordering_provider_assgn_authr STRING,
obr_ordering_provider_assgn_authr_namespace_id STRING,
obr_ordering_provider_assgn_authr_universal_id STRING,
obr_ordering_provider_assgn_authr_universal_id_type STRING,
obr_ordering_provider_name_type_code STRING,
obr_ordering_provider_identifier_check_digit STRING,
obr_ordering_provider_check_digit_scheme STRING,
obr_ordering_provider_identifier_type_code STRING,
obr_ordering_provider_assgn_facility STRING,
obr_ordering_provider_name_rep_code STRING,
obr_ordering_provider_context STRING,
obr_ordering_provider_validity_range STRING,
obr_ordering_provider_assembly_order STRING,
obr_ordering_provider_eff_from_date_time STRING,
obr_ordering_provider_eff_to_date_time STRING,
obr_ordering_provider_prof_suffix STRING,
obr_ordering_provider_assgn_jurisdiction STRING,
obr_ordering_provider_assgn_agency_dept STRING,
obr_ordering_provider_security_check STRING,
obr_ordering_provider_security_check_scheme STRING,
obr_order_callback_phone_num STRING,
obr_order_callback_phone_num_formatted_num STRING,
obr_order_callback_phone_num_use_code STRING,
obr_order_callback_phone_num_equipment_type STRING,
obr_order_callback_phone_num_comm_address STRING,
obr_order_callback_phone_num_country_code STRING,
obr_order_callback_phone_num_area_city_code STRING,
obr_order_callback_phone_num_local_number STRING,
obr_order_callback_phone_num_extension STRING,
obr_order_callback_phone_num_any_text STRING,
obr_order_callback_phone_num_extension_prefix STRING,
obr_order_callback_phone_num_speed_dial_code STRING,
obr_order_callback_phone_num_unformatted_num STRING,
obr_order_callback_phone_num_eff_from_date STRING,
obr_order_callback_phone_num_eff_to_date STRING,
obr_order_callback_phone_num_expr_reason STRING,
obr_order_callback_phone_num_protection_code STRING,
obr_order_callback_phone_num_shared_id STRING,
obr_order_callback_phone_num_pref_order STRING,
obr_placer_first_generic_field STRING,
obr_placer_second_generic_field STRING,
obr_filler_first_generic_field STRING,
obr_filler_second_generic_field STRING,
obr_lab_site STRING,
obr_lab_site_mnem STRING,
obr_lab_site_name STRING,
obr_results_reported_status_change_date_time STRING,
obr_charge_to_practice STRING,
obr_diagnostic_service_section_id STRING,
obr_result_status STRING,
obr_parent_result STRING,
obr_parent_result_parent_observation_id STRING,
obr_parent_result_parent_observation_id_primary_id STRING,
obr_parent_result_parent_observation_id_text STRING,
obr_parent_result_parent_observation_id_name_of_coding_sys STRING,
obr_parent_result_parent_observation_id_alt_identifier STRING,
obr_parent_result_parent_observation_id_alt_text STRING,
obr_parent_result_parent_observation_id_name_of_alt_coding_sys STRING,
obr_parent_result_parent_observation_id_coding_sys_ver_id STRING,
obr_parent_result_parent_observation_id_alt_coding_sys_ver_id STRING,
obr_parent_result_parent_observation_id_original_text STRING,
obr_parent_result_parent_observation_id_second_alt_id STRING,
obr_parent_result_parent_observation_id_second_alt_text STRING,
obr_parent_result_parent_observation_id_name_of_second_alt_coding_sys STRING,
obr_parent_result_parent_observation_id_second_alt_coding_sys_ver_id STRING,
obr_parent_result_parent_observation_id_coding_sys_oid STRING,
obr_parent_result_parent_observation_id_value_set_oid STRING,
obr_parent_result_parent_observation_id_value_set_ver_id STRING,
obr_parent_result_parent_observation_id_alt_coding_sys_oid STRING,
obr_parent_result_parent_observation_id_alt_value_set_oid STRING,
obr_parent_result_parent_observation_id_alt_value_set_ver_id STRING,
obr_parent_result_parent_observation_id_second_alt_coding_sys_oid STRING,
obr_parent_result_parent_observation_id_second_alt_value_set_oid STRING,
obr_parent_result_parent_observation_id_second_alt_value_set_ver_id STRING,
obr_parent_result_parent_observation_sub_id STRING,
obr_parent_result_parent_observation_sub_id_orig_sub_id STRING,
obr_parent_result_parent_observation_sub_id_group STRING,
obr_parent_result_parent_observation_sub_id_sequence STRING,
obr_parent_result_parent_observation_sub_id_identifier STRING,
obr_parent_result_parent_observation_val_desc STRING,
obr_qty_timing STRING,
obr_qty_timing_quantity STRING,
obr_qty_timing_interval STRING,
obr_qty_timing_duration STRING,
obr_qty_timing_eff_from_date_time STRING,
obr_qty_timing_eff_to_date_time STRING,
obr_qty_timing_priority STRING,
obr_qty_timing_condition STRING,
obr_qty_timing_text STRING,
obr_qty_timing_conjunction STRING,
obr_qty_timing_order_seq STRING,
obr_qty_timing_occurrence_dur STRING,
obr_qty_timing_total_occurence STRING,
obr_result_copy_to STRING,
obr_result_copy_to_person_id STRING,
obr_result_copy_to_last_name STRING,
obr_result_copy_to_first_name STRING,
obr_result_copy_to_middle_name STRING,
obr_result_copy_to_suffix STRING,
obr_result_copy_to_person_prefix STRING,
obr_result_copy_to_degree STRING,
obr_result_copy_to_source_table STRING,
obr_result_copy_to_assgn_authr STRING,
obr_result_copy_to_assgn_authr_namespace_id STRING,
obr_result_copy_to_assgn_authr_universal_id STRING,
obr_result_copy_to_assgn_authr_universal_id_type STRING,
obr_result_copy_to_name_type_code STRING,
obr_result_copy_to_identifier_check_digit STRING,
obr_result_copy_to_check_digit_scheme STRING,
obr_result_copy_to_identifier_type_code STRING,
obr_result_copy_to_assgn_facility STRING,
obr_result_copy_to_name_rep_code STRING,
obr_result_copy_to_context STRING,
obr_result_copy_to_validity_range STRING,
obr_result_copy_to_assembly_order STRING,
obr_result_copy_to_eff_from_date_time STRING,
obr_result_copy_to_eff_to_date_time STRING,
obr_result_copy_to_prof_suffix STRING,
obr_result_copy_to_assgn_jurisdiction STRING,
obr_result_copy_to_assgn_agency_dept STRING,
obr_result_copy_to_security_check STRING,
obr_result_copy_to_security_check_scheme STRING,
obr_parent_result_observation_id STRING,
obr_transportation_mode STRING,
obr_reason_for_study STRING,
obr_reason_for_study_primary_id STRING,
obr_reason_for_study_text STRING,
obr_reason_for_study_name_of_coding_sys STRING,
obr_reason_for_study_alt_id STRING,
obr_reason_for_study_alt_text STRING,
obr_reason_for_study_name_of_alt_coding_sys STRING,
obr_reason_for_study_coding_sys_ver_id STRING,
obr_reason_for_study_alt_coding_sys_ver_id STRING,
obr_reason_for_study_original_text STRING,
obr_reason_for_study_second_alt_id STRING,
obr_reason_for_study_second_alt_text STRING,
obr_reason_for_study_name_of_second_alt_coding_sys STRING,
obr_reason_for_study_second_alt_coding_sys_ver_id STRING,
obr_reason_for_study_coding_sys_oid STRING,
obr_reason_for_study_value_set_oid STRING,
obr_reason_for_study_value_set_ver_id STRING,
obr_reason_for_study_alt_coding_sys_oid STRING,
obr_reason_for_study_alt_value_set_oid STRING,
obr_reason_for_study_alt_value_set_ver_id STRING,
obr_reason_for_study_second_alt_coding_sys_oid STRING,
obr_reason_for_study_second_alt_value_set_oid STRING,
obr_reason_for_study_second_alt_value_set_ver_id STRING,
obr_principal_result_interpreter STRING,
obr_principal_result_interpreter_name STRING,
obr_principal_result_interpreter_name_person_id STRING,
obr_principal_result_interpreter_name_last_name STRING,
obr_principal_result_interpreter_name_first_name STRING,
obr_principal_result_interpreter_name_middle_name STRING,
obr_principal_result_interpreter_name_suffix STRING,
obr_principal_result_interpreter_name_person_prefix STRING,
obr_principal_result_interpreter_name_degree STRING,
obr_principal_result_interpreter_name_source_table STRING,
obr_principal_result_interpreter_name_assgn_authr_namespace_id STRING,
obr_principal_result_interpreter_name_assgn_authr_universal_id STRING,
obr_principal_result_interpreter_name_assgn_authr_universal_id_type STRING,
obr_principal_result_interpreter_person_id STRING,
obr_principal_result_interpreter_last_name STRING,
obr_principal_result_interpreter_first_name STRING,
obr_principal_result_interpreter_middle_name STRING,
obr_principal_result_interpreter_suffix STRING,
obr_principal_result_interpreter_person_prefix STRING,
obr_principal_result_interpreter_degree STRING,
obr_principal_result_interpreter_source_table STRING,
obr_principal_result_interpreter_assgn_authr_namespace_id STRING,
obr_principal_result_interpreter_assgn_authr_universal_id STRING,
obr_principal_result_interpreter_assgn_authr_universal_id_type STRING,
obr_principal_result_interpreter_eff_from_date_time STRING,
obr_principal_result_interpreter_eff_to_date_time STRING,
obr_principal_result_interpreter_point_of_care STRING,
obr_principal_result_interpreter_room STRING,
obr_principal_result_interpreter_bed STRING,
obr_principal_result_interpreter_facility STRING,
obr_principal_result_interpreter_status STRING,
obr_principal_result_interpreter_person_loc_type STRING,
obr_principal_result_interpreter_building STRING,
obr_principal_result_interpreter_loc_floor STRING,
obr_assistant_result_interpreter STRING,
obr_assistant_result_interpreter_name STRING,
obr_assistant_result_interpreter_name_person_id STRING,
obr_assistant_result_interpreter_name_last_name STRING,
obr_assistant_result_interpreter_name_first_name STRING,
obr_assistant_result_interpreter_name_middle_name STRING,
obr_assistant_result_interpreter_name_suffix STRING,
obr_assistant_result_interpreter_name_person_prefix STRING,
obr_assistant_result_interpreter_name_degree STRING,
obr_assistant_result_interpreter_name_source_table STRING,
obr_assistant_result_interpreter_name_assgn_authr_namespace_id STRING,
obr_assistant_result_interpreter_name_assgn_authr_universal_id STRING,
obr_assistant_result_interpreter_name_assgn_authr_universal_id_type STRING,
obr_assistant_result_interpreter_eff_from_date_time STRING,
obr_assistant_result_interpreter_eff_to_date_time STRING,
obr_assistant_result_interpreter_point_of_care STRING,
obr_assistant_result_interpreter_room STRING,
obr_assistant_result_interpreter_bed STRING,
obr_assistant_result_interpreter_facility STRING,
obr_assistant_result_interpreter_status STRING,
obr_assistant_result_interpreter_person_loc_type STRING,
obr_assistant_result_interpreter_building STRING,
obr_assistant_result_interpreter_loc_floor STRING,
obr_technician STRING,
obr_technician_name STRING,
obr_technician_name_person_id STRING,
obr_technician_name_last_name STRING,
obr_technician_name_first_name STRING,
obr_technician_name_middle_name STRING,
obr_technician_name_suffix STRING,
obr_technician_name_person_prefix STRING,
obr_technician_name_degree STRING,
obr_technician_name_source_table STRING,
obr_technician_name_assgn_authr_namespace_id STRING,
obr_technician_name_assgn_authr_universal_id STRING,
obr_technician_name_assgn_authr_universal_id_type STRING,
obr_technician_eff_from_date_time STRING,
obr_technician_eff_to_date_time STRING,
obr_technician_point_of_care STRING,
obr_technician_room STRING,
obr_technician_bed STRING,
obr_technician_facility STRING,
obr_technician_status STRING,
obr_technician_person_loc_type STRING,
obr_technician_building STRING,
obr_technician_loc_floor STRING,
obr_transcriptionist STRING,
obr_transcriptionist_name STRING,
obr_transcriptionist_name_person_id STRING,
obr_transcriptionist_name_last_name STRING,
obr_transcriptionist_name_first_name STRING,
obr_transcriptionist_name_middle_name STRING,
obr_transcriptionist_name_suffix STRING,
obr_transcriptionist_name_person_prefix STRING,
obr_transcriptionist_name_degree STRING,
obr_transcriptionist_name_source_table STRING,
obr_transcriptionist_name_assgn_authr_namespace_id STRING,
obr_transcriptionist_name_assgn_authr_universal_id STRING,
obr_transcriptionist_name_assgn_authr_universal_id_type STRING,
obr_transcriptionist_eff_from_date_time STRING,
obr_transcriptionist_eff_to_date_time STRING,
obr_transcriptionist_point_of_care STRING,
obr_transcriptionist_room STRING,
obr_transcriptionist_bed STRING,
obr_transcriptionist_facility STRING,
obr_transcriptionist_status STRING,
obr_transcriptionist_person_loc_type STRING,
obr_transcriptionist_building STRING,
obr_transcriptionist_loc_floor STRING,
obr_scheduled_date_time STRING,
obr_sample_container STRING,
obr_collected_sample_transport_logistic STRING,
obr_collector_comment STRING,
obr_transport_arrangement_responsibility STRING,
obr_transport_arranged STRING,
obr_escort_required STRING,
obr_planned_patient_transport_comment STRING,
obr_procedure_code STRING,
obr_procedure_code_primary_id STRING,
obr_procedure_code_text STRING,
obr_procedure_code_name_of_coding_sys STRING,
obr_procedure_code_alt_id STRING,
obr_procedure_code_alt_text STRING,
obr_procedure_code_name_of_alt_coding_sys STRING,
obr_procedure_code_coding_sys_ver_id STRING,
obr_procedure_code_alt_coding_sys_ver_id STRING,
obr_procedure_code_original_text STRING,
obr_procedure_code_second_alt_id STRING,
obr_procedure_code_second_alt_text STRING,
obr_procedure_code_name_of_second_alt_coding_sys STRING,
obr_procedure_code_second_alt_coding_sys_ver_id STRING,
obr_procedure_code_coding_sys_oid STRING,
obr_procedure_code_value_set_oid STRING,
obr_procedure_code_value_set_ver_id STRING,
obr_procedure_code_alt_coding_sys_oid STRING,
obr_procedure_code_alt_value_set_oid STRING,
obr_procedure_code_alt_value_set_ver_id STRING,
obr_procedure_code_second_alt_coding_sys_oid STRING,
obr_procedure_code_second_alt_value_set_oid STRING,
obr_procedure_code_second_alt_value_set_ver_id STRING,
obr_procedure_code_modifier STRING,
obr_procedure_code_modifier_primary_id STRING,
obr_procedure_code_modifier_text STRING,
obr_procedure_code_modifier_name_of_coding_sys STRING,
obr_procedure_code_modifier_alt_id STRING,
obr_procedure_code_modifier_alt_text STRING,
obr_procedure_code_modifier_name_of_alt_coding_sys STRING,
obr_procedure_code_modifier_coding_sys_ver_id STRING,
obr_procedure_code_modifier_alt_coding_sys_ver_id STRING,
obr_procedure_code_modifier_original_text STRING,
obr_procedure_code_modifier_second_alt_id STRING,
obr_procedure_code_modifier_second_alt_text STRING,
obr_procedure_code_modifier_name_of_second_alt_coding_sys STRING,
obr_procedure_code_modifier_second_alt_coding_sys_ver_id STRING,
obr_procedure_code_modifier_coding_sys_oid STRING,
obr_procedure_code_modifier_value_set_oid STRING,
obr_procedure_code_modifier_value_set_ver_id STRING,
obr_procedure_code_modifier_alt_coding_sys_oid STRING,
obr_procedure_code_modifier_alt_value_set_oid STRING,
obr_procedure_code_modifier_alt_value_set_ver_id STRING,
obr_procedure_code_modifier_second_alt_coding_sys_oid STRING,
obr_procedure_code_modifier_second_alt_value_set_oid STRING,
obr_procedure_code_modifier_second_alt_value_set_ver_id STRING,
obr_placer_supplemental_service_information STRING,
obr_filler_supplemental_service_information STRING,
obr_medically_necessary_duplicate_procedure_reason STRING,
obr_result_handling STRING,
obr_parent_universal_service_id STRING,
obr_observation_group_id STRING,
obr_parent_observation_group_id STRING,
obr_alternate_placer_order_num STRING,
etl_firstinsert_datetime STRING,
field_sequence_num STRING
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '|'
STORED AS SEQUENCEFILE
LOCATION 'hdfs://nameservice1/user/hive/warehouse/hl7/hl7_all_segment_data';